<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>The Essential GNSS Project: GNSS_Estimator.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul>
</div>
<h1>GNSS_Estimator.cpp</h1><a href="_g_n_s_s___estimator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**</span>
<a name="l00002"></a>00002 <span class="comment">\file    GNSS_Estimator.cpp</span>
<a name="l00003"></a>00003 <span class="comment">\brief   The implementation file for the Esimtator class.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">\author  Glenn D. MacGougan (GDM)</span>
<a name="l00006"></a>00006 <span class="comment">\date    2007-11-29</span>
<a name="l00007"></a>00007 <span class="comment">\since   2006-11-16</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">\b "LICENSE INFORMATION" \n</span>
<a name="l00010"></a>00010 <span class="comment">Copyright (c) 2007, refer to 'author' doxygen tags \n</span>
<a name="l00011"></a>00011 <span class="comment">All rights reserved. \n</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">Redistribution and use in source and binary forms, with or without</span>
<a name="l00014"></a>00014 <span class="comment">modification, are permitted provided the following conditions are met: \n</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">- Redistributions of source code must retain the above copyright</span>
<a name="l00017"></a>00017 <span class="comment">  notice, this list of conditions and the following disclaimer. \n</span>
<a name="l00018"></a>00018 <span class="comment">- Redistributions in binary form must reproduce the above copyright</span>
<a name="l00019"></a>00019 <span class="comment">  notice, this list of conditions and the following disclaimer in the</span>
<a name="l00020"></a>00020 <span class="comment">  documentation and/or other materials provided with the distribution. \n</span>
<a name="l00021"></a>00021 <span class="comment">- The name(s) of the contributor(s) may not be used to endorse or promote </span>
<a name="l00022"></a>00022 <span class="comment">  products derived from this software without specific prior written </span>
<a name="l00023"></a>00023 <span class="comment">  permission. \n</span>
<a name="l00024"></a>00024 <span class="comment"></span>
<a name="l00025"></a>00025 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE CONTRIBUTORS ``AS IS'' AND ANY EXPRESS </span>
<a name="l00026"></a>00026 <span class="comment">OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED </span>
<a name="l00027"></a>00027 <span class="comment">WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00028"></a>00028 <span class="comment">DISCLAIMED. IN NO EVENT SHALL THE CONTRIBUTORS BE LIABLE FOR ANY DIRECT,</span>
<a name="l00029"></a>00029 <span class="comment">INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00030"></a>00030 <span class="comment">(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR </span>
<a name="l00031"></a>00031 <span class="comment">SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER </span>
<a name="l00032"></a>00032 <span class="comment">CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT </span>
<a name="l00033"></a>00033 <span class="comment">LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY </span>
<a name="l00034"></a>00034 <span class="comment">OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF </span>
<a name="l00035"></a>00035 <span class="comment">SUCH DAMAGE.</span>
<a name="l00036"></a>00036 <span class="comment">*/</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;memory.h&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="_g_n_s_s___estimator_8h.html" title="The header file for the GNSS_Estimator class.">GNSS_Estimator.h</a>"</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include "<a class="code" href="_g_n_s_s___rx_data_8h.html" title="The header file for the GNSS_RxData class.">GNSS_RxData.h</a>"</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include "<a class="code" href="constants_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: Contains constants.">constants.h</a>"</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include "<a class="code" href="geodesy_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: geodesy related functions.">geodesy.h</a>"</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include "<a class="code" href="gps_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: GPS specific functions.">gps.h</a>"</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include "<a class="code" href="ionosphere_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: GPS ionospheric calculations.">ionosphere.h</a>"</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include "<a class="code" href="navigation_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: navigation functions.">navigation.h</a>"</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include "<a class="code" href="troposphere_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: GPS tropospheric calculations.">troposphere.h</a>"</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include "<a class="code" href="time__conversion_8h.html" title="GNSS core &amp;#39;c&amp;#39; function library: converting time information.">time_conversion.h</a>"</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">//#define DEBUG_THE_ESTIMATOR</span>
<a name="l00053"></a>00053 <span class="preprocessor">#define GNSS_CYCLESLIP_THREADHOLD 1.5</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>
<a name="l00055"></a>00055 <span class="keyword">using namespace </span>std;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="keyword">namespace </span>GNSS
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060 <span class="comment"></span>
<a name="l00061"></a>00061 <span class="comment">  /// The critical values of the chi-squared distribution with an alpha of .005 with v: 01..30 (31 values).</span>
<a name="l00062"></a>00062 <span class="comment">  /// \b REFERENCE \n</span>
<a name="l00063"></a>00063 <span class="comment">  /// Walpole, R. E, R. H Myers (1993), Probability and Statistics for Engineers and </span>
<a name="l00064"></a>00064 <span class="comment">  /// Scientists, Prentice Hall Inc. ISBN 0-02-424301-2.</span>
<a name="l00065"></a><a class="code" href="_g_n_s_s___estimator_8cpp.html#2023cb42b2282738ee169195e4645046">00065</a> <span class="comment"></span><span class="preprocessor">  #define GNSS_CHISQUARE_00_5 { \</span>
<a name="l00066"></a>00066 <span class="preprocessor">   0.000,  7.879, 10.597, 12.838, 14.860, 16.750, 18.548, 20.278, 21.955, 23.589, \</span>
<a name="l00067"></a>00067 <span class="preprocessor">  25.188, 26.757, 28.300, 29.819, 31.319, 32.801, 34.267, 35.718, 37.156, 38.582, \</span>
<a name="l00068"></a>00068 <span class="preprocessor">  39.997, 41.401, 42.796, 44.181, 45.558, 46.928, 48.290, 49.645, 50.993, 52.336, 53.672 }</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e1ed1020bef93f0de5e5f548dcb75ef0">00071</a>   <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e1ed1020bef93f0de5e5f548dcb75ef0" title="The default constructor (no data allocated yet).">GNSS_Estimator::GNSS_Estimator</a>()
<a name="l00072"></a>00072    :
<a name="l00073"></a>00073 #define GNSS_ESTIMATE_STATIC
<a name="l00074"></a>00074 #ifdef GNSS_ESTIMATE_STATIC
<a name="l00075"></a>00075     m_betaVn(1.0/1000.0),
<a name="l00076"></a>00076     m_betaVe(1.0/1000.0),
<a name="l00077"></a>00077     m_betaVup(1.0/1000.0),
<a name="l00078"></a>00078     m_betaClkDrift(1.0/200.0),
<a name="l00079"></a>00079     m_qVn(1e-20),
<a name="l00080"></a>00080     m_qVe(1e-20),
<a name="l00081"></a>00081     m_qVup(1e-20),
<a name="l00082"></a>00082     m_qClkDrift(0.14),
<a name="l00083"></a>00083 #else
<a name="l00084"></a>00084     m_betaVn(1.0/10.0),
<a name="l00085"></a>00085     m_betaVe(1.0/10.0),
<a name="l00086"></a>00086     m_betaVup(1.0/10.0),
<a name="l00087"></a>00087     m_betaClkDrift(1.0/100.0),
<a name="l00088"></a>00088     m_qVn(0.0001),
<a name="l00089"></a>00089     m_qVe(0.0001),
<a name="l00090"></a>00090     m_qVup(0.0001),
<a name="l00091"></a>00091     m_qClkDrift(0.1),
<a name="l00092"></a>00092 #endif
<a name="l00093"></a>00093     m_debug(NULL)
<a name="l00094"></a>00094   {    
<a name="l00095"></a>00095   }
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#2bfc1e9cd1f9860faa8bf8ba39e60fc7">00097</a> 
<a name="l00098"></a>00098   GNSS_Estimator::~GNSS_Estimator()
<a name="l00099"></a>00099   {
<a name="l00100"></a>00100     <span class="keywordflow">if</span>( m_debug )
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102       fclose(m_debug);
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104   }
<a name="l00105"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#45ecb2d89eb423cccd2338820572fb4b">00105</a> 
<a name="l00106"></a>00106   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#45ecb2d89eb423cccd2338820572fb4b" title="Perform least squares using pseudoranges and Doppler measurments to determine the...">GNSS_Estimator::PerformLeastSquares_8StatePVT</a>(
<a name="l00107"></a>00107     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,       <span class="comment">//!&lt; A pointer to the rover receiver data. This must be a valid pointer.</span>
<a name="l00108"></a>00108 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,   <span class="comment">//!&lt; A pointer to the reference receiver data if available. NULL if not available.</span>
<a name="l00109"></a>00109 <span class="comment"></span>    <span class="keywordtype">bool</span> &amp;wasPositionComputed, <span class="comment">//!&lt; A boolean to indicate if a position solution was computed.    </span>
<a name="l00110"></a>00110 <span class="comment"></span>    <span class="keywordtype">bool</span> &amp;wasVelocityComputed  <span class="comment">//!&lt; A boolean to indicate if a velocity solution was computed.    </span>
<a name="l00111"></a>00111 <span class="comment"></span>    )
<a name="l00112"></a>00112   {
<a name="l00113"></a>00113     <span class="keywordtype">unsigned</span> i = 0;
<a name="l00114"></a>00114     <span class="keywordtype">unsigned</span> j = 0;
<a name="l00115"></a>00115     <span class="comment">//unsigned k = 0;</span>
<a name="l00116"></a>00116     <span class="keywordtype">unsigned</span> iter = 0;
<a name="l00117"></a>00117     <span class="keywordtype">unsigned</span> n = 0; 
<a name="l00118"></a>00118     <span class="keywordtype">unsigned</span> nrValidEph = 0; <span class="comment">// The number of channels with valid ephemeris.</span>
<a name="l00119"></a>00119     <span class="keywordtype">unsigned</span> nrP = 0;        <span class="comment">// The number of valid pseudorange measurements. </span>
<a name="l00120"></a>00120     <span class="keywordtype">unsigned</span> nrP_base = 0;   <span class="comment">// The number of valid pseudorange measurements (base station).</span>
<a name="l00121"></a>00121     <span class="keywordtype">unsigned</span> nrD = 0;        <span class="comment">// The number of valid Doppler measurements.</span>
<a name="l00122"></a>00122     <span class="comment">//unsigned nrD_base = 0;   // The number of valid Doppler measurements (base station).    </span>
<a name="l00123"></a>00123     <span class="keywordtype">unsigned</span> nrDifferentialPsr = 0;     <span class="comment">// The number of valid differntial pseudorange measurements.</span>
<a name="l00124"></a>00124     <span class="keywordtype">unsigned</span> nrDifferentialDoppler = 0; <span class="comment">// the number of valid differential Doppler measurements.</span>
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="comment">//unsigned char isGood = 0; // A helper value.</span>
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keywordtype">double</span> dtmp1 = 0;     <span class="comment">// A temp double.</span>
<a name="l00129"></a>00129     <span class="keywordtype">double</span> lat = 0;       <span class="comment">// latitude [rad].</span>
<a name="l00130"></a>00130     <span class="keywordtype">double</span> lon = 0;       <span class="comment">// longitude [rad].</span>
<a name="l00131"></a>00131     <span class="keywordtype">double</span> hgt = 0;       <span class="comment">// height [m].</span>
<a name="l00132"></a>00132     <span class="keywordtype">double</span> clk = 0;       <span class="comment">// rx clock bias [m].</span>
<a name="l00133"></a>00133     <span class="keywordtype">double</span> clkdrift = 0;  <span class="comment">// rx clock drift [m/s].</span>
<a name="l00134"></a>00134     <span class="keywordtype">double</span> vn = 0;        <span class="comment">// rx velocity north [m/s].</span>
<a name="l00135"></a>00135     <span class="keywordtype">double</span> ve = 0;        <span class="comment">// rx velocity east [m/s].</span>
<a name="l00136"></a>00136     <span class="keywordtype">double</span> vup = 0;       <span class="comment">// rx velocity up [m/s].</span>
<a name="l00137"></a>00137     <span class="keywordtype">double</span> M = 0;   <span class="comment">// The computed meridian radius of curvature [m].</span>
<a name="l00138"></a>00138     <span class="keywordtype">double</span> N = 0;   <span class="comment">// The computed prime vertical radius of curvature [m].</span>
<a name="l00139"></a>00139     
<a name="l00140"></a>00140     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> dx_p(4);  <span class="comment">// The iterative update to the position, clock states,         [4  x  1].   </span>
<a name="l00141"></a>00141     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> dx_v(4);  <span class="comment">// The iterative update to the velocity, clk drift states,     [4  x  1].   </span>
<a name="l00142"></a>00142     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> P_p(4,4); <span class="comment">// The position, clk, state variance covariance matrix,        [4  x  4].</span>
<a name="l00143"></a>00143     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> P_v(4,4); <span class="comment">// The velocity, clk drift, state variance covariance matrix,  [4  x  4].</span>
<a name="l00144"></a>00144     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_p;      <span class="comment">// The position design matrix                                  [nP x  4].</span>
<a name="l00145"></a>00145     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> Ht_p;     <span class="comment">// The position design matrix transposed                       [4  x nP].</span>
<a name="l00146"></a>00146     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> HtW_p;    <span class="comment">// An intermediate result                                      [4  x nP].</span>
<a name="l00147"></a>00147     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_v;      <span class="comment">// The velocity design matrix                                  [nD x  4].</span>
<a name="l00148"></a>00148     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> Ht_v;     <span class="comment">// The velocity design matrix transposed                       [4  x nD].</span>
<a name="l00149"></a>00149     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> HtW_v;    <span class="comment">// An intermediate result                                      [4  x nD].</span>
<a name="l00150"></a>00150     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> W_p;      <span class="comment">// The weight matrix for the psr observations,                 [nP x nP].</span>
<a name="l00151"></a>00151     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_p;      <span class="comment">// The variance-covariance matrix for the psr observations,    [nP x nP].</span>
<a name="l00152"></a>00152     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> W_v;      <span class="comment">// The weight matrix for the Doppler observations,             [nD x nD].</span>
<a name="l00153"></a>00153     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_v;      <span class="comment">// The variance-covariance matrix for the Doppler observations,[nD x nD].</span>
<a name="l00154"></a>00154     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_p;      <span class="comment">// The psr misclosures vector,                                 [nP x  1].</span>
<a name="l00155"></a>00155     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_v;      <span class="comment">// The Doppler misclosure vector,                              [nD x  1].    </span>
<a name="l00156"></a>00156     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> r_p;      <span class="comment">// The psr residuals vector,                                   [nP x  1].</span>
<a name="l00157"></a>00157     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> r_v;      <span class="comment">// The Doppler residuals vector,                               [nD x  1].</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="keywordtype">double</span> avf_p = 0; <span class="comment">// The a-posteriori variance factor for the position solution.</span>
<a name="l00160"></a>00160     <span class="comment">//double avf_v = 0; // The a-posteriori variance factor for the velocity solution.</span>
<a name="l00161"></a>00161 
<a name="l00162"></a>00162     <span class="keywordtype">bool</span> isGlobalTestPassed_p = <span class="keyword">false</span>; <span class="comment">// This indicates if the Global Reliability Test passed for the position solution.</span>
<a name="l00163"></a>00163     <span class="comment">//bool isGlobalTestPassed_v = false; // This indicates if the Global Reliability Test passed for the velocity solution.</span>
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="keywordtype">bool</span> hasRejectionOccurred_p = <span class="keyword">false</span>; <span class="comment">// This indicates if a pseudorange measurement was rejected.</span>
<a name="l00166"></a>00166     <span class="comment">//bool hasRejectionOccurred_v = false; // This indicates if a Doppler measurement was rejected.</span>
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> indexOfRejected = 0; <span class="comment">// The index into rxData.m_ObsArray of a rejected measurement.</span>
<a name="l00169"></a>00169     
<a name="l00170"></a>00170     <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     <span class="keywordflow">if</span>( rxData == NULL )
<a name="l00173"></a>00173       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="comment">// Store the current input pvt as the previous pvt since we are updating.</span>
<a name="l00176"></a>00176     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     lat       = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>;
<a name="l00179"></a>00179     lon       = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>;
<a name="l00180"></a>00180     hgt       = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l00181"></a>00181     clk       = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a>;
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     vn        = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a>;
<a name="l00184"></a>00184     ve        = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a>;
<a name="l00185"></a>00185     vup       = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a>;
<a name="l00186"></a>00186     clkdrift  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     wasPositionComputed = <span class="keyword">false</span>;
<a name="l00189"></a>00189     wasVelocityComputed = <span class="keyword">false</span>;
<a name="l00190"></a>00190        
<a name="l00191"></a>00191     <span class="comment">// Perform very basic uniqueness check.</span>
<a name="l00192"></a>00192     n = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#18ce4636c107af596c0df586143b3481" title="The number of GPS L1 observations in m_ObsArray.">m_nrGPSL1Obs</a>;
<a name="l00193"></a>00193     <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l00194"></a>00194     {
<a name="l00195"></a>00195       n += 3;
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l00198"></a>00198     {
<a name="l00199"></a>00199       n += 1;
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     <span class="keywordflow">if</span>( n &lt; 4 )    
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="comment">// Update the receiver time information (UTC and day of year)</span>
<a name="l00207"></a>00207     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxData );
<a name="l00208"></a>00208     <span class="keywordflow">if</span>( !result )
<a name="l00209"></a>00209       <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l00210"></a>00210     <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxBaseData );
<a name="l00213"></a>00213       <span class="keywordflow">if</span>( !result )
<a name="l00214"></a>00214         <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217     
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b65e9ee3b9983ceb2583fd21982ddbe8" title="Determine the satellite clock corrections, positions, and velocities for the rover...">DetermineSatellitePVT_GPSL1</a>( rxData, rxBaseData, nrValidEph );
<a name="l00221"></a>00221     <span class="keywordflow">if</span>( !result )
<a name="l00222"></a>00222       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxData );
<a name="l00225"></a>00225     <span class="keywordflow">if</span>( !result )
<a name="l00226"></a>00226       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00227"></a>00227     <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxBaseData );
<a name="l00230"></a>00230       <span class="keywordflow">if</span>( !result )
<a name="l00231"></a>00231         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233     
<a name="l00234"></a>00234     <span class="comment">// Check uniqueness</span>
<a name="l00235"></a>00235     n = nrValidEph;
<a name="l00236"></a>00236     <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l00237"></a>00237     {
<a name="l00238"></a>00238       n += 3;
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l00241"></a>00241     {
<a name="l00242"></a>00242       n += 1;
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244     <span class="keywordflow">if</span>( n &lt; 4 )    
<a name="l00245"></a>00245     {
<a name="l00246"></a>00246       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248   
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="comment">// Iterate through the solution</span>
<a name="l00251"></a>00251     <span class="keywordflow">for</span>( iter = 0; iter &lt; 7; iter++ )
<a name="l00252"></a>00252     {
<a name="l00253"></a>00253       <span class="keywordflow">if</span>( !<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxData, nrP ) )
<a name="l00254"></a>00254         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256       <span class="comment">// Check uniqueness</span>
<a name="l00257"></a>00257       n = nrP;
<a name="l00258"></a>00258       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l00259"></a>00259       {
<a name="l00260"></a>00260         n += 3;
<a name="l00261"></a>00261       }
<a name="l00262"></a>00262       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l00263"></a>00263       {
<a name="l00264"></a>00264         n += 1;
<a name="l00265"></a>00265       }
<a name="l00266"></a>00266       <span class="keywordflow">if</span>( n &lt; 4 )    
<a name="l00267"></a>00267       {
<a name="l00268"></a>00268         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00269"></a>00269       }
<a name="l00270"></a>00270   
<a name="l00271"></a>00271       <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l00272"></a>00272       {
<a name="l00273"></a>00273         <span class="keywordflow">if</span>( !<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxBaseData, nrP_base ) )
<a name="l00274"></a>00274           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0325ac1ddd31befdbfc2a8b67e97c69c" title="Determine the differential GPS L1 pseudorange measurements.">DetermineDifferentialPseudorangeMeasurementsForThePositionSolution_GPSL1</a>(
<a name="l00277"></a>00277           rxData,
<a name="l00278"></a>00278           rxBaseData,
<a name="l00279"></a>00279           <span class="keyword">true</span>,
<a name="l00280"></a>00280           nrDifferentialPsr );
<a name="l00281"></a>00281         <span class="keywordflow">if</span>( !result )
<a name="l00282"></a>00282           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284         nrP = nrDifferentialPsr;
<a name="l00285"></a>00285         n = nrP;
<a name="l00286"></a>00286         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l00287"></a>00287         {
<a name="l00288"></a>00288           n += 3;
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l00291"></a>00291         {
<a name="l00292"></a>00292           n += 1;
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294         <span class="keywordflow">if</span>( n &lt; 4 )    
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296           <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298       }
<a name="l00299"></a>00299   
<a name="l00300"></a>00300       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6" title="Determine the design matrix for the GPS L1 position solution based on pseudroange...">DetermineDesignMatrixForThePositionSolution_GPSL1</a>(
<a name="l00301"></a>00301         *rxData,
<a name="l00302"></a>00302         n,
<a name="l00303"></a>00303         H_p );
<a name="l00304"></a>00304       <span class="keywordflow">if</span>( !result )
<a name="l00305"></a>00305         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00306"></a>00306       
<a name="l00307"></a>00307       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0fe13960eb41de660c25182935f75d22" title="Determine the measurement weight matrix for the GPS L1 position solution based on...">DetermineMeasurementWeightMatrixForThePositionSolution_GPSL1</a>(
<a name="l00308"></a>00308         *rxData,
<a name="l00309"></a>00309         n,
<a name="l00310"></a>00310         W_p );
<a name="l00311"></a>00311       <span class="keywordflow">if</span>( !result )
<a name="l00312"></a>00312         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a0c642977c8e788817fbde37909533d3" title="Determine the measurement variance-coariance matrix for the GPS L1 position solution...">DetermineMeasurementVarianceCovarianceMatrixForThePositionSolution_GPSL1</a>(
<a name="l00315"></a>00315         *rxData,
<a name="l00316"></a>00316         n,
<a name="l00317"></a>00317         R_p );
<a name="l00318"></a>00318       <span class="keywordflow">if</span>( !result )
<a name="l00319"></a>00319         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">DeterminePseudorangeMisclosures_GPSL1</a>( 
<a name="l00322"></a>00322         rxData, 
<a name="l00323"></a>00323         rxBaseData,
<a name="l00324"></a>00324         n, 
<a name="l00325"></a>00325         w_p );
<a name="l00326"></a>00326       <span class="keywordflow">if</span>( !result )
<a name="l00327"></a>00327         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329       <span class="comment">// Compute Ht_p.</span>
<a name="l00330"></a>00330       Ht_p = H_p;
<a name="l00331"></a>00331       <span class="keywordflow">if</span>( !Ht_p.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>() )
<a name="l00332"></a>00332         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334       <span class="comment">// Compute HtW_p.</span>
<a name="l00335"></a>00335       <span class="keywordflow">if</span>( !HtW_p.<a class="code" href="class_zenautics_1_1_matrix.html#0987704823106ef5cb3bdc51415e720a" title="Multiply A = B*C. The result, A, is stored in this matrix. e.g. Matrix A; A.Multiply(B...">Multiply</a>( Ht_p, W_p ) )
<a name="l00336"></a>00336         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00337"></a>00337 
<a name="l00338"></a>00338       <span class="comment">// Compute P_p.</span>
<a name="l00339"></a>00339       <span class="keywordflow">if</span>( !P_p.<a class="code" href="class_zenautics_1_1_matrix.html#0987704823106ef5cb3bdc51415e720a" title="Multiply A = B*C. The result, A, is stored in this matrix. e.g. Matrix A; A.Multiply(B...">Multiply</a>( HtW_p, H_p ) )
<a name="l00340"></a>00340         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00341"></a>00341       <span class="keywordflow">if</span>( !P_p.<a class="code" href="class_zenautics_1_1_matrix.html#dc1d6447f68b5639d2845f4e7d660888" title="Computes the inplace inverse of the matrix.">Inplace_Invert</a>() )
<a name="l00342"></a>00342         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344       <span class="comment">// Compute dx_p.</span>
<a name="l00345"></a>00345       <span class="keywordflow">if</span>( !dx_p.<a class="code" href="class_zenautics_1_1_matrix.html#0987704823106ef5cb3bdc51415e720a" title="Multiply A = B*C. The result, A, is stored in this matrix. e.g. Matrix A; A.Multiply(B...">Multiply</a>( P_p, HtW_p ) )
<a name="l00346"></a>00346         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00347"></a>00347       <span class="keywordflow">if</span>( !dx_p.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( w_p ) )
<a name="l00348"></a>00348         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350       <span class="comment">// Update the position and clock states</span>
<a name="l00351"></a>00351       <span class="comment">// Update height first as it is need to reduce the corrections for lat and lon.</span>
<a name="l00352"></a>00352       hgt += dx_p[2];
<a name="l00353"></a>00353       clk += dx_p[3];
<a name="l00354"></a>00354      
<a name="l00355"></a>00355       <span class="comment">// The corrections for lat and lon, dx_p, must be converted to [rad] from [m].</span>
<a name="l00356"></a>00356       <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l00357"></a>00357         <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>, 
<a name="l00358"></a>00358         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l00359"></a>00359         &amp;N );
<a name="l00360"></a>00360       <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>(
<a name="l00361"></a>00361         <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>, 
<a name="l00362"></a>00362         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l00363"></a>00363         &amp;M );
<a name="l00364"></a>00364 
<a name="l00365"></a>00365       lat += dx_p[0] / ( M + hgt );             <span class="comment">// convert from meters to radians.</span>
<a name="l00366"></a>00366       lon += dx_p[1] / (( N + hgt )*cos(lat));  <span class="comment">// convert from meters to radians.</span>
<a name="l00367"></a>00367 
<a name="l00368"></a>00368       result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#52a8d17635ab44c6add3566bc700a30f" title="Update the receiver position and clock offset.">UpdatePositionAndRxClock</a>(
<a name="l00369"></a>00369         lat,
<a name="l00370"></a>00370         lon,
<a name="l00371"></a>00371         hgt,
<a name="l00372"></a>00372         clk,
<a name="l00373"></a>00373         sqrt(P_p[0][0]),
<a name="l00374"></a>00374         sqrt(P_p[1][1]),
<a name="l00375"></a>00375         sqrt(P_p[2][2]),
<a name="l00376"></a>00376         sqrt(P_p[3][3])
<a name="l00377"></a>00377         );
<a name="l00378"></a>00378       <span class="keywordflow">if</span>( !result )
<a name="l00379"></a>00379         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381       dtmp1 = fabs(dx_p[0]) + fabs(dx_p[1]) + fabs(dx_p[2]) + fabs(dx_p[3]);
<a name="l00382"></a>00382       <span class="keywordflow">if</span>( dtmp1 &lt; 0.0001 )
<a name="l00383"></a>00383       {
<a name="l00384"></a>00384         <span class="keywordflow">if</span>( 0 )
<a name="l00385"></a>00385         {
<a name="l00386"></a>00386           <span class="comment">// Test the residuals</span>
<a name="l00387"></a>00387           result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#08bc49b2a24eeb6106182db329612797" title="Perform the Global Internal Reliability Test, followed by a search using local testing...">PerformGlobalTestAndTestForMeasurementFaults</a>( 
<a name="l00388"></a>00388             *rxData,
<a name="l00389"></a>00389             <span class="keyword">true</span>,
<a name="l00390"></a>00390             H_p,
<a name="l00391"></a>00391             Ht_p,      
<a name="l00392"></a>00392             W_p,
<a name="l00393"></a>00393             R_p,
<a name="l00394"></a>00394             w_p, <span class="comment">// misclosures at convergence are the residuals.</span>
<a name="l00395"></a>00395             P_p,
<a name="l00396"></a>00396             n,
<a name="l00397"></a>00397             4,
<a name="l00398"></a>00398             avf_p,      
<a name="l00399"></a>00399             isGlobalTestPassed_p,
<a name="l00400"></a>00400             hasRejectionOccurred_p,
<a name="l00401"></a>00401             indexOfRejected
<a name="l00402"></a>00402             );
<a name="l00403"></a>00403           <span class="keywordflow">if</span>( !result )
<a name="l00404"></a>00404             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406           <span class="keywordflow">if</span>( hasRejectionOccurred_p )
<a name="l00407"></a>00407           {
<a name="l00408"></a>00408             hasRejectionOccurred_p = <span class="keyword">false</span>;
<a name="l00409"></a>00409             j = 0; <span class="comment">// restart the iterative loop.</span>
<a name="l00410"></a>00410             <span class="keywordflow">continue</span>;
<a name="l00411"></a>00411           }
<a name="l00412"></a>00412           <span class="keywordflow">else</span>
<a name="l00413"></a>00413           {
<a name="l00414"></a>00414             <span class="comment">// converged to solution.</span>
<a name="l00415"></a>00415             <span class="keywordflow">break</span>;
<a name="l00416"></a>00416           }
<a name="l00417"></a>00417         }
<a name="l00418"></a>00418         <span class="keywordflow">else</span>
<a name="l00419"></a>00419         {
<a name="l00420"></a>00420           <span class="comment">// converged to solution.</span>
<a name="l00421"></a>00421           <span class="keywordflow">break</span>;
<a name="l00422"></a>00422         }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424       }
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426     wasPositionComputed = <span class="keyword">true</span>;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <span class="comment">// compute the DOP</span>
<a name="l00430"></a>00430     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> Q;
<a name="l00431"></a>00431     Q = H_p;
<a name="l00432"></a>00432     Q.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>();
<a name="l00433"></a>00433     Q.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( H_p );
<a name="l00434"></a>00434     <span class="keywordflow">if</span>( !Q.<a class="code" href="class_zenautics_1_1_matrix.html#dc1d6447f68b5639d2845f4e7d660888" title="Computes the inplace inverse of the matrix.">Inplace_Invert</a>() )
<a name="l00435"></a>00435       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#cb80ffde27acd9c8293ff2eebeaca352" title="northing dilution of precision [].">ndop</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( sqrt( Q[0][0] ) );
<a name="l00438"></a>00438     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#16d1f61666ba26c7d03a9518538f192e" title="easting dilution of precision [].">edop</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( sqrt( Q[1][1] ) );
<a name="l00439"></a>00439     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#af8d13c2fb34b73c0304cf9c037e6391" title="vertical dilution of precision [].">vdop</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( sqrt( Q[2][2] ) );
<a name="l00440"></a>00440     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#6595af661751ec60645790424c2090bd" title="time dilution of precision [].">tdop</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( sqrt( Q[3][3] ) );
<a name="l00441"></a>00441     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#0752708014ae2ac2f3841337dc321249" title="horizontal dilution of precision [].">hdop</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#cb80ffde27acd9c8293ff2eebeaca352" title="northing dilution of precision [].">ndop</a> * rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#cb80ffde27acd9c8293ff2eebeaca352" title="northing dilution of precision [].">ndop</a> + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#16d1f61666ba26c7d03a9518538f192e" title="easting dilution of precision [].">edop</a> * rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#16d1f61666ba26c7d03a9518538f192e" title="easting dilution of precision [].">edop</a>;
<a name="l00442"></a>00442     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#601a992a7d61f0f2a6ac7a3df6c9e15a" title="position dilution of precision [].">pdop</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#0752708014ae2ac2f3841337dc321249" title="horizontal dilution of precision [].">hdop</a> + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#af8d13c2fb34b73c0304cf9c037e6391" title="vertical dilution of precision [].">vdop</a> * rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#af8d13c2fb34b73c0304cf9c037e6391" title="vertical dilution of precision [].">vdop</a>;
<a name="l00443"></a>00443     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#c4a0444e808dba7ca3dc7a3019c077d4" title="geometric dilution of precision [].">gdop</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#601a992a7d61f0f2a6ac7a3df6c9e15a" title="position dilution of precision [].">pdop</a> + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#6595af661751ec60645790424c2090bd" title="time dilution of precision [].">tdop</a> * rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#6595af661751ec60645790424c2090bd" title="time dilution of precision [].">tdop</a>;
<a name="l00444"></a>00444     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#0752708014ae2ac2f3841337dc321249" title="horizontal dilution of precision [].">hdop</a> = sqrt(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#0752708014ae2ac2f3841337dc321249" title="horizontal dilution of precision [].">hdop</a>);
<a name="l00445"></a>00445     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#601a992a7d61f0f2a6ac7a3df6c9e15a" title="position dilution of precision [].">pdop</a> = sqrt(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#601a992a7d61f0f2a6ac7a3df6c9e15a" title="position dilution of precision [].">pdop</a>);
<a name="l00446"></a>00446     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#c4a0444e808dba7ca3dc7a3019c077d4" title="geometric dilution of precision [].">gdop</a> = sqrt(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f5a838c7a36b0d8ce914017f8acaee13" title="All the associated DOP information for this solution.">dop</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_d_o_p.html#c4a0444e808dba7ca3dc7a3019c077d4" title="geometric dilution of precision [].">gdop</a>);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     <span class="comment">//</span><span class="comment"></span>
<a name="l00450"></a>00450 <span class="comment">    ////</span>
<a name="l00451"></a>00451 <span class="comment"></span>
<a name="l00452"></a>00452 <span class="comment"></span>
<a name="l00453"></a>00453 <span class="comment">    ////</span>
<a name="l00454"></a>00454 <span class="comment"></span>    <span class="comment">// Velocity</span>
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="keywordflow">for</span>( iter = 0; iter &lt; 7; iter++ )
<a name="l00457"></a>00457     {
<a name="l00458"></a>00458       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>(
<a name="l00459"></a>00459         *rxData,
<a name="l00460"></a>00460         nrD );
<a name="l00461"></a>00461       <span class="keywordflow">if</span>( !result )
<a name="l00462"></a>00462         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00463"></a>00463 
<a name="l00464"></a>00464       <span class="comment">// Check uniqueness</span>
<a name="l00465"></a>00465       n = nrD;
<a name="l00466"></a>00466       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l00467"></a>00467       {
<a name="l00468"></a>00468         n += 3;
<a name="l00469"></a>00469       }
<a name="l00470"></a>00470       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l00471"></a>00471       {
<a name="l00472"></a>00472         n += 1;
<a name="l00473"></a>00473       }
<a name="l00474"></a>00474       <span class="keywordflow">if</span>( n &lt; 4 )    
<a name="l00475"></a>00475       {
<a name="l00476"></a>00476         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00477"></a>00477       }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479       
<a name="l00480"></a>00480       <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l00481"></a>00481       {
<a name="l00482"></a>00482         <span class="keywordflow">if</span>( !<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxBaseData, nrP_base ) )
<a name="l00483"></a>00483           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#92db9d6064dda154b675f62f07b53573" title="Determine the differential GPS L1 Doppler measurements.">DetermineDifferentialDopplerMeasurementsForTheVelocitySolution_GPSL1</a>(
<a name="l00486"></a>00486           rxData,
<a name="l00487"></a>00487           rxBaseData,
<a name="l00488"></a>00488           <span class="keyword">true</span>,
<a name="l00489"></a>00489           nrDifferentialDoppler );
<a name="l00490"></a>00490         <span class="keywordflow">if</span>( !result )
<a name="l00491"></a>00491           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493         <span class="comment">// Check uniqueness.</span>
<a name="l00494"></a>00494         nrD = nrDifferentialDoppler;
<a name="l00495"></a>00495         n = nrD;
<a name="l00496"></a>00496         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l00497"></a>00497         {
<a name="l00498"></a>00498           n += 3;
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l00501"></a>00501         {
<a name="l00502"></a>00502           n += 1;
<a name="l00503"></a>00503         }
<a name="l00504"></a>00504         <span class="keywordflow">if</span>( n &lt; 4 )    
<a name="l00505"></a>00505         {
<a name="l00506"></a>00506           <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00507"></a>00507         }
<a name="l00508"></a>00508       }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 
<a name="l00511"></a>00511       <span class="comment">// Need to update the rxData-&gt;m_ObsArray[i].rangerate values.</span>
<a name="l00512"></a>00512       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l00513"></a>00513       {
<a name="l00514"></a>00514         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l00515"></a>00515         {
<a name="l00516"></a>00516           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l00517"></a>00517           {
<a name="l00518"></a>00518             <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l00519"></a>00519             {
<a name="l00520"></a>00520               <a class="code" href="gps_8c.html#05848c2666fb341705235d685114f6d7">GPS_ComputeUserToSatelliteRangeAndRangeRate</a>(
<a name="l00521"></a>00521                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#246c5aa253100ca7348dc9c81a933697" title="The user&amp;#39;s ECEF position, X [m].">x</a>,
<a name="l00522"></a>00522                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5880313b8a0313c57985b3b7a533d0f8" title="The user&amp;#39;s ECEF position, Y [m].">y</a>,
<a name="l00523"></a>00523                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#32a4c3846d60a40dcee6d3936d570c30" title="The user&amp;#39;s ECEF position, Z [m].">z</a>,
<a name="l00524"></a>00524                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7e43a2bbff460a7741167e7377c59bb4" title="The user&amp;#39;s ECEF velocity, vx [m/s].">vx</a>,
<a name="l00525"></a>00525                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#91eb292fc8cc32975afa14cb60282932" title="The user&amp;#39;s ECEF velocity, vy [m/s].">vy</a>,
<a name="l00526"></a>00526                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#c4802af5efcee553222f127c406ab376" title="The user&amp;#39;s ECEF velocity, vz [m/s].">vz</a>,
<a name="l00527"></a>00527                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l00528"></a>00528                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l00529"></a>00529                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l00530"></a>00530                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#6cbc6e802e949053a17edad2a11ac985" title="The satellite velocity ECEF, vx [m].">vx</a>,
<a name="l00531"></a>00531                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#879ba363d94539392eadf52de73ee764" title="The satellite velocity ECEF, vy [m].">vy</a>,
<a name="l00532"></a>00532                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#4c043e4288fc3ab8ffb9ef7a18156bd2" title="The satellite velocity ECEF, vz [m].">vz</a>,
<a name="l00533"></a>00533                 &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>,
<a name="l00534"></a>00534                 &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b38a70ae40a3fadc3664067f4f80eccc" title="The best estimate of the geometric range rate between the antenna and the satellite...">rangerate</a>
<a name="l00535"></a>00535                 );
<a name="l00536"></a>00536             }
<a name="l00537"></a>00537           }
<a name="l00538"></a>00538         }
<a name="l00539"></a>00539       }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19" title="Determine the design matrix for the GPS L1 velocity solution based on Doppler measurements...">DetermineDesignMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l00542"></a>00542         *rxData,
<a name="l00543"></a>00543         n,
<a name="l00544"></a>00544         H_v );
<a name="l00545"></a>00545       <span class="keywordflow">if</span>( !result )
<a name="l00546"></a>00546         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#18f021bfbf3e4a19a20bd03b06e17b8f" title="Determine the measurement weight matrix for the GPS L1 velocity solution based on...">DetermineMeasurementWeightMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l00549"></a>00549         *rxData,
<a name="l00550"></a>00550         n,
<a name="l00551"></a>00551         W_v );
<a name="l00552"></a>00552       <span class="keywordflow">if</span>( !result )
<a name="l00553"></a>00553         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#981212395e812c74a9ce542c2b7187cd" title="Determine the measurement variance-covariance matrix for the GPS L1 velocity solution...">DetermineMeasurementVarianceCovarianceMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l00556"></a>00556         *rxData,
<a name="l00557"></a>00557         n,
<a name="l00558"></a>00558         R_v );
<a name="l00559"></a>00559       <span class="keywordflow">if</span>( !result )
<a name="l00560"></a>00560         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">DetermineDopplerMisclosures_GPSL1</a>(
<a name="l00563"></a>00563         rxData,
<a name="l00564"></a>00564         rxBaseData,
<a name="l00565"></a>00565         n,
<a name="l00566"></a>00566         w_v );
<a name="l00567"></a>00567       <span class="keywordflow">if</span>( !result )
<a name="l00568"></a>00568         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570       <span class="comment">// Compute Ht_v.</span>
<a name="l00571"></a>00571       Ht_v = H_v;
<a name="l00572"></a>00572       <span class="keywordflow">if</span>( !Ht_v.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>() )
<a name="l00573"></a>00573         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575       <span class="comment">// Compute HtW_v.</span>
<a name="l00576"></a>00576       <span class="keywordflow">if</span>( !HtW_v.<a class="code" href="class_zenautics_1_1_matrix.html#0987704823106ef5cb3bdc51415e720a" title="Multiply A = B*C. The result, A, is stored in this matrix. e.g. Matrix A; A.Multiply(B...">Multiply</a>( Ht_v, W_v ) )
<a name="l00577"></a>00577         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00578"></a>00578 
<a name="l00579"></a>00579       <span class="comment">// Compute P_v.</span>
<a name="l00580"></a>00580       <span class="keywordflow">if</span>( !P_v.<a class="code" href="class_zenautics_1_1_matrix.html#0987704823106ef5cb3bdc51415e720a" title="Multiply A = B*C. The result, A, is stored in this matrix. e.g. Matrix A; A.Multiply(B...">Multiply</a>( HtW_v, H_v ) )
<a name="l00581"></a>00581         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00582"></a>00582       <span class="keywordflow">if</span>( !P_v.<a class="code" href="class_zenautics_1_1_matrix.html#dc1d6447f68b5639d2845f4e7d660888" title="Computes the inplace inverse of the matrix.">Inplace_Invert</a>() )
<a name="l00583"></a>00583         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00584"></a>00584 
<a name="l00585"></a>00585       <span class="comment">// Compute dx_v.</span>
<a name="l00586"></a>00586       <span class="keywordflow">if</span>( !dx_v.<a class="code" href="class_zenautics_1_1_matrix.html#0987704823106ef5cb3bdc51415e720a" title="Multiply A = B*C. The result, A, is stored in this matrix. e.g. Matrix A; A.Multiply(B...">Multiply</a>( P_v, HtW_v ) )
<a name="l00587"></a>00587         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00588"></a>00588       <span class="keywordflow">if</span>( !dx_v.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( w_v ) )
<a name="l00589"></a>00589         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00590"></a>00590 
<a name="l00591"></a>00591       <span class="comment">// Update the velocity and clock drift states.</span>
<a name="l00592"></a>00592       vn        += dx_v[0];
<a name="l00593"></a>00593       ve        += dx_v[1];
<a name="l00594"></a>00594       vup       += dx_v[2];
<a name="l00595"></a>00595       clkdrift  += dx_v[3];
<a name="l00596"></a>00596 
<a name="l00597"></a>00597       result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#41cd9f52d3cc745937c4832b3e4021d7" title="Update the receiver velocity and clock drift.">UpdateVelocityAndClockDrift</a>(
<a name="l00598"></a>00598         vn,
<a name="l00599"></a>00599         ve,
<a name="l00600"></a>00600         vup,
<a name="l00601"></a>00601         clkdrift,
<a name="l00602"></a>00602         P_v[0][0],
<a name="l00603"></a>00603         P_v[1][1],
<a name="l00604"></a>00604         P_v[2][2],
<a name="l00605"></a>00605         P_v[3][3] );
<a name="l00606"></a>00606       <span class="keywordflow">if</span>( !result )
<a name="l00607"></a>00607         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609       dtmp1 = fabs(dx_v[0]) + fabs(dx_v[1]) + fabs(dx_v[2]) + fabs(dx_v[3]);
<a name="l00610"></a>00610       <span class="keywordflow">if</span>( dtmp1 &lt; 1.0e-10 )
<a name="l00611"></a>00611         <span class="keywordflow">break</span>;
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613     wasVelocityComputed = <span class="keyword">true</span>;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00616"></a>00616   }
<a name="l00617"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa">00617</a> 
<a name="l00618"></a>00618   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">GNSS_Estimator::UpdateTime</a>(
<a name="l00619"></a>00619     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData  <span class="comment">//!&lt; The receiver data. The m_pvt.time struct is updated.    </span>
<a name="l00620"></a>00620 <span class="comment"></span>    )
<a name="l00621"></a>00621   {
<a name="l00622"></a>00622     <a class="code" href="time__conversion_8c.html#c5bd7797ef31f234136d0e35d16be131" title="Computes UTC time from GPS time.">TIMECONV_GetUTCTimeFromGPSTime</a>(
<a name="l00623"></a>00623       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a>,
<a name="l00624"></a>00624       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#8b202682d7db43680e6d1508eebe5187" title="The GPS time of week (0-604800.0) (receiver time of observation) [s].">gps_tow</a>,
<a name="l00625"></a>00625       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#327de1405e770a2dcbc20639dc35fae6" title="Universal Time Coordinated [year].">utc_year</a>,
<a name="l00626"></a>00626       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c2bedf31ed34cce57f2d646f536eeb6f" title="Universal Time Coordinated [1-12 months].">utc_month</a>,
<a name="l00627"></a>00627       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#bda5393e0c6475947227ec445e8871c6" title="Universal Time Coordinated [1-31 days].">utc_day</a>,
<a name="l00628"></a>00628       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#5ed11e24150335f92ca07949759676ac" title="Universal Time Coordinated [hours].">utc_hour</a>,
<a name="l00629"></a>00629       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#f58c69c9e89334f273692e1e009bb285" title="Universal Time Coordinated [minutes].">utc_minute</a>,
<a name="l00630"></a>00630       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#85c08fff2a49b548af78f1f1157e0259" title="Universal Time Coordinated [s].">utc_seconds</a>
<a name="l00631"></a>00631       );
<a name="l00632"></a>00632 
<a name="l00633"></a>00633     <a class="code" href="time__conversion_8c.html#b7ebba6f72eed2330412b9d310684eaf" title="Determines the day of year given the year, month, and day.">TIMECONV_GetDayOfYear</a>(
<a name="l00634"></a>00634       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#327de1405e770a2dcbc20639dc35fae6" title="Universal Time Coordinated [year].">utc_year</a>,
<a name="l00635"></a>00635       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c2bedf31ed34cce57f2d646f536eeb6f" title="Universal Time Coordinated [1-12 months].">utc_month</a>,
<a name="l00636"></a>00636       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#bda5393e0c6475947227ec445e8871c6" title="Universal Time Coordinated [1-31 days].">utc_day</a>,
<a name="l00637"></a>00637       &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#daf2c09613583118299b94d6f3dfe14b" title="The number of days into the year (1-366) [days].">day_of_year</a> );
<a name="l00638"></a>00638       
<a name="l00639"></a>00639     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00640"></a>00640   }
<a name="l00641"></a>00641     
<a name="l00642"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b65e9ee3b9983ceb2583fd21982ddbe8">00642</a> 
<a name="l00643"></a>00643   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b65e9ee3b9983ceb2583fd21982ddbe8" title="Determine the satellite clock corrections, positions, and velocities for the rover...">GNSS_Estimator::DetermineSatellitePVT_GPSL1</a>( 
<a name="l00644"></a>00644     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,      <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l00645"></a>00645 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,  <span class="comment">//!&lt; The pointer to the reference receiver data. NULL if not available.</span>
<a name="l00646"></a>00646 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrValidEph      <span class="comment">//!&lt; The number of GPS L1 channels with valid ephemeris for the rover.</span>
<a name="l00647"></a>00647 <span class="comment"></span>    )
<a name="l00648"></a>00648   {
<a name="l00649"></a>00649     <span class="keywordtype">unsigned</span> i = 0;
<a name="l00650"></a>00650     <span class="keywordtype">double</span> psr = 0;
<a name="l00651"></a>00651     <span class="keywordtype">double</span> dtmp1 = 0;
<a name="l00652"></a>00652     <span class="keywordtype">double</span> dtmp2 = 0;
<a name="l00653"></a>00653     <span class="keywordtype">bool</span> isEphAvailable = <span class="keyword">false</span>;
<a name="l00654"></a>00654     <a class="code" href="struct_g_p_s__struct_ephemeris.html" title="A set of satellite orbit parameters that is used to calculate GPS satellite positions...">GPS_structEphemeris</a> eph;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656     memset( &amp;eph, 0, <span class="keyword">sizeof</span>(eph) );
<a name="l00657"></a>00657 
<a name="l00658"></a>00658     <span class="keywordflow">if</span>( rxData == NULL )
<a name="l00659"></a>00659       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00660"></a>00660 
<a name="l00661"></a>00661     <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l00662"></a>00662     {
<a name="l00663"></a>00663       <span class="comment">// Evaluate the satellite PVT for all channels with GPS L1 observations </span>
<a name="l00664"></a>00664       <span class="comment">// for the reference station.</span>
<a name="l00665"></a>00665       <span class="keywordflow">for</span>( i = 0; i &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l00666"></a>00666       {
<a name="l00667"></a>00667         <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l00668"></a>00668         {
<a name="l00669"></a>00669           <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l00670"></a>00670           {
<a name="l00671"></a>00671             <span class="comment">// Obtain the transmit time. Use an approximate psr measurement if one is not present.</span>
<a name="l00672"></a>00672             <span class="comment">// The true transmit time includes compensatation for the satellite clock effects.            </span>
<a name="l00673"></a>00673             <span class="comment">// p. 88 ICD-GPS-200C      </span>
<a name="l00674"></a>00674 
<a name="l00675"></a>00675             rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a> = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a>;
<a name="l00676"></a>00676 
<a name="l00677"></a>00677             <span class="comment">// first determine rough transmit time</span>
<a name="l00678"></a>00678             <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#6724b397743221c2db515050b9afc822" title="Indicates if the code tracking is locked.">isCodeLocked</a> &amp; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#24fab8b68341152492887ca038ce3cfc" title="Indicates if the pseudorange valid for use.">isPsrValid</a> )
<a name="l00679"></a>00679             { 
<a name="l00680"></a>00680               psr = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#9bbfa0f14f3ab1f96d1a93144333e876" title="The pseudorange measurement [m].">psr</a>;
<a name="l00681"></a>00681             }
<a name="l00682"></a>00682             <span class="keywordflow">else</span>
<a name="l00683"></a>00683             {
<a name="l00684"></a>00684               psr = 0.070*<a class="code" href="constants_8h.html#db62b9aad32043fd8f39af9289dbb1c3" title="light speed constant defined in ICD-GPS-200C p. 89 [m/s]">LIGHTSPEED</a>; <span class="comment">// 0.070 rough transmission time</span>
<a name="l00685"></a>00685             }
<a name="l00686"></a>00686             <span class="comment">// Compute the rough transmit time.</span>
<a name="l00687"></a>00687             rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#8b202682d7db43680e6d1508eebe5187" title="The GPS time of week (0-604800.0) (receiver time of observation) [s].">gps_tow</a> - psr/<a class="code" href="constants_8h.html#db62b9aad32043fd8f39af9289dbb1c3" title="light speed constant defined in ICD-GPS-200C p. 89 [m/s]">LIGHTSPEED</a>;
<a name="l00688"></a>00688 
<a name="l00689"></a>00689             <span class="comment">// Adjust for week rollover.</span>
<a name="l00690"></a>00690             <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> &lt; 0 )
<a name="l00691"></a>00691             {
<a name="l00692"></a>00692               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> += <a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a>;
<a name="l00693"></a>00693               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a> = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a> - 1;
<a name="l00694"></a>00694             }
<a name="l00695"></a>00695             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> &gt; <a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a> )
<a name="l00696"></a>00696             {
<a name="l00697"></a>00697               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> -= <a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a>;
<a name="l00698"></a>00698               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a> = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a> + 1;
<a name="l00699"></a>00699             }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701             <span class="comment">// Get the ephemeris.</span>
<a name="l00702"></a>00702             <span class="keywordflow">if</span>( !rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#4acfaf2ee3d9dbb160cedc1845b17068">m_EphAlmArray</a>.<a class="code" href="class_g_n_s_s_1_1_g_p_s___broadcast_ephemeris_and_almanac_array.html#a9ad11c2fb7a1b40c502ff5d8979fe85" title="Try to get the most current ephemeris or the ephemeris with the issue of data (ephemeris)...">GetEphemeris</a>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>, eph, isEphAvailable ) )
<a name="l00703"></a>00703               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00704"></a>00704             <span class="keywordflow">if</span>( !isEphAvailable )
<a name="l00705"></a>00705             {
<a name="l00706"></a>00706               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">false</span>;
<a name="l00707"></a>00707               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">false</span>;
<a name="l00708"></a>00708               <span class="keywordflow">continue</span>;
<a name="l00709"></a>00709             }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711             <span class="comment">// Account for week rollover if needed.</span>
<a name="l00712"></a>00712             <span class="keywordflow">if</span>( eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a> &lt; 1024 )
<a name="l00713"></a>00713               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a> += 1024;
<a name="l00714"></a>00714 
<a name="l00715"></a>00715 
<a name="l00716"></a>00716             <span class="comment">// Check the age of the clock information for the ephemeris.</span>
<a name="l00717"></a>00717             dtmp1 = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a>*<a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a> + rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a>;
<a name="l00718"></a>00718             dtmp2 = eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a>*<a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a> + eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#599e22f5e252be76c5891df2d08af31e" title="reference time ephemeris (0-604800) [s]">toe</a>;
<a name="l00719"></a>00719             rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#a0e25eb931615ddd98a5b02fccdb115a" title="The difference between the current measurement time and the time of ephemeris.">ageOfEph</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dtmp1 - dtmp2);
<a name="l00720"></a>00720             <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#a0e25eb931615ddd98a5b02fccdb115a" title="The difference between the current measurement time and the time of ephemeris.">ageOfEph</a> &gt; static_cast&lt;int&gt;(rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#f46eb6275829f15521182d392863799b">m_maxAgeEphemeris</a>) )
<a name="l00721"></a>00721             {
<a name="l00722"></a>00722               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">false</span>;
<a name="l00723"></a>00723               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">false</span>; <span class="comment">// old ephemeris data</span>
<a name="l00724"></a>00724               <span class="keywordflow">continue</span>;
<a name="l00725"></a>00725             }
<a name="l00726"></a>00726             <span class="keywordflow">else</span>
<a name="l00727"></a>00727             {
<a name="l00728"></a>00728               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">true</span>;
<a name="l00729"></a>00729             }
<a name="l00730"></a>00730 
<a name="l00731"></a>00731             rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">true</span>;
<a name="l00732"></a>00732 
<a name="l00733"></a>00733             <span class="comment">// Compute the satellite clock corrections, position, velocity, etc.</span>
<a name="l00734"></a>00734             <a class="code" href="gps_8c.html#b3d43488be544277973e736d7d6f1dc0">GPS_ComputeSatellitePositionVelocityAzimuthElevationDoppler_BasedOnEphmerisData</a>(
<a name="l00735"></a>00735               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#246c5aa253100ca7348dc9c81a933697" title="The user&amp;#39;s ECEF position, X [m].">x</a>,
<a name="l00736"></a>00736               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5880313b8a0313c57985b3b7a533d0f8" title="The user&amp;#39;s ECEF position, Y [m].">y</a>,
<a name="l00737"></a>00737               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#32a4c3846d60a40dcee6d3936d570c30" title="The user&amp;#39;s ECEF position, Z [m].">z</a>,
<a name="l00738"></a>00738               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a>,
<a name="l00739"></a>00739               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a>,              
<a name="l00740"></a>00740               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a>,
<a name="l00741"></a>00741               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#599e22f5e252be76c5891df2d08af31e" title="reference time ephemeris (0-604800) [s]">toe</a>,
<a name="l00742"></a>00742               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#033cec0e40fb5ae8a03b474591244bea" title="reference time (clock) (0-604800) [s]">toc</a>,
<a name="l00743"></a>00743               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#69415cd72e7a074f53c4edce5e5cc380" title="polynomial clock correction coefficient (clock bias) [s] Note: parameters from ephemeris...">af0</a>,
<a name="l00744"></a>00744               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#f6f218258806fe35e68683c0f51438c4" title="polynomial clock correction coefficient (clock drift) [s/s] Note: parameters from...">af1</a>,
<a name="l00745"></a>00745               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#be548d3be352dcb183087187ba173ab9" title="polynomial clock correction coefficient (rate of clock drift) [s/s^2]">af2</a>,
<a name="l00746"></a>00746               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#6404c39268a1be715c95c24c1a14414b" title="group delay [s]">tgd</a>,
<a name="l00747"></a>00747               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a13fb2cbb1989935031a7d5c8cc12ec0" title="mean anomaly at reference time [rad]">m0</a>, 
<a name="l00748"></a>00748               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#7f4751374f4d4d4e139d6df0a9bebe29" title="mean motion difference from computed value [rad/s]">delta_n</a>,
<a name="l00749"></a>00749               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#7859bcda1769f3f0ccc238dd61406e82" title="eccentricity []">ecc</a>, 
<a name="l00750"></a>00750               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#709106af7c7ee908cf3c5de600ed51ae" title="square root of the semi-major axis [m^(1/2)]">sqrta</a>, 
<a name="l00751"></a>00751               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#03ffce666d4ed89d62433d034a34330b" title="longitude of ascending node of orbit plane at weekly epoch [rad]">omega0</a>,
<a name="l00752"></a>00752               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#d0ad8b031e0eb956b4e1c9c660466681" title="inclination angle at reference time [rad]">i0</a>,    
<a name="l00753"></a>00753               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#d405ec507db4d94e1612e3211a1c29bd" title="argument of perigee [rad]">w</a>,     
<a name="l00754"></a>00754               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#5bcef84cb0513bd6ecb78e82b98f6f0c" title="rate of right ascension [rad/s]">omegadot</a>,
<a name="l00755"></a>00755               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#174859d88c4bf8c87bdcf7334847e7d6" title="rate of inclination angle [rad/s]">idot</a>,    
<a name="l00756"></a>00756               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#9844e75782e05c7ab2fe27ef45715b1e" title="amplitude of the cosine harmonic correction term to the argument of latitude [rad]...">cuc</a>,     
<a name="l00757"></a>00757               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#ddc62f1e6f094b25953b5fe3cb42545d" title="amplitude of the sine harmonic correction term to the argument of latitude [rad]">cus</a>,     
<a name="l00758"></a>00758               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#41d7fa80a6bf3a63437af86338e3fbb3" title="amplitude of the cosine harmonic correction term to the orbit radius [m]">crc</a>,     
<a name="l00759"></a>00759               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#6c8cad7c6b03e71c57da4eb5e9820954" title="amplitude of the sine harmonic correction term to the orbit radius [m]">crs</a>,     
<a name="l00760"></a>00760               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#f7faefb5c87d846ad749dc5508922953" title="amplitude of the cosine harmonic correction term to the angle of inclination [rad]...">cic</a>,     
<a name="l00761"></a>00761               eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#33b7f917a6597fbb39c151115887bebc" title="amplitude of the sine harmonic correction term to the angle of inclination [rad]">cis</a>,     
<a name="l00762"></a>00762               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>,
<a name="l00763"></a>00763               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#107a0e6e2076c3b9270d7c2c1b8df0b3" title="The satellite clock drift correction [m/s].">clkdrift</a>,
<a name="l00764"></a>00764               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l00765"></a>00765               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l00766"></a>00766               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l00767"></a>00767               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#6cbc6e802e949053a17edad2a11ac985" title="The satellite velocity ECEF, vx [m].">vx</a>,
<a name="l00768"></a>00768               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#879ba363d94539392eadf52de73ee764" title="The satellite velocity ECEF, vy [m].">vy</a>,
<a name="l00769"></a>00769               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#4c043e4288fc3ab8ffb9ef7a18156bd2" title="The satellite velocity ECEF, vz [m].">vz</a>,
<a name="l00770"></a>00770               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#db204b3d1038ce37e7ec3cb7a8c45f77" title="The azimuth angle between the user and the satellite, measured clockwise positive...">azimuth</a>,
<a name="l00771"></a>00771               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#1fed91b01eb880a0c4678f5da10070e4" title="The elevation angle between the user and the satellite [rad].">elevation</a>,
<a name="l00772"></a>00772               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9c753955c23be9945a418655e605390e" title="The satellite doppler with respect to the user position [m/s], Note: User must convert...">doppler</a>
<a name="l00773"></a>00773               );
<a name="l00774"></a>00774 
<a name="l00775"></a>00775             rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#0699532e6e4cd81ac8888f9a265cc73d" title="The satellite clock correction (+ve is a delay) [m].">prcSatClk</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>);
<a name="l00776"></a>00776             rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#61fb890bd375af54fb9d04cc809b3bf3" title="The satellite clock drift rate correction (+ve is a rate delay) [m/s].">rrcSatClkDrift</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#107a0e6e2076c3b9270d7c2c1b8df0b3" title="The satellite clock drift correction [m/s].">clkdrift</a>);
<a name="l00777"></a>00777 
<a name="l00778"></a>00778             <span class="comment">// Compute the reference station geometric range and range rate.</span>
<a name="l00779"></a>00779             <a class="code" href="gps_8c.html#05848c2666fb341705235d685114f6d7">GPS_ComputeUserToSatelliteRangeAndRangeRate</a>(
<a name="l00780"></a>00780               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#246c5aa253100ca7348dc9c81a933697" title="The user&amp;#39;s ECEF position, X [m].">x</a>,
<a name="l00781"></a>00781               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5880313b8a0313c57985b3b7a533d0f8" title="The user&amp;#39;s ECEF position, Y [m].">y</a>,
<a name="l00782"></a>00782               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#32a4c3846d60a40dcee6d3936d570c30" title="The user&amp;#39;s ECEF position, Z [m].">z</a>,
<a name="l00783"></a>00783               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7e43a2bbff460a7741167e7377c59bb4" title="The user&amp;#39;s ECEF velocity, vx [m/s].">vx</a>,
<a name="l00784"></a>00784               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#91eb292fc8cc32975afa14cb60282932" title="The user&amp;#39;s ECEF velocity, vy [m/s].">vy</a>,
<a name="l00785"></a>00785               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#c4802af5efcee553222f127c406ab376" title="The user&amp;#39;s ECEF velocity, vz [m/s].">vz</a>,
<a name="l00786"></a>00786               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l00787"></a>00787               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l00788"></a>00788               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l00789"></a>00789               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#6cbc6e802e949053a17edad2a11ac985" title="The satellite velocity ECEF, vx [m].">vx</a>,
<a name="l00790"></a>00790               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#879ba363d94539392eadf52de73ee764" title="The satellite velocity ECEF, vy [m].">vy</a>,
<a name="l00791"></a>00791               rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#4c043e4288fc3ab8ffb9ef7a18156bd2" title="The satellite velocity ECEF, vz [m].">vz</a>,
<a name="l00792"></a>00792               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>,
<a name="l00793"></a>00793               &amp;rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b38a70ae40a3fadc3664067f4f80eccc" title="The best estimate of the geometric range rate between the antenna and the satellite...">rangerate</a> );
<a name="l00794"></a>00794           }
<a name="l00795"></a>00795         }
<a name="l00796"></a>00796       }
<a name="l00797"></a>00797     }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799     <span class="comment">// Evaluate the satellite PVT for all channesl with GPS L1 observations       </span>
<a name="l00800"></a>00800     <span class="comment">// for the rover station using the reference station ephemeris if available.   </span>
<a name="l00801"></a>00801     nrValidEph = 0;
<a name="l00802"></a>00802     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l00803"></a>00803     {
<a name="l00804"></a>00804       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l00805"></a>00805       {
<a name="l00806"></a>00806         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l00807"></a>00807         {
<a name="l00808"></a>00808           <span class="comment">// Obtain the transmit time. Use an approximate psr measurement if one is not present.</span>
<a name="l00809"></a>00809           <span class="comment">// The true transmit time includes compensatation for the satellite clock effects.            </span>
<a name="l00810"></a>00810           <span class="comment">// p. 88 ICD-GPS-200C      </span>
<a name="l00811"></a>00811 
<a name="l00812"></a>00812           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a>;
<a name="l00813"></a>00813 
<a name="l00814"></a>00814           <span class="comment">// first determine rough transmit time</span>
<a name="l00815"></a>00815           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#6724b397743221c2db515050b9afc822" title="Indicates if the code tracking is locked.">isCodeLocked</a> &amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#24fab8b68341152492887ca038ce3cfc" title="Indicates if the pseudorange valid for use.">isPsrValid</a> )
<a name="l00816"></a>00816           { 
<a name="l00817"></a>00817             psr = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#9bbfa0f14f3ab1f96d1a93144333e876" title="The pseudorange measurement [m].">psr</a>;
<a name="l00818"></a>00818           }
<a name="l00819"></a>00819           <span class="keywordflow">else</span>
<a name="l00820"></a>00820           {
<a name="l00821"></a>00821             psr = 0.070*<a class="code" href="constants_8h.html#db62b9aad32043fd8f39af9289dbb1c3" title="light speed constant defined in ICD-GPS-200C p. 89 [m/s]">LIGHTSPEED</a>; <span class="comment">// 0.070 rough transmission time</span>
<a name="l00822"></a>00822           }
<a name="l00823"></a>00823           <span class="comment">// Compute the rough transmit time.</span>
<a name="l00824"></a>00824           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#8b202682d7db43680e6d1508eebe5187" title="The GPS time of week (0-604800.0) (receiver time of observation) [s].">gps_tow</a> - psr/<a class="code" href="constants_8h.html#db62b9aad32043fd8f39af9289dbb1c3" title="light speed constant defined in ICD-GPS-200C p. 89 [m/s]">LIGHTSPEED</a>;
<a name="l00825"></a>00825 
<a name="l00826"></a>00826           <span class="comment">// Adjust for week rollover.</span>
<a name="l00827"></a>00827           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> &lt; 0 )
<a name="l00828"></a>00828           {
<a name="l00829"></a>00829             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> += <a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a>;
<a name="l00830"></a>00830             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a> - 1;
<a name="l00831"></a>00831           }
<a name="l00832"></a>00832           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> &gt; <a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a> )
<a name="l00833"></a>00833           {
<a name="l00834"></a>00834             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a> -= <a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a>;
<a name="l00835"></a>00835             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#c8bd860ed3dbc6081d25dbe9607d7371" title="The current GPS week associated with the observations [weeks].">gps_week</a> + 1;
<a name="l00836"></a>00836           }
<a name="l00837"></a>00837 
<a name="l00838"></a>00838           <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l00839"></a>00839           {
<a name="l00840"></a>00840             <span class="comment">// Get the ephemeris using the reference station if available.</span>
<a name="l00841"></a>00841             <span class="keywordflow">if</span>( !rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#4acfaf2ee3d9dbb160cedc1845b17068">m_EphAlmArray</a>.<a class="code" href="class_g_n_s_s_1_1_g_p_s___broadcast_ephemeris_and_almanac_array.html#a9ad11c2fb7a1b40c502ff5d8979fe85" title="Try to get the most current ephemeris or the ephemeris with the issue of data (ephemeris)...">GetEphemeris</a>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>, eph, isEphAvailable ) )
<a name="l00842"></a>00842               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00843"></a>00843             <span class="keywordflow">if</span>( !isEphAvailable )
<a name="l00844"></a>00844             {
<a name="l00845"></a>00845               <span class="comment">// Get the ephemeris using the rover station then.</span>
<a name="l00846"></a>00846               <span class="keywordflow">if</span>( !rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#4acfaf2ee3d9dbb160cedc1845b17068">m_EphAlmArray</a>.<a class="code" href="class_g_n_s_s_1_1_g_p_s___broadcast_ephemeris_and_almanac_array.html#a9ad11c2fb7a1b40c502ff5d8979fe85" title="Try to get the most current ephemeris or the ephemeris with the issue of data (ephemeris)...">GetEphemeris</a>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>, eph, isEphAvailable ) )
<a name="l00847"></a>00847                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00848"></a>00848               <span class="keywordflow">if</span>( !isEphAvailable )
<a name="l00849"></a>00849               {
<a name="l00850"></a>00850                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">false</span>;
<a name="l00851"></a>00851                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">false</span>; <span class="comment">// no reference station ephemeris data</span>
<a name="l00852"></a>00852                 <span class="keywordflow">continue</span>;
<a name="l00853"></a>00853               }
<a name="l00854"></a>00854             }
<a name="l00855"></a>00855           }
<a name="l00856"></a>00856           <span class="keywordflow">else</span>
<a name="l00857"></a>00857           {
<a name="l00858"></a>00858             <span class="comment">// Get the ephemeris using the rover station then.</span>
<a name="l00859"></a>00859             <span class="keywordflow">if</span>( !rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#4acfaf2ee3d9dbb160cedc1845b17068">m_EphAlmArray</a>.<a class="code" href="class_g_n_s_s_1_1_g_p_s___broadcast_ephemeris_and_almanac_array.html#a9ad11c2fb7a1b40c502ff5d8979fe85" title="Try to get the most current ephemeris or the ephemeris with the issue of data (ephemeris)...">GetEphemeris</a>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>, eph, isEphAvailable ) )
<a name="l00860"></a>00860               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00861"></a>00861             <span class="keywordflow">if</span>( !isEphAvailable )
<a name="l00862"></a>00862             {
<a name="l00863"></a>00863               rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">false</span>;
<a name="l00864"></a>00864               rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">false</span>; <span class="comment">// no reference station ephemeris data</span>
<a name="l00865"></a>00865               <span class="keywordflow">continue</span>;
<a name="l00866"></a>00866             }
<a name="l00867"></a>00867           }
<a name="l00868"></a>00868 
<a name="l00869"></a>00869           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">true</span>;
<a name="l00870"></a>00870 
<a name="l00871"></a>00871           <span class="comment">// Account for week rollover if needed.</span>
<a name="l00872"></a>00872           <span class="keywordflow">if</span>( eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a> &lt; 1024 )
<a name="l00873"></a>00873             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a> += 1024;
<a name="l00874"></a>00874 
<a name="l00875"></a>00875           <span class="comment">// Check the age of the clock information for the ephemeris.</span>
<a name="l00876"></a>00876           dtmp1 = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a>*<a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a> + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a>;
<a name="l00877"></a>00877           dtmp2 = eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a>*<a class="code" href="constants_8h.html#7e7087a54da1e633ceb9057a83bcbbec" title="[s]">SECONDS_IN_WEEK</a> + eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#599e22f5e252be76c5891df2d08af31e" title="reference time ephemeris (0-604800) [s]">toe</a>;
<a name="l00878"></a>00878           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#a0e25eb931615ddd98a5b02fccdb115a" title="The difference between the current measurement time and the time of ephemeris.">ageOfEph</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dtmp1 - dtmp2);
<a name="l00879"></a>00879           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#a0e25eb931615ddd98a5b02fccdb115a" title="The difference between the current measurement time and the time of ephemeris.">ageOfEph</a> &gt; static_cast&lt;int&gt;(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#f46eb6275829f15521182d392863799b">m_maxAgeEphemeris</a>) )
<a name="l00880"></a>00880           {
<a name="l00881"></a>00881             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">false</span>;
<a name="l00882"></a>00882             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> = <span class="keyword">false</span>; <span class="comment">// old ephemeris data</span>
<a name="l00883"></a>00883             <span class="keywordflow">continue</span>;
<a name="l00884"></a>00884           }
<a name="l00885"></a>00885           <span class="keywordflow">else</span>
<a name="l00886"></a>00886           {
<a name="l00887"></a>00887             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#43573678cdceae396184f2fb10f23609" title="This indicates if the pvt information is valid [1=valid, 0=invalid].">isValid</a> = <span class="keyword">true</span>;
<a name="l00888"></a>00888           }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890           <span class="comment">// Compute the satellite clock corrections, position, velocity, etc.</span>
<a name="l00891"></a>00891           <a class="code" href="gps_8c.html#b3d43488be544277973e736d7d6f1dc0">GPS_ComputeSatellitePositionVelocityAzimuthElevationDoppler_BasedOnEphmerisData</a>(
<a name="l00892"></a>00892             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#246c5aa253100ca7348dc9c81a933697" title="The user&amp;#39;s ECEF position, X [m].">x</a>,
<a name="l00893"></a>00893             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5880313b8a0313c57985b3b7a533d0f8" title="The user&amp;#39;s ECEF position, Y [m].">y</a>,
<a name="l00894"></a>00894             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#32a4c3846d60a40dcee6d3936d570c30" title="The user&amp;#39;s ECEF position, Z [m].">z</a>,
<a name="l00895"></a>00895             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#427b8eeb5d1364f327e753fc7bc07b39" title="The measurement gps week (at &amp;#39;transmit&amp;#39; time) [weeks].">week</a>,
<a name="l00896"></a>00896             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ab4ea2656419cdbddf1b744ec0bb5ca4" title="The measurement gps time of week (at &amp;#39;transmit&amp;#39; time) [s].">tow</a>,              
<a name="l00897"></a>00897             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a0e9f78d7e3fa8d1ff9719398545d0bc" title="10 bit gps week 0-1023 (user must account for week rollover ) [week]">week</a>,
<a name="l00898"></a>00898             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#599e22f5e252be76c5891df2d08af31e" title="reference time ephemeris (0-604800) [s]">toe</a>,
<a name="l00899"></a>00899             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#033cec0e40fb5ae8a03b474591244bea" title="reference time (clock) (0-604800) [s]">toc</a>,
<a name="l00900"></a>00900             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#69415cd72e7a074f53c4edce5e5cc380" title="polynomial clock correction coefficient (clock bias) [s] Note: parameters from ephemeris...">af0</a>,
<a name="l00901"></a>00901             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#f6f218258806fe35e68683c0f51438c4" title="polynomial clock correction coefficient (clock drift) [s/s] Note: parameters from...">af1</a>,
<a name="l00902"></a>00902             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#be548d3be352dcb183087187ba173ab9" title="polynomial clock correction coefficient (rate of clock drift) [s/s^2]">af2</a>,
<a name="l00903"></a>00903             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#6404c39268a1be715c95c24c1a14414b" title="group delay [s]">tgd</a>,
<a name="l00904"></a>00904             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#a13fb2cbb1989935031a7d5c8cc12ec0" title="mean anomaly at reference time [rad]">m0</a>, 
<a name="l00905"></a>00905             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#7f4751374f4d4d4e139d6df0a9bebe29" title="mean motion difference from computed value [rad/s]">delta_n</a>,
<a name="l00906"></a>00906             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#7859bcda1769f3f0ccc238dd61406e82" title="eccentricity []">ecc</a>, 
<a name="l00907"></a>00907             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#709106af7c7ee908cf3c5de600ed51ae" title="square root of the semi-major axis [m^(1/2)]">sqrta</a>, 
<a name="l00908"></a>00908             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#03ffce666d4ed89d62433d034a34330b" title="longitude of ascending node of orbit plane at weekly epoch [rad]">omega0</a>,
<a name="l00909"></a>00909             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#d0ad8b031e0eb956b4e1c9c660466681" title="inclination angle at reference time [rad]">i0</a>,    
<a name="l00910"></a>00910             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#d405ec507db4d94e1612e3211a1c29bd" title="argument of perigee [rad]">w</a>,     
<a name="l00911"></a>00911             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#5bcef84cb0513bd6ecb78e82b98f6f0c" title="rate of right ascension [rad/s]">omegadot</a>,
<a name="l00912"></a>00912             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#174859d88c4bf8c87bdcf7334847e7d6" title="rate of inclination angle [rad/s]">idot</a>,    
<a name="l00913"></a>00913             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#9844e75782e05c7ab2fe27ef45715b1e" title="amplitude of the cosine harmonic correction term to the argument of latitude [rad]...">cuc</a>,     
<a name="l00914"></a>00914             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#ddc62f1e6f094b25953b5fe3cb42545d" title="amplitude of the sine harmonic correction term to the argument of latitude [rad]">cus</a>,     
<a name="l00915"></a>00915             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#41d7fa80a6bf3a63437af86338e3fbb3" title="amplitude of the cosine harmonic correction term to the orbit radius [m]">crc</a>,     
<a name="l00916"></a>00916             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#6c8cad7c6b03e71c57da4eb5e9820954" title="amplitude of the sine harmonic correction term to the orbit radius [m]">crs</a>,     
<a name="l00917"></a>00917             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#f7faefb5c87d846ad749dc5508922953" title="amplitude of the cosine harmonic correction term to the angle of inclination [rad]...">cic</a>,     
<a name="l00918"></a>00918             eph.<a class="code" href="struct_g_p_s__struct_ephemeris.html#33b7f917a6597fbb39c151115887bebc" title="amplitude of the sine harmonic correction term to the angle of inclination [rad]">cis</a>,     
<a name="l00919"></a>00919             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>,
<a name="l00920"></a>00920             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#107a0e6e2076c3b9270d7c2c1b8df0b3" title="The satellite clock drift correction [m/s].">clkdrift</a>,
<a name="l00921"></a>00921             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l00922"></a>00922             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l00923"></a>00923             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l00924"></a>00924             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#6cbc6e802e949053a17edad2a11ac985" title="The satellite velocity ECEF, vx [m].">vx</a>,
<a name="l00925"></a>00925             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#879ba363d94539392eadf52de73ee764" title="The satellite velocity ECEF, vy [m].">vy</a>,
<a name="l00926"></a>00926             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#4c043e4288fc3ab8ffb9ef7a18156bd2" title="The satellite velocity ECEF, vz [m].">vz</a>,
<a name="l00927"></a>00927             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#db204b3d1038ce37e7ec3cb7a8c45f77" title="The azimuth angle between the user and the satellite, measured clockwise positive...">azimuth</a>,
<a name="l00928"></a>00928             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#1fed91b01eb880a0c4678f5da10070e4" title="The elevation angle between the user and the satellite [rad].">elevation</a>,
<a name="l00929"></a>00929             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9c753955c23be9945a418655e605390e" title="The satellite doppler with respect to the user position [m/s], Note: User must convert...">doppler</a>
<a name="l00930"></a>00930             );
<a name="l00931"></a>00931 
<a name="l00932"></a>00932           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#0699532e6e4cd81ac8888f9a265cc73d" title="The satellite clock correction (+ve is a delay) [m].">prcSatClk</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>);
<a name="l00933"></a>00933           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#61fb890bd375af54fb9d04cc809b3bf3" title="The satellite clock drift rate correction (+ve is a rate delay) [m/s].">rrcSatClkDrift</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#107a0e6e2076c3b9270d7c2c1b8df0b3" title="The satellite clock drift correction [m/s].">clkdrift</a>);
<a name="l00934"></a>00934 
<a name="l00935"></a>00935           <span class="comment">// Compute the rover station geometric range and range rate.</span>
<a name="l00936"></a>00936           <a class="code" href="gps_8c.html#05848c2666fb341705235d685114f6d7">GPS_ComputeUserToSatelliteRangeAndRangeRate</a>(
<a name="l00937"></a>00937             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#246c5aa253100ca7348dc9c81a933697" title="The user&amp;#39;s ECEF position, X [m].">x</a>,
<a name="l00938"></a>00938             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5880313b8a0313c57985b3b7a533d0f8" title="The user&amp;#39;s ECEF position, Y [m].">y</a>,
<a name="l00939"></a>00939             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#32a4c3846d60a40dcee6d3936d570c30" title="The user&amp;#39;s ECEF position, Z [m].">z</a>,
<a name="l00940"></a>00940             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7e43a2bbff460a7741167e7377c59bb4" title="The user&amp;#39;s ECEF velocity, vx [m/s].">vx</a>,
<a name="l00941"></a>00941             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#91eb292fc8cc32975afa14cb60282932" title="The user&amp;#39;s ECEF velocity, vy [m/s].">vy</a>,
<a name="l00942"></a>00942             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#c4802af5efcee553222f127c406ab376" title="The user&amp;#39;s ECEF velocity, vz [m/s].">vz</a>,
<a name="l00943"></a>00943             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l00944"></a>00944             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l00945"></a>00945             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l00946"></a>00946             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#6cbc6e802e949053a17edad2a11ac985" title="The satellite velocity ECEF, vx [m].">vx</a>,
<a name="l00947"></a>00947             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#879ba363d94539392eadf52de73ee764" title="The satellite velocity ECEF, vy [m].">vy</a>,
<a name="l00948"></a>00948             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#4c043e4288fc3ab8ffb9ef7a18156bd2" title="The satellite velocity ECEF, vz [m].">vz</a>,
<a name="l00949"></a>00949             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>,
<a name="l00950"></a>00950             &amp;rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b38a70ae40a3fadc3664067f4f80eccc" title="The best estimate of the geometric range rate between the antenna and the satellite...">rangerate</a> );
<a name="l00951"></a>00951 
<a name="l00952"></a>00952           nrValidEph++;
<a name="l00953"></a>00953         }
<a name="l00954"></a>00954       }
<a name="l00955"></a>00955     }
<a name="l00956"></a>00956     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00957"></a>00957   }
<a name="l00958"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570">00958</a> 
<a name="l00959"></a>00959   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">GNSS_Estimator::DetermineAtmosphericCorrections_GPSL1</a>( 
<a name="l00960"></a>00960     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData  <span class="comment">//!&lt; The receiver data.        </span>
<a name="l00961"></a>00961 <span class="comment"></span>    )
<a name="l00962"></a>00962   {
<a name="l00963"></a>00963     <span class="keywordtype">unsigned</span> i = 0;
<a name="l00964"></a>00964     <span class="keywordtype">double</span> zenith_dry_delay = 0;
<a name="l00965"></a>00965     <span class="keywordtype">double</span> zenith_wet_delay = 0;
<a name="l00966"></a>00966     <span class="keywordtype">double</span> dtmp1 = 0;
<a name="l00967"></a>00967     <span class="keywordtype">double</span> dtmp2 = 0;
<a name="l00968"></a>00968 
<a name="l00969"></a>00969     <span class="comment">// Compute the tropospheric delays.</span>
<a name="l00970"></a>00970     <a class="code" href="troposphere_8c.html#0721872fa0bd06144e9e22a876a646e8">TROPOSPHERE_DetermineZenithDelayValues_WAAS_Model</a>(
<a name="l00971"></a>00971       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l00972"></a>00972       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>,
<a name="l00973"></a>00973       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#daf2c09613583118299b94d6f3dfe14b" title="The number of days into the year (1-366) [days].">day_of_year</a>,
<a name="l00974"></a>00974       &amp;zenith_dry_delay,
<a name="l00975"></a>00975       &amp;zenith_wet_delay
<a name="l00976"></a>00976       );
<a name="l00977"></a>00977 
<a name="l00978"></a>00978     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l00979"></a>00979     {
<a name="l00980"></a>00980       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l00981"></a>00981       {
<a name="l00982"></a>00982         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l00983"></a>00983         {
<a name="l00984"></a>00984           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a> )
<a name="l00985"></a>00985           {
<a name="l00986"></a>00986             <span class="comment">// Always compute the tropospheric correction (it may not be applied though).</span>
<a name="l00987"></a>00987             <a class="code" href="troposphere_8c.html#b0b1ba2a0967d374dbe8387bf86442a9">TROPOSPHERE_GetDryAndWetDelay_UsingThe_UNBabc_MappingFunction</a>(
<a name="l00988"></a>00988               zenith_dry_delay, 
<a name="l00989"></a>00989               zenith_wet_delay, 
<a name="l00990"></a>00990               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#1fed91b01eb880a0c4678f5da10070e4" title="The elevation angle between the user and the satellite [rad].">elevation</a>,
<a name="l00991"></a>00991               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,              
<a name="l00992"></a>00992               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>,
<a name="l00993"></a>00993               &amp;dtmp1,
<a name="l00994"></a>00994               &amp;dtmp2
<a name="l00995"></a>00995               );
<a name="l00996"></a>00996             
<a name="l00997"></a>00997             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#e55daa21ff3be2775cd1a5e0c29f55b5" title="Tropospheric dry delay correction (+ve is a delay) [m].">prcTropoDry</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(dtmp1);
<a name="l00998"></a>00998             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#cae5168ec24729a74e643623dc129402" title="Tropospheric wet delay correction (+ve is a delay) [m].">prcTropoWet</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(dtmp2);
<a name="l00999"></a>00999 
<a name="l01000"></a>01000             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#8ffbfd3cca6a024812edb7f5a9896bf7" title="Is this structure valid for use 1=YES, 0=NO.">isValid</a> )
<a name="l01001"></a>01001             {
<a name="l01002"></a>01002               <span class="comment">// Always compute the ionospheric correction (it may not be applied though).</span>
<a name="l01003"></a>01003               <a class="code" href="ionosphere_8c.html#28d3f6884e8a2a7198f2a475ffead828" title="Given the user geodetic position, GPS time of week, the azimuth and elevation to...">IONOSPHERE_GetL1KlobucharCorrection</a>(
<a name="l01004"></a>01004                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#6875b8e2686ca600bc1c0560e25a062b" title="coefficients of a cubic equation representing the amplitude of the vertical delay...">alpha0</a>,
<a name="l01005"></a>01005                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#48176d64f1c65c1346850636d076e0c9" title="coefficients of a cubic equation representing the amplitude of the vertical delay...">alpha1</a>,
<a name="l01006"></a>01006                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#d3f754c297d84f2274c59a8ee927cc21" title="coefficients of a cubic equation representing the amplitude of the vertical delay...">alpha2</a>,
<a name="l01007"></a>01007                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#91abcbab78ca6a0f5fb18ebd70ee0068" title="coefficients of a cubic equation representing the amplitude of the vertical delay...">alpha3</a>,
<a name="l01008"></a>01008                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#8c010091561ef831ace50bdf0fd288dc" title="coefficients of a cubic equation representing the period of the model [s]">beta0</a>,
<a name="l01009"></a>01009                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#59c3c72821ed720d80a58d3293c1b721" title="coefficients of a cubic equation representing the period of the model [s/semi-circle]...">beta1</a>,
<a name="l01010"></a>01010                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#d3554f2b65645c4dc0b2a420e050a8f1" title="coefficients of a cubic equation representing the period of the model [s/semi-circle^2]...">beta2</a>,
<a name="l01011"></a>01011                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9a74f2a075fcf027835ca172d33481ed" title="The klobuchar ionospheric correction parameters for GPS.">m_klobuchar</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_klobuchar.html#81869e0d2ec6ff8e019d53298975a639" title="coefficients of a cubic equation representing the period of the model [s/semi-circle^3]...">beta3</a>,
<a name="l01012"></a>01012                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l01013"></a>01013                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>, 
<a name="l01014"></a>01014                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#1fed91b01eb880a0c4678f5da10070e4" title="The elevation angle between the user and the satellite [rad].">elevation</a>,
<a name="l01015"></a>01015                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#db204b3d1038ce37e7ec3cb7a8c45f77" title="The azimuth angle between the user and the satellite, measured clockwise positive...">azimuth</a>,
<a name="l01016"></a>01016                 rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#8b202682d7db43680e6d1508eebe5187" title="The GPS time of week (0-604800.0) (receiver time of observation) [s].">gps_tow</a>,
<a name="l01017"></a>01017                 &amp;dtmp1
<a name="l01018"></a>01018                 );
<a name="l01019"></a>01019               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#71bdb2cf554c1c2219d262eb7e0ecc13" title="Ionospheric correction (+ve is a delay) [m].">prcIono</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(dtmp1);
<a name="l01020"></a>01020             }
<a name="l01021"></a>01021           }
<a name="l01022"></a>01022         }
<a name="l01023"></a>01023       }
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01026"></a>01026   }
<a name="l01027"></a>01027 
<a name="l01028"></a>01028 
<a name="l01029"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad">01029</a> 
<a name="l01030"></a>01030   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">GNSS_Estimator::DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( 
<a name="l01031"></a>01031     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,            <span class="comment">//!&lt; The receiver data.</span>
<a name="l01032"></a>01032 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrUsablePseudoranges  <span class="comment">//!&lt; the number of usable GPS L1 pseudorange measurements.</span>
<a name="l01033"></a>01033 <span class="comment"></span>    )
<a name="l01034"></a>01034   {
<a name="l01035"></a>01035     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01036"></a>01036     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> isGood = 0;
<a name="l01037"></a>01037 
<a name="l01038"></a>01038     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8cfb82c0b9a001d720ddc97238d90443" title="This indicates the number of valid pseudorange observations valid before adjustment...">nrPsrObsAvailable</a> = 0;
<a name="l01039"></a>01039     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a655b1955627ab1a33ed67835d5c9830" title="This indicates the number of valid pseudorange observations valid after adjustment...">nrPsrObsUsed</a> = 0;
<a name="l01040"></a>01040     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#ac3a4e55d334a51e8eff543dec0a38b5" title="This indicates the number of valid pseudorange observations rejected during adjustment...">nrPsrObsRejected</a> = 0;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042     nrUsablePseudoranges = 0;    
<a name="l01043"></a>01043     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01044"></a>01044     {
<a name="l01045"></a>01045       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01046"></a>01046       {
<a name="l01047"></a>01047         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01048"></a>01048         {
<a name="l01049"></a>01049           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#1fed91b01eb880a0c4678f5da10070e4" title="The elevation angle between the user and the satellite [rad].">elevation</a> &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#2b78bbca4ca0bca0c64b08f844ce4756">m_elevationMask</a> )              
<a name="l01050"></a>01050           {
<a name="l01051"></a>01051             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> = 0;
<a name="l01052"></a>01052           }
<a name="l01053"></a>01053           <span class="keywordflow">else</span>
<a name="l01054"></a>01054           {
<a name="l01055"></a>01055             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> = 1;
<a name="l01056"></a>01056           }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#c9bea88e7c63db00e172b92085201354" title="The carrier to noise density ratio for this channel [dB-Hz].">cno</a> &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#329804b1acff1d8b9b5f7b593b597f6b">m_cnoMask</a> )
<a name="l01059"></a>01059           {
<a name="l01060"></a>01060             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a> = 0;
<a name="l01061"></a>01061           }
<a name="l01062"></a>01062           <span class="keywordflow">else</span>
<a name="l01063"></a>01063           {
<a name="l01064"></a>01064             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a> = 1;
<a name="l01065"></a>01065           }
<a name="l01066"></a>01066 
<a name="l01067"></a>01067           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#059dd347177f63d7bfc4d94f39da60b1" title="The number of seconds of continous phase tracking (no known cycle slips) [s].">locktime</a> &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9e1f26baac698d170e17ddcdbedc714a">m_locktimeMask</a> )
<a name="l01068"></a>01068           {
<a name="l01069"></a>01069             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a> = 0;
<a name="l01070"></a>01070           }
<a name="l01071"></a>01071           <span class="keywordflow">else</span>
<a name="l01072"></a>01072           {
<a name="l01073"></a>01073             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a> = 1;
<a name="l01074"></a>01074           }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076           isGood = 
<a name="l01077"></a>01077             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#6724b397743221c2db515050b9afc822" title="Indicates if the code tracking is locked.">isCodeLocked</a>         &amp; 
<a name="l01078"></a>01078             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#24fab8b68341152492887ca038ce3cfc" title="Indicates if the pseudorange valid for use.">isPsrValid</a>           &amp;
<a name="l01079"></a>01079             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> &amp;
<a name="l01080"></a>01080             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a>       &amp;
<a name="l01081"></a>01081             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a>  &amp;
<a name="l01082"></a>01082             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2ec0bf073891c2887dbb7468fbdc25fa" title="Indicates if the user has not forced the rejection of this channel or PRN.">isNotUserRejected</a>    &amp;
<a name="l01083"></a>01083             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3715357201615d87ae238bc42b71ef24" title="Indicates if the pseudorange was not rejetced (ie Fault Detection and Exclusion)...">isNotPsrRejected</a>     &amp;
<a name="l01084"></a>01084             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a>;
<a name="l01085"></a>01085           <span class="keywordflow">if</span>( isGood )
<a name="l01086"></a>01086           {
<a name="l01087"></a>01087             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> = 1;
<a name="l01088"></a>01088             nrUsablePseudoranges++;            
<a name="l01089"></a>01089           }
<a name="l01090"></a>01090           <span class="keywordflow">else</span>
<a name="l01091"></a>01091           {
<a name="l01092"></a>01092             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> = 0;
<a name="l01093"></a>01093           }
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095       }
<a name="l01096"></a>01096     }
<a name="l01097"></a>01097     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8cfb82c0b9a001d720ddc97238d90443" title="This indicates the number of valid pseudorange observations valid before adjustment...">nrPsrObsAvailable</a> = nrUsablePseudoranges;
<a name="l01098"></a>01098     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01099"></a>01099   }
<a name="l01100"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#8c7fdda095926c02f0670d51812596cb">01100</a> 
<a name="l01101"></a>01101   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#8c7fdda095926c02f0670d51812596cb" title="Determine the usable GPS L1 ADR measurements.">GNSS_Estimator::DetermineUsableAdrMeasurements_GPSL1</a>( 
<a name="l01102"></a>01102     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,   <span class="comment">//!&lt; The receiver data.</span>
<a name="l01103"></a>01103 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrUsableAdr  <span class="comment">//!&lt; The number of usable GPS L1 adr measurements.</span>
<a name="l01104"></a>01104 <span class="comment"></span>    )
<a name="l01105"></a>01105   {
<a name="l01106"></a>01106     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01107"></a>01107     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> isGood = 0;
<a name="l01108"></a>01108 
<a name="l01109"></a>01109     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b17846986755cd562be047c55f9031ad" title="This indicates the number of valid ADR observations valid before adjustment.">nrAdrObsAvailable</a> = 0;
<a name="l01110"></a>01110     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#d4c0efc0809d11ab8ce2c4839e74a9fb" title="This indicates the number of valid ADR observations valid after adjustment.">nrAdrObsUsed</a> = 0;
<a name="l01111"></a>01111     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#4c41fd5beff768ecc6d15f285b9dca9e" title="This indicates the number of valid ADR observations rejected during adjustment.">nrAdrObsRejected</a> = 0;
<a name="l01112"></a>01112 
<a name="l01113"></a>01113     <span class="comment">// Check for cycle slips.</span>
<a name="l01114"></a>01114     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#7275743ab490950179a0985e475c2ed8" title="Check for cycle slips using the phase rate prediction method.">CheckForCycleSlips_UsingPhaseRatePrediction</a>( GNSS_CYCLESLIP_THREADHOLD );
<a name="l01115"></a>01115 
<a name="l01116"></a>01116     nrUsableAdr = 0;    
<a name="l01117"></a>01117     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01118"></a>01118     {
<a name="l01119"></a>01119       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01120"></a>01120       {
<a name="l01121"></a>01121         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01122"></a>01122         {
<a name="l01123"></a>01123           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#1fed91b01eb880a0c4678f5da10070e4" title="The elevation angle between the user and the satellite [rad].">elevation</a> &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#2b78bbca4ca0bca0c64b08f844ce4756">m_elevationMask</a> )              
<a name="l01124"></a>01124             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> = 0;
<a name="l01125"></a>01125           <span class="keywordflow">else</span>
<a name="l01126"></a>01126             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> = 1;
<a name="l01127"></a>01127 
<a name="l01128"></a>01128           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#c9bea88e7c63db00e172b92085201354" title="The carrier to noise density ratio for this channel [dB-Hz].">cno</a> &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#329804b1acff1d8b9b5f7b593b597f6b">m_cnoMask</a> )
<a name="l01129"></a>01129             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a> = 0;
<a name="l01130"></a>01130           <span class="keywordflow">else</span>
<a name="l01131"></a>01131             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a> = 1;
<a name="l01132"></a>01132 
<a name="l01133"></a>01133           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#059dd347177f63d7bfc4d94f39da60b1" title="The number of seconds of continous phase tracking (no known cycle slips) [s].">locktime</a> &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#9e1f26baac698d170e17ddcdbedc714a">m_locktimeMask</a> )
<a name="l01134"></a>01134             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a> = 0;
<a name="l01135"></a>01135           <span class="keywordflow">else</span>
<a name="l01136"></a>01136             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a> = 1;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138           isGood = 
<a name="l01139"></a>01139             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#6724b397743221c2db515050b9afc822" title="Indicates if the code tracking is locked.">isCodeLocked</a>         &amp;
<a name="l01140"></a>01140             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#7d622e83565afc24fd6837ad5cebaa18" title="Indicates if the phase tracking is locked.">isPhaseLocked</a>        &amp;
<a name="l01141"></a>01141             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2abca7508276e82a92abd05211ae115c" title="Indicates if the phase parity if valid.">isParityValid</a>        &amp; <span class="comment">// if not, there is a half cycle amibiguity.</span>
<a name="l01142"></a>01142             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2eb226fe569d2436e6ba193bb7955cc8" title="Indicates if the ADR is valid for use.">isAdrValid</a>           &amp;
<a name="l01143"></a>01143             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> &amp;
<a name="l01144"></a>01144             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a>       &amp;
<a name="l01145"></a>01145             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a>  &amp;
<a name="l01146"></a>01146             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2ec0bf073891c2887dbb7468fbdc25fa" title="Indicates if the user has not forced the rejection of this channel or PRN.">isNotUserRejected</a>    &amp;
<a name="l01147"></a>01147             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#7fa9d83a5a27be6741ac759dd8f0b079" title="Indicates if the ADR was not rejetced (ie Fault Detection and Exclusion).">isNotAdrRejected</a>     &amp;
<a name="l01148"></a>01148             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a>;
<a name="l01149"></a>01149           <span class="keywordflow">if</span>( isGood )
<a name="l01150"></a>01150           {
<a name="l01151"></a>01151             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> = 1;
<a name="l01152"></a>01152             nrUsableAdr++;            
<a name="l01153"></a>01153           }
<a name="l01154"></a>01154           <span class="keywordflow">else</span>
<a name="l01155"></a>01155           {
<a name="l01156"></a>01156             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> = 0;
<a name="l01157"></a>01157           }
<a name="l01158"></a>01158         }
<a name="l01159"></a>01159       }
<a name="l01160"></a>01160     }
<a name="l01161"></a>01161     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b17846986755cd562be047c55f9031ad" title="This indicates the number of valid ADR observations valid before adjustment.">nrAdrObsAvailable</a> = nrUsableAdr;
<a name="l01162"></a>01162     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01163"></a>01163   }
<a name="l01164"></a>01164 
<a name="l01165"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0325ac1ddd31befdbfc2a8b67e97c69c">01165</a> 
<a name="l01166"></a>01166   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0325ac1ddd31befdbfc2a8b67e97c69c" title="Determine the differential GPS L1 pseudorange measurements.">GNSS_Estimator::DetermineDifferentialPseudorangeMeasurementsForThePositionSolution_GPSL1</a>( 
<a name="l01167"></a>01167     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,                  <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l01168"></a>01168 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,              <span class="comment">//!&lt; The pointer to the reference receiver data. </span>
<a name="l01169"></a>01169 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> setToUseOnlyDifferential,  <span class="comment">//!&lt; This indicates that only differential measurements should be used.</span>
<a name="l01170"></a>01170 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrDifferentialPseudoranges  <span class="comment">//!&lt; The number of usable GPS L1 pseudorange measurements.    </span>
<a name="l01171"></a>01171 <span class="comment"></span>    )
<a name="l01172"></a>01172   {
<a name="l01173"></a>01173     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01174"></a>01174     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01175"></a>01175     <span class="comment">//unsigned char isGood = 0;</span>
<a name="l01176"></a>01176 
<a name="l01177"></a>01177     <span class="comment">// Initial the indices of the corresponding differential measurements.</span>
<a name="l01178"></a>01178     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ ) 
<a name="l01179"></a>01179     { 
<a name="l01180"></a>01180       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a> = -1; 
<a name="l01181"></a>01181       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#332a9168a908b717038f190150ac34de" title="Indicates if a matching pseudrange observation is available from another receiver...">isDifferentialPsrAvailable</a> = 0;      
<a name="l01182"></a>01182     }
<a name="l01183"></a>01183     <span class="keywordflow">for</span>( i = 0; i &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ ) 
<a name="l01184"></a>01184     { 
<a name="l01185"></a>01185       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a> = -1; 
<a name="l01186"></a>01186       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#332a9168a908b717038f190150ac34de" title="Indicates if a matching pseudrange observation is available from another receiver...">isDifferentialPsrAvailable</a> = 0;
<a name="l01187"></a>01187     }
<a name="l01188"></a>01188 
<a name="l01189"></a>01189     nrDifferentialPseudoranges = 0;    
<a name="l01190"></a>01190     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01191"></a>01191     {
<a name="l01192"></a>01192       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01193"></a>01193       {
<a name="l01194"></a>01194         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01195"></a>01195         {
<a name="l01196"></a>01196           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01197"></a>01197           {
<a name="l01198"></a>01198             <span class="comment">// Look for a matching differential channel in the base station data.</span>
<a name="l01199"></a>01199             <span class="keywordflow">for</span>( j = 0; j &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; j++ )
<a name="l01200"></a>01200             {
<a name="l01201"></a>01201               <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01202"></a>01202               {
<a name="l01203"></a>01203                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01204"></a>01204                 {
<a name="l01205"></a>01205                   <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> )
<a name="l01206"></a>01206                   {                      
<a name="l01207"></a>01207                     <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01208"></a>01208                     {
<a name="l01209"></a>01209                       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#332a9168a908b717038f190150ac34de" title="Indicates if a matching pseudrange observation is available from another receiver...">isDifferentialPsrAvailable</a> = 1;
<a name="l01210"></a>01210                       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#332a9168a908b717038f190150ac34de" title="Indicates if a matching pseudrange observation is available from another receiver...">isDifferentialPsrAvailable</a> = 1;
<a name="l01211"></a>01211                       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a>     = j;
<a name="l01212"></a>01212                       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a> = i;
<a name="l01213"></a>01213                       
<a name="l01214"></a>01214                       nrDifferentialPseudoranges++;
<a name="l01215"></a>01215                     }
<a name="l01216"></a>01216                   }
<a name="l01217"></a>01217                 }
<a name="l01218"></a>01218               }
<a name="l01219"></a>01219             }
<a name="l01220"></a>01220           }
<a name="l01221"></a>01221         }
<a name="l01222"></a>01222       }
<a name="l01223"></a>01223     }
<a name="l01224"></a>01224 
<a name="l01225"></a>01225     <span class="keywordflow">if</span>( setToUseOnlyDifferential )
<a name="l01226"></a>01226     {
<a name="l01227"></a>01227       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01228"></a>01228       {
<a name="l01229"></a>01229         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01230"></a>01230         {
<a name="l01231"></a>01231           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01232"></a>01232           {
<a name="l01233"></a>01233             <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01234"></a>01234             {
<a name="l01235"></a>01235               <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#332a9168a908b717038f190150ac34de" title="Indicates if a matching pseudrange observation is available from another receiver...">isDifferentialPsrAvailable</a> )
<a name="l01236"></a>01236               {
<a name="l01237"></a>01237                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> = 1;
<a name="l01238"></a>01238                 <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l01239"></a>01239                   rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> = 1;                
<a name="l01240"></a>01240               }
<a name="l01241"></a>01241               <span class="keywordflow">else</span>
<a name="l01242"></a>01242               {
<a name="l01243"></a>01243                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> = 0;
<a name="l01244"></a>01244                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> = 0;
<a name="l01245"></a>01245               }
<a name="l01246"></a>01246             }
<a name="l01247"></a>01247           }
<a name="l01248"></a>01248         }
<a name="l01249"></a>01249       }
<a name="l01250"></a>01250     }
<a name="l01251"></a>01251 
<a name="l01252"></a>01252     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01253"></a>01253   }
<a name="l01254"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#9046c3495a8b425bc111a6312e5c91f4">01254</a> 
<a name="l01255"></a>01255   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#9046c3495a8b425bc111a6312e5c91f4" title="Determine the differential GPS L1 ADR measurements. Allow only differential ADR measurements...">GNSS_Estimator::DetermineDifferentialAdrMeasurements_GPSL1</a>( 
<a name="l01256"></a>01256     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,                  <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l01257"></a>01257 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,              <span class="comment">//!&lt; The pointer to the reference receiver data. </span>
<a name="l01258"></a>01258 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> setToUseOnlyDifferential,  <span class="comment">//!&lt; This indicates that only differential measurements should be used.</span>
<a name="l01259"></a>01259 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrDifferentialAdr           <span class="comment">//!&lt; The number of usable GPS L1 ADR measurements.        </span>
<a name="l01260"></a>01260 <span class="comment"></span>    )
<a name="l01261"></a>01261   {
<a name="l01262"></a>01262     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01263"></a>01263     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01264"></a>01264     <span class="comment">//unsigned char isGood = 0;</span>
<a name="l01265"></a>01265 
<a name="l01266"></a>01266     <span class="comment">// Initial the indices of the corresponding differential measurements.</span>
<a name="l01267"></a>01267     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ ) 
<a name="l01268"></a>01268     { 
<a name="l01269"></a>01269       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a> = -1; 
<a name="l01270"></a>01270       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> = 0;      
<a name="l01271"></a>01271     }
<a name="l01272"></a>01272     <span class="keywordflow">for</span>( i = 0; i &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ ) 
<a name="l01273"></a>01273     { 
<a name="l01274"></a>01274       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a> = -1; 
<a name="l01275"></a>01275       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> = 0;
<a name="l01276"></a>01276     }
<a name="l01277"></a>01277 
<a name="l01278"></a>01278     nrDifferentialAdr = 0;    
<a name="l01279"></a>01279     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01280"></a>01280     {
<a name="l01281"></a>01281       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01282"></a>01282       {
<a name="l01283"></a>01283         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01284"></a>01284         {
<a name="l01285"></a>01285           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l01286"></a>01286           {
<a name="l01287"></a>01287             <span class="comment">// Look for a matching differential channel in the base station data.</span>
<a name="l01288"></a>01288             <span class="keywordflow">for</span>( j = 0; j &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; j++ )
<a name="l01289"></a>01289             {
<a name="l01290"></a>01290               <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01291"></a>01291               {
<a name="l01292"></a>01292                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01293"></a>01293                 {
<a name="l01294"></a>01294                   <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> )
<a name="l01295"></a>01295                   {                      
<a name="l01296"></a>01296                     <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l01297"></a>01297                     {
<a name="l01298"></a>01298                       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> = 1;
<a name="l01299"></a>01299                       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> = 1;
<a name="l01300"></a>01300                       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a>     = j;
<a name="l01301"></a>01301                       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a> = i;
<a name="l01302"></a>01302                       
<a name="l01303"></a>01303                       nrDifferentialAdr++;
<a name="l01304"></a>01304                     }
<a name="l01305"></a>01305                   }
<a name="l01306"></a>01306                 }
<a name="l01307"></a>01307               }
<a name="l01308"></a>01308             }
<a name="l01309"></a>01309           }
<a name="l01310"></a>01310         }
<a name="l01311"></a>01311       }
<a name="l01312"></a>01312     }
<a name="l01313"></a>01313 
<a name="l01314"></a>01314     <span class="keywordflow">if</span>( setToUseOnlyDifferential ) <span class="comment">// always use only differntial ADR measurements</span>
<a name="l01315"></a>01315     {
<a name="l01316"></a>01316       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01317"></a>01317       {
<a name="l01318"></a>01318         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01319"></a>01319         {
<a name="l01320"></a>01320           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> )
<a name="l01321"></a>01321           {
<a name="l01322"></a>01322             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> = 1;
<a name="l01323"></a>01323           }
<a name="l01324"></a>01324           <span class="keywordflow">else</span>
<a name="l01325"></a>01325           {
<a name="l01326"></a>01326             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> = 0;
<a name="l01327"></a>01327           }
<a name="l01328"></a>01328         }  
<a name="l01329"></a>01329         <span class="keywordflow">else</span>
<a name="l01330"></a>01330         {
<a name="l01331"></a>01331           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> = 0;
<a name="l01332"></a>01332         }
<a name="l01333"></a>01333       }
<a name="l01334"></a>01334     }
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01337"></a>01337   }
<a name="l01338"></a>01338  
<a name="l01339"></a>01339   
<a name="l01340"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6">01340</a> 
<a name="l01341"></a>01341   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6" title="Determine the design matrix for the GPS L1 position solution based on pseudroange...">GNSS_Estimator::DetermineDesignMatrixForThePositionSolution_GPSL1</a>( 
<a name="l01342"></a>01342     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,      <span class="comment">//!&lt; The receiver data.</span>
<a name="l01343"></a>01343 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nrRowsInH, <span class="comment">//!&lt; The number of valid rows in H.</span>
<a name="l01344"></a>01344 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;H                 <span class="comment">//!&lt; The position &amp; rx clock design matrix [n x 4].</span>
<a name="l01345"></a>01345 <span class="comment"></span>    )
<a name="l01346"></a>01346   {
<a name="l01347"></a>01347     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01348"></a>01348     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01349"></a>01349 
<a name="l01350"></a>01350     <span class="comment">// Check the dimension of H.</span>
<a name="l01351"></a>01351     <span class="keywordflow">if</span>( H.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != nrRowsInH || H.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 4 )
<a name="l01352"></a>01352     {
<a name="l01353"></a>01353       <span class="keywordflow">if</span>( !H.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( nrRowsInH, 4 ) )
<a name="l01354"></a>01354         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01355"></a>01355     }
<a name="l01356"></a>01356     <span class="comment">// Compute the design matrix for the position solution.</span>
<a name="l01357"></a>01357     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01358"></a>01358     {
<a name="l01359"></a>01359       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01360"></a>01360       {
<a name="l01361"></a>01361         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01362"></a>01362         {
<a name="l01363"></a>01363           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01364"></a>01364           {
<a name="l01365"></a>01365             <span class="comment">// Sanity index check.            </span>
<a name="l01366"></a>01366             <span class="keywordflow">if</span>( j &gt;= nrRowsInH )
<a name="l01367"></a>01367               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01368"></a>01368             
<a name="l01369"></a>01369             <a class="code" href="navigation_8c.html#ec995132ebeab2494bacdde497df971b" title="Computes the derivative of the pseudorange with respect to latitude, longitude, and...">NAVIGATION_ComputeDerivativesOf_Range_WithRespectToLatitudeLongitudeHeight</a>(
<a name="l01370"></a>01370               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l01371"></a>01371               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>, 
<a name="l01372"></a>01372               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>,
<a name="l01373"></a>01373               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l01374"></a>01374               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l01375"></a>01375               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l01376"></a>01376               &amp;H[j][0],
<a name="l01377"></a>01377               &amp;H[j][1],
<a name="l01378"></a>01378               &amp;H[j][2],
<a name="l01379"></a>01379               &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>
<a name="l01380"></a>01380               );
<a name="l01381"></a>01381             H[j][3] = 1.0;
<a name="l01382"></a>01382 
<a name="l01383"></a>01383             <span class="comment">// copy the row of the design matrix </span>
<a name="l01384"></a>01384             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[0] = H[j][0];
<a name="l01385"></a>01385             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[1] = H[j][1];
<a name="l01386"></a>01386             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[2] = H[j][2];
<a name="l01387"></a>01387 
<a name="l01388"></a>01388             j++;
<a name="l01389"></a>01389           }
<a name="l01390"></a>01390         }
<a name="l01391"></a>01391       }
<a name="l01392"></a>01392     }
<a name="l01393"></a>01393 
<a name="l01394"></a>01394     <span class="comment">// Constraint rows of the design matrix.</span>
<a name="l01395"></a>01395     <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l01396"></a>01396     {
<a name="l01397"></a>01397       <span class="keywordflow">if</span>( j + 3 &gt; nrRowsInH )
<a name="l01398"></a>01398         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01399"></a>01399             
<a name="l01400"></a>01400       H[j][0] = 1.0; 
<a name="l01401"></a>01401       H[j][1] = 0.0; 
<a name="l01402"></a>01402       H[j][2] = 0.0; 
<a name="l01403"></a>01403       H[j][3] = 0.0; 
<a name="l01404"></a>01404       j++;
<a name="l01405"></a>01405       H[j][0] = 0.0; 
<a name="l01406"></a>01406       H[j][1] = 1.0; 
<a name="l01407"></a>01407       H[j][2] = 0.0; 
<a name="l01408"></a>01408       H[j][3] = 0.0;       
<a name="l01409"></a>01409       j++;
<a name="l01410"></a>01410       H[j][0] = 0.0; 
<a name="l01411"></a>01411       H[j][1] = 0.0; 
<a name="l01412"></a>01412       H[j][2] = 1.0; 
<a name="l01413"></a>01413       H[j][3] = 0.0;       
<a name="l01414"></a>01414       j++;      
<a name="l01415"></a>01415     }
<a name="l01416"></a>01416     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l01417"></a>01417     {
<a name="l01418"></a>01418       <span class="keywordflow">if</span>( j + 1 &gt; nrRowsInH )
<a name="l01419"></a>01419         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01420"></a>01420             
<a name="l01421"></a>01421       H[j][0] = 0.0; 
<a name="l01422"></a>01422       H[j][1] = 0.0; 
<a name="l01423"></a>01423       H[j][2] = 1.0; 
<a name="l01424"></a>01424       H[j][3] = 0.0;             
<a name="l01425"></a>01425       j++;
<a name="l01426"></a>01426     }
<a name="l01427"></a>01427 
<a name="l01428"></a>01428     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01429"></a>01429   }
<a name="l01430"></a>01430 
<a name="l01431"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0fe13960eb41de660c25182935f75d22">01431</a> 
<a name="l01432"></a>01432   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0fe13960eb41de660c25182935f75d22" title="Determine the measurement weight matrix for the GPS L1 position solution based on...">GNSS_Estimator::DetermineMeasurementWeightMatrixForThePositionSolution_GPSL1</a>( 
<a name="l01433"></a>01433     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,  <span class="comment">//!&lt; The receiver data.</span>
<a name="l01434"></a>01434 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,     <span class="comment">//!&lt; The number of measurements and pseudo-measurements (constraints).</span>
<a name="l01435"></a>01435 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;W             <span class="comment">//!&lt; The inverse of the pseudorange measurement variance-coraiance matrix [n x n].</span>
<a name="l01436"></a>01436 <span class="comment"></span>    )
<a name="l01437"></a>01437   {
<a name="l01438"></a>01438     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01439"></a>01439     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01440"></a>01440 
<a name="l01441"></a>01441     <span class="comment">// Check the dimension of W.</span>
<a name="l01442"></a>01442     <span class="keywordflow">if</span>( W.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || W.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != n )
<a name="l01443"></a>01443     {
<a name="l01444"></a>01444       <span class="keywordflow">if</span>( !W.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, n ) )
<a name="l01445"></a>01445         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01446"></a>01446     }
<a name="l01447"></a>01447     <span class="comment">// Set the weight matrix.</span>
<a name="l01448"></a>01448     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01449"></a>01449     {
<a name="l01450"></a>01450       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01451"></a>01451       {
<a name="l01452"></a>01452         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01453"></a>01453         {
<a name="l01454"></a>01454           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01455"></a>01455           {
<a name="l01456"></a>01456             <span class="comment">// Sanity index check.</span>
<a name="l01457"></a>01457             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l01458"></a>01458               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01459"></a>01459 
<a name="l01460"></a>01460             <span class="comment">// Check divide by zero.</span>
<a name="l01461"></a>01461             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a> == 0.0 )
<a name="l01462"></a>01462               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464             W[j][j] = 1.0/(rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a>);
<a name="l01465"></a>01465             j++;
<a name="l01466"></a>01466           }
<a name="l01467"></a>01467         }
<a name="l01468"></a>01468       }
<a name="l01469"></a>01469     }
<a name="l01470"></a>01470 
<a name="l01471"></a>01471     <span class="comment">// Deal with constraints.</span>
<a name="l01472"></a>01472     <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l01473"></a>01473     {
<a name="l01474"></a>01474       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l01475"></a>01475         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01476"></a>01476             
<a name="l01477"></a>01477       W[j][j] = 1.0/(rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8a1cfa9e01b7684b6f987efce751f6c7" title="The standard deviation uncertainty in the latitude [m].">std_lat</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8a1cfa9e01b7684b6f987efce751f6c7" title="The standard deviation uncertainty in the latitude [m].">std_lat</a>); 
<a name="l01478"></a>01478       j++;
<a name="l01479"></a>01479       W[j][j] = 1.0/(rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#eb48883726a3407cf81d6d729dcd1173" title="The standard deviation uncertainty in the longitude [m].">std_lon</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#eb48883726a3407cf81d6d729dcd1173" title="The standard deviation uncertainty in the longitude [m].">std_lon</a>); 
<a name="l01480"></a>01480       j++;
<a name="l01481"></a>01481       W[j][j] = 1.0/(rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>); 
<a name="l01482"></a>01482       j++;      
<a name="l01483"></a>01483     }
<a name="l01484"></a>01484     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l01485"></a>01485     {
<a name="l01486"></a>01486       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l01487"></a>01487         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01488"></a>01488             
<a name="l01489"></a>01489       W[j][j] = 1.0/(rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>); 
<a name="l01490"></a>01490       j++;
<a name="l01491"></a>01491     }
<a name="l01492"></a>01492 
<a name="l01493"></a>01493     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01494"></a>01494   }
<a name="l01495"></a>01495 
<a name="l01496"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a0c642977c8e788817fbde37909533d3">01496</a> 
<a name="l01497"></a>01497   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a0c642977c8e788817fbde37909533d3" title="Determine the measurement variance-coariance matrix for the GPS L1 position solution...">GNSS_Estimator::DetermineMeasurementVarianceCovarianceMatrixForThePositionSolution_GPSL1</a>( 
<a name="l01498"></a>01498     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,  <span class="comment">//!&lt; The receiver data.</span>
<a name="l01499"></a>01499 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,     <span class="comment">//!&lt; The number of measurements and pseudo-measurements (constraints).</span>
<a name="l01500"></a>01500 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;R             <span class="comment">//!&lt; The pseudorange measurement variance-covariance matrix [n x n].</span>
<a name="l01501"></a>01501 <span class="comment"></span>    )
<a name="l01502"></a>01502   {
<a name="l01503"></a>01503     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01504"></a>01504     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01505"></a>01505 
<a name="l01506"></a>01506     <span class="comment">// Check the dimension of W.</span>
<a name="l01507"></a>01507     <span class="keywordflow">if</span>( R.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || R.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != n )
<a name="l01508"></a>01508     {
<a name="l01509"></a>01509       <span class="keywordflow">if</span>( !R.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, n ) )
<a name="l01510"></a>01510         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01511"></a>01511     }
<a name="l01512"></a>01512     <span class="comment">// Set the weight matrix.</span>
<a name="l01513"></a>01513     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01514"></a>01514     {
<a name="l01515"></a>01515       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01516"></a>01516       {
<a name="l01517"></a>01517         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01518"></a>01518         {
<a name="l01519"></a>01519           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01520"></a>01520           {
<a name="l01521"></a>01521             <span class="comment">// Sanity index check.</span>
<a name="l01522"></a>01522             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l01523"></a>01523               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525             <span class="comment">// Check divide by zero.</span>
<a name="l01526"></a>01526             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a> == 0.0 )
<a name="l01527"></a>01527               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01528"></a>01528 
<a name="l01529"></a>01529             R[j][j] = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a>;
<a name="l01530"></a>01530             j++;
<a name="l01531"></a>01531           }
<a name="l01532"></a>01532         }
<a name="l01533"></a>01533       }
<a name="l01534"></a>01534     }
<a name="l01535"></a>01535 
<a name="l01536"></a>01536     <span class="comment">// Deal with constraints.</span>
<a name="l01537"></a>01537     <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l01538"></a>01538     {
<a name="l01539"></a>01539       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l01540"></a>01540         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01541"></a>01541             
<a name="l01542"></a>01542       R[j][j] = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8a1cfa9e01b7684b6f987efce751f6c7" title="The standard deviation uncertainty in the latitude [m].">std_lat</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8a1cfa9e01b7684b6f987efce751f6c7" title="The standard deviation uncertainty in the latitude [m].">std_lat</a>; 
<a name="l01543"></a>01543       j++;
<a name="l01544"></a>01544       R[j][j] = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#eb48883726a3407cf81d6d729dcd1173" title="The standard deviation uncertainty in the longitude [m].">std_lon</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#eb48883726a3407cf81d6d729dcd1173" title="The standard deviation uncertainty in the longitude [m].">std_lon</a>; 
<a name="l01545"></a>01545       j++;
<a name="l01546"></a>01546       R[j][j] = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>; 
<a name="l01547"></a>01547       j++;      
<a name="l01548"></a>01548     }
<a name="l01549"></a>01549     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l01550"></a>01550     {
<a name="l01551"></a>01551       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l01552"></a>01552         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01553"></a>01553             
<a name="l01554"></a>01554       R[j][j] = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>*rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a1630e20177a2a0d659d45b0ed702da6" title="The standard deviation uncertainty in the height [m].">std_hgt</a>; 
<a name="l01555"></a>01555       j++;
<a name="l01556"></a>01556     }
<a name="l01557"></a>01557 
<a name="l01558"></a>01558     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01559"></a>01559   }
<a name="l01560"></a>01560 
<a name="l01561"></a>01561 
<a name="l01562"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864">01562</a> 
<a name="l01563"></a>01563   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">GNSS_Estimator::DeterminePseudorangeMisclosures_GPSL1</a>( 
<a name="l01564"></a>01564     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,     <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l01565"></a>01565 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData, <span class="comment">//!&lt; The pointer to the reference receiver data. NULL if not available.    </span>
<a name="l01566"></a>01566 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,        <span class="comment">//!&lt; The number of misclosures.</span>
<a name="l01567"></a>01567 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;w                <span class="comment">//!&lt; The pseudorange misclosure vector [n x 1].</span>
<a name="l01568"></a>01568 <span class="comment"></span>    )
<a name="l01569"></a>01569   {
<a name="l01570"></a>01570     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01571"></a>01571     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01572"></a>01572     <span class="keywordtype">int</span> k = 0;
<a name="l01573"></a>01573     <span class="keywordtype">double</span> psr_base = 0;
<a name="l01574"></a>01574     <span class="keywordtype">double</span> range_base = 0;
<a name="l01575"></a>01575     <span class="keywordtype">double</span> psr_measured = 0;
<a name="l01576"></a>01576     <span class="keywordtype">double</span> psr_computed = 0;
<a name="l01577"></a>01577 
<a name="l01578"></a>01578     <span class="comment">// Check the dimension of w.</span>
<a name="l01579"></a>01579     <span class="keywordflow">if</span>( w.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || w.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 1 )
<a name="l01580"></a>01580     {
<a name="l01581"></a>01581       <span class="keywordflow">if</span>( !w.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 1 ) )
<a name="l01582"></a>01582         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01583"></a>01583     }
<a name="l01584"></a>01584 
<a name="l01585"></a>01585     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01586"></a>01586     {
<a name="l01587"></a>01587       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01588"></a>01588       {
<a name="l01589"></a>01589         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01590"></a>01590         {
<a name="l01591"></a>01591           <span class="comment">// allows compute the misclosure value (regardless of whether it is used in solution</span>
<a name="l01592"></a>01592           psr_measured = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#9bbfa0f14f3ab1f96d1a93144333e876" title="The pseudorange measurement [m].">psr</a>;
<a name="l01593"></a>01593 
<a name="l01594"></a>01594           <span class="comment">// Add the satellite clock correction.</span>
<a name="l01595"></a>01595           psr_measured += rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>;
<a name="l01596"></a>01596 
<a name="l01597"></a>01597           <span class="comment">// Compensate for the ionospheric delay if indicated.</span>
<a name="l01598"></a>01598           <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01599"></a>01599           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#edd65370a70fb40d96f699292ced9296" title="Indicates that the broadcast ionospheric correction should be applied.">useBroadcastIonoCorrection</a> )
<a name="l01600"></a>01600           {
<a name="l01601"></a>01601             <span class="comment">// Compensate for the ionospheric delay</span>
<a name="l01602"></a>01602             psr_measured -= rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#71bdb2cf554c1c2219d262eb7e0ecc13" title="Ionospheric correction (+ve is a delay) [m].">prcIono</a>;
<a name="l01603"></a>01603           }
<a name="l01604"></a>01604 
<a name="l01605"></a>01605           <span class="comment">// Compensate for the tropospheric delay if indicated.</span>
<a name="l01606"></a>01606           <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01607"></a>01607           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#cabef9cfcb95b78cd95f60aae8957c16" title="Indicates that the tropospheric correction should be applied.">useTropoCorrection</a> )
<a name="l01608"></a>01608           {
<a name="l01609"></a>01609             <span class="comment">// Compensate for the tropospheric delay</span>
<a name="l01610"></a>01610             psr_measured -= rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#e55daa21ff3be2775cd1a5e0c29f55b5" title="Tropospheric dry delay correction (+ve is a delay) [m].">prcTropoDry</a>;
<a name="l01611"></a>01611             psr_measured -= rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#cae5168ec24729a74e643623dc129402" title="Tropospheric wet delay correction (+ve is a delay) [m].">prcTropoWet</a>;
<a name="l01612"></a>01612           }
<a name="l01613"></a>01613 
<a name="l01614"></a>01614           range_base = 0;
<a name="l01615"></a>01615           <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l01616"></a>01616           {    
<a name="l01617"></a>01617             <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#332a9168a908b717038f190150ac34de" title="Indicates if a matching pseudrange observation is available from another receiver...">isDifferentialPsrAvailable</a> )
<a name="l01618"></a>01618             {
<a name="l01619"></a>01619               k = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a>;
<a name="l01620"></a>01620               <span class="keywordflow">if</span>( k != -1 )
<a name="l01621"></a>01621               {
<a name="l01622"></a>01622                 psr_base  = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#9bbfa0f14f3ab1f96d1a93144333e876" title="The pseudorange measurement [m].">psr</a>;
<a name="l01623"></a>01623                 psr_base += rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>;
<a name="l01624"></a>01624 
<a name="l01625"></a>01625                 <span class="comment">// Compensate for the ionospheric delay if indicated.</span>
<a name="l01626"></a>01626                 <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01627"></a>01627                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#edd65370a70fb40d96f699292ced9296" title="Indicates that the broadcast ionospheric correction should be applied.">useBroadcastIonoCorrection</a> )
<a name="l01628"></a>01628                 {
<a name="l01629"></a>01629                   <span class="comment">// Compensate for the ionospheric delay</span>
<a name="l01630"></a>01630                   psr_base -= rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#71bdb2cf554c1c2219d262eb7e0ecc13" title="Ionospheric correction (+ve is a delay) [m].">prcIono</a>;
<a name="l01631"></a>01631                 }
<a name="l01632"></a>01632 
<a name="l01633"></a>01633                 <span class="comment">// Compensate for the tropospheric delay if indicated.</span>
<a name="l01634"></a>01634                 <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01635"></a>01635                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#cabef9cfcb95b78cd95f60aae8957c16" title="Indicates that the tropospheric correction should be applied.">useTropoCorrection</a> )
<a name="l01636"></a>01636                 {
<a name="l01637"></a>01637                   <span class="comment">// Compensate for the tropospheric delay</span>
<a name="l01638"></a>01638                   psr_base -= rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#e55daa21ff3be2775cd1a5e0c29f55b5" title="Tropospheric dry delay correction (+ve is a delay) [m].">prcTropoDry</a>;
<a name="l01639"></a>01639                   psr_base -= rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#cae5168ec24729a74e643623dc129402" title="Tropospheric wet delay correction (+ve is a delay) [m].">prcTropoWet</a>;
<a name="l01640"></a>01640                 }                  
<a name="l01641"></a>01641 
<a name="l01642"></a>01642                 range_base = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>;
<a name="l01643"></a>01643 
<a name="l01644"></a>01644                 <span class="comment">// Compute the differential pseudorange.</span>
<a name="l01645"></a>01645                 psr_measured -= psr_base;
<a name="l01646"></a>01646               }
<a name="l01647"></a>01647             }
<a name="l01648"></a>01648           }
<a name="l01649"></a>01649 
<a name="l01650"></a>01650           <span class="comment">// Calculate the computed pseudorange = geometric range + clock offset (m)</span>
<a name="l01651"></a>01651           <span class="comment">// The range value and the clock offset must be determined beforehand.</span>
<a name="l01652"></a>01652           <span class="comment">// If differential, range_base != 0, it is the computed psuedorange difference.</span>
<a name="l01653"></a>01653           psr_computed = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a> - range_base + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a>;
<a name="l01654"></a>01654 
<a name="l01655"></a>01655           <span class="comment">// The misclosure is the corrected measured value minus the computed valid.</span>
<a name="l01656"></a>01656           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#088ea94314af8cc3d21d3da1df480e9f" title="The measured psr minus the computed psr estimate [m].">psr_misclosure</a> = psr_measured - psr_computed;            
<a name="l01657"></a>01657 
<a name="l01658"></a>01658           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l01659"></a>01659           {
<a name="l01660"></a>01660             <span class="comment">// Sanity index check.</span>
<a name="l01661"></a>01661             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l01662"></a>01662               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01663"></a>01663 
<a name="l01664"></a>01664             w[j] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#088ea94314af8cc3d21d3da1df480e9f" title="The measured psr minus the computed psr estimate [m].">psr_misclosure</a>;
<a name="l01665"></a>01665             j++;
<a name="l01666"></a>01666           }
<a name="l01667"></a>01667         }
<a name="l01668"></a>01668         <span class="keywordflow">else</span>
<a name="l01669"></a>01669         {
<a name="l01670"></a>01670           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#088ea94314af8cc3d21d3da1df480e9f" title="The measured psr minus the computed psr estimate [m].">psr_misclosure</a> = 0.0;            
<a name="l01671"></a>01671         }
<a name="l01672"></a>01672       }
<a name="l01673"></a>01673     }
<a name="l01674"></a>01674 
<a name="l01675"></a>01675     <span class="comment">// Deal with constraints.</span>
<a name="l01676"></a>01676     <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l01677"></a>01677     {
<a name="l01678"></a>01678       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l01679"></a>01679         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01680"></a>01680 
<a name="l01681"></a>01681       <span class="keywordtype">double</span> N;
<a name="l01682"></a>01682       <span class="keywordtype">double</span> M;
<a name="l01683"></a>01683       <span class="keywordtype">double</span> diff;
<a name="l01684"></a>01684 
<a name="l01685"></a>01685       <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l01686"></a>01686         <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l01687"></a>01687         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l01688"></a>01688         &amp;N );
<a name="l01689"></a>01689       <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>( 
<a name="l01690"></a>01690         <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l01691"></a>01691         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l01692"></a>01692         &amp;M );
<a name="l01693"></a>01693             
<a name="l01694"></a>01694       diff = (rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a> - rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>);
<a name="l01695"></a>01695       diff *= ( M + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a> ); <span class="comment">// convert to meters.</span>
<a name="l01696"></a>01696       w[j] = diff;
<a name="l01697"></a>01697       j++;
<a name="l01698"></a>01698       diff = (rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a> - rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a> );
<a name="l01699"></a>01699       diff *= (N + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>)*cos(rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>); <span class="comment">// convert to meters.</span>
<a name="l01700"></a>01700       w[j] = diff;
<a name="l01701"></a>01701       j++;
<a name="l01702"></a>01702       w[j] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a> - rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l01703"></a>01703       j++;      
<a name="l01704"></a>01704     }
<a name="l01705"></a>01705     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l01706"></a>01706     {
<a name="l01707"></a>01707       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l01708"></a>01708         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01709"></a>01709             
<a name="l01710"></a>01710       w[j] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a> - rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l01711"></a>01711       j++;
<a name="l01712"></a>01712     }
<a name="l01713"></a>01713 
<a name="l01714"></a>01714 
<a name="l01715"></a>01715     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01716"></a>01716   }
<a name="l01717"></a>01717 
<a name="l01718"></a>01718   
<a name="l01719"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#552afa68dfb2720b926453b0592ce118">01719</a> 
<a name="l01720"></a>01720   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#552afa68dfb2720b926453b0592ce118" title="Compute the differntial GPS L1 ADR misclosures.">GNSS_Estimator::DetermineSingleDifferenceADR_Misclosures_GPSL1</a>( 
<a name="l01721"></a>01721     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,     <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l01722"></a>01722 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData, <span class="comment">//!&lt; The pointer to the reference receiver data. NULL if not available.    </span>
<a name="l01723"></a>01723 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,        <span class="comment">//!&lt; The number of misclosures.</span>
<a name="l01724"></a>01724 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;w                <span class="comment">//!&lt; The adr misclosure vector [n x 1].</span>
<a name="l01725"></a>01725 <span class="comment"></span>    )
<a name="l01726"></a>01726   {
<a name="l01727"></a>01727     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01728"></a>01728     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01729"></a>01729     <span class="keywordtype">int</span> k = 0;
<a name="l01730"></a>01730     <span class="keywordtype">double</span> adr_base = 0;
<a name="l01731"></a>01731     <span class="keywordtype">double</span> range_base = 0;
<a name="l01732"></a>01732     <span class="keywordtype">double</span> adr_measured = 0;
<a name="l01733"></a>01733     <span class="keywordtype">double</span> adr_computed = 0;
<a name="l01734"></a>01734 
<a name="l01735"></a>01735     <span class="keywordflow">if</span>( n == 0 )
<a name="l01736"></a>01736       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01737"></a>01737 
<a name="l01738"></a>01738     <span class="comment">// Check the dimension of w.</span>
<a name="l01739"></a>01739     <span class="keywordflow">if</span>( w.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || w.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 1 )
<a name="l01740"></a>01740     {
<a name="l01741"></a>01741       <span class="keywordflow">if</span>( !w.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 1 ) )
<a name="l01742"></a>01742         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01743"></a>01743     }
<a name="l01744"></a>01744 
<a name="l01745"></a>01745     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01746"></a>01746     {
<a name="l01747"></a>01747       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01748"></a>01748       {
<a name="l01749"></a>01749         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01750"></a>01750         {
<a name="l01751"></a>01751           <span class="comment">// allows computation of the misclosure value (regardless of whether it is used in solution</span>
<a name="l01752"></a>01752           adr_measured = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#78fdf18fab346021b14f7420d83ce4e9" title="The carrier phase or accumulated Doppler range measurement [cycles].">adr</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l01753"></a>01753 
<a name="l01754"></a>01754           <span class="comment">// Add the satellite clock correction.</span>
<a name="l01755"></a>01755           adr_measured += rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>;
<a name="l01756"></a>01756 
<a name="l01757"></a>01757           <span class="comment">// Compensate for the ionospheric delay if indicated.</span>
<a name="l01758"></a>01758           <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01759"></a>01759           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#edd65370a70fb40d96f699292ced9296" title="Indicates that the broadcast ionospheric correction should be applied.">useBroadcastIonoCorrection</a> )
<a name="l01760"></a>01760           {
<a name="l01761"></a>01761             <span class="comment">// Compensate for the ionospheric delay</span>
<a name="l01762"></a>01762             adr_measured += rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#71bdb2cf554c1c2219d262eb7e0ecc13" title="Ionospheric correction (+ve is a delay) [m].">prcIono</a>;
<a name="l01763"></a>01763           }
<a name="l01764"></a>01764 
<a name="l01765"></a>01765           <span class="comment">// Compensate for the tropospheric delay if indicated.</span>
<a name="l01766"></a>01766           <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01767"></a>01767           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#cabef9cfcb95b78cd95f60aae8957c16" title="Indicates that the tropospheric correction should be applied.">useTropoCorrection</a> )
<a name="l01768"></a>01768           {
<a name="l01769"></a>01769             <span class="comment">// Compensate for the tropospheric delay</span>
<a name="l01770"></a>01770             adr_measured -= rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#e55daa21ff3be2775cd1a5e0c29f55b5" title="Tropospheric dry delay correction (+ve is a delay) [m].">prcTropoDry</a>;
<a name="l01771"></a>01771             adr_measured -= rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#cae5168ec24729a74e643623dc129402" title="Tropospheric wet delay correction (+ve is a delay) [m].">prcTropoWet</a>;
<a name="l01772"></a>01772           }
<a name="l01773"></a>01773 
<a name="l01774"></a>01774           range_base = 0;
<a name="l01775"></a>01775           <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l01776"></a>01776           {    
<a name="l01777"></a>01777             <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> )
<a name="l01778"></a>01778             {
<a name="l01779"></a>01779               k = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a>;
<a name="l01780"></a>01780               <span class="keywordflow">if</span>( k != -1 )
<a name="l01781"></a>01781               {
<a name="l01782"></a>01782                 adr_base  = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#78fdf18fab346021b14f7420d83ce4e9" title="The carrier phase or accumulated Doppler range measurement [cycles].">adr</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l01783"></a>01783                 adr_base += rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#ef0e24012517cddfe8fa582c1e0f858b" title="The satellite clock correction [m].">clk</a>;
<a name="l01784"></a>01784                 
<a name="l01785"></a>01785                 <span class="comment">// Compensate for the ionospheric delay if indicated.</span>
<a name="l01786"></a>01786                 <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01787"></a>01787                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#edd65370a70fb40d96f699292ced9296" title="Indicates that the broadcast ionospheric correction should be applied.">useBroadcastIonoCorrection</a> )
<a name="l01788"></a>01788                 {
<a name="l01789"></a>01789                   <span class="comment">// Compensate for the ionospheric delay</span>
<a name="l01790"></a>01790                   adr_base += rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#71bdb2cf554c1c2219d262eb7e0ecc13" title="Ionospheric correction (+ve is a delay) [m].">prcIono</a>;
<a name="l01791"></a>01791                 }
<a name="l01792"></a>01792 
<a name="l01793"></a>01793                 <span class="comment">// Compensate for the tropospheric delay if indicated.</span>
<a name="l01794"></a>01794                 <span class="comment">// The corrections must be determined beforehand.</span>
<a name="l01795"></a>01795                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#cabef9cfcb95b78cd95f60aae8957c16" title="Indicates that the tropospheric correction should be applied.">useTropoCorrection</a> )
<a name="l01796"></a>01796                 {
<a name="l01797"></a>01797                   <span class="comment">// Compensate for the tropospheric delay</span>
<a name="l01798"></a>01798                   adr_base -= rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#e55daa21ff3be2775cd1a5e0c29f55b5" title="Tropospheric dry delay correction (+ve is a delay) [m].">prcTropoDry</a>;
<a name="l01799"></a>01799                   adr_base -= rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#00f3bf3e2a49794ccfe0ebf65797fc21" title="The corrections associated with this channel.">corrections</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_corrections.html#cae5168ec24729a74e643623dc129402" title="Tropospheric wet delay correction (+ve is a delay) [m].">prcTropoWet</a>;
<a name="l01800"></a>01800                 }                  
<a name="l01801"></a>01801 
<a name="l01802"></a>01802                 range_base = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>;
<a name="l01803"></a>01803 
<a name="l01804"></a>01804                 <span class="comment">// Compute the differential adr.</span>
<a name="l01805"></a>01805                 adr_measured -= adr_base;
<a name="l01806"></a>01806               }
<a name="l01807"></a>01807             }
<a name="l01808"></a>01808           }
<a name="l01809"></a>01809 
<a name="l01810"></a>01810           <span class="comment">// Calculate the computed adr = geometric range + clock offset (m)</span>
<a name="l01811"></a>01811           <span class="comment">// The range value and the clock offset must be determined beforehand.</span>
<a name="l01812"></a>01812           <span class="comment">// If differential, range_base != 0, and the ambiguity is the single differnce ambiguity [m].</span>
<a name="l01813"></a>01813           adr_computed = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a> - range_base;
<a name="l01814"></a>01814           adr_computed += rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a>;          
<a name="l01815"></a>01815           adr_computed += rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#f84098bd901e20bf5a16d4f98a0c4ee2" title="The estimated integer component of the adr. This may be the single or double differenced...">ambiguity</a>; 
<a name="l01816"></a>01816 
<a name="l01817"></a>01817           <span class="comment">// The misclosure is the corrected measured value minus the computed valid.</span>
<a name="l01818"></a>01818           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#6a107ee60c42d408e7f814c1e75b417c" title="The measured ADR minus the computed ADR estimate [m]. This is likely a differential...">adr_misclosure</a> = adr_measured - adr_computed;            
<a name="l01819"></a>01819 
<a name="l01820"></a>01820           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l01821"></a>01821           {
<a name="l01822"></a>01822             <span class="comment">// Sanity index check.</span>
<a name="l01823"></a>01823             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l01824"></a>01824               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01825"></a>01825 
<a name="l01826"></a>01826             w[j] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#6a107ee60c42d408e7f814c1e75b417c" title="The measured ADR minus the computed ADR estimate [m]. This is likely a differential...">adr_misclosure</a>;
<a name="l01827"></a>01827             j++;
<a name="l01828"></a>01828           }
<a name="l01829"></a>01829         }
<a name="l01830"></a>01830         <span class="keywordflow">else</span>
<a name="l01831"></a>01831         {
<a name="l01832"></a>01832           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#6a107ee60c42d408e7f814c1e75b417c" title="The measured ADR minus the computed ADR estimate [m]. This is likely a differential...">adr_misclosure</a> = 0.0;            
<a name="l01833"></a>01833         }
<a name="l01834"></a>01834       }
<a name="l01835"></a>01835     }
<a name="l01836"></a>01836 
<a name="l01837"></a>01837     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01838"></a>01838   }
<a name="l01839"></a>01839 
<a name="l01840"></a>01840   
<a name="l01841"></a>01841 
<a name="l01842"></a>01842 
<a name="l01843"></a>01843 
<a name="l01844"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be">01844</a> 
<a name="l01845"></a>01845   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">GNSS_Estimator::DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( 
<a name="l01846"></a>01846     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,       <span class="comment">//!&lt; The receiver data.</span>
<a name="l01847"></a>01847 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrUsableDopplers <span class="comment">//!&lt; the number of usable GPS L1 Doppler measurements.</span>
<a name="l01848"></a>01848 <span class="comment"></span>    )
<a name="l01849"></a>01849   {
<a name="l01850"></a>01850     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01851"></a>01851     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> isGood = 0;
<a name="l01852"></a>01852 
<a name="l01853"></a>01853     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#ef6921529b460813cf13358dfb972506" title="This indicates the number of valid Doppler observations valid before adjustment.">nrDopplerObsAvailable</a> = 0;
<a name="l01854"></a>01854     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#958270873565f5471485221fd4cc7c9a" title="This indicates the number of valid Doppler observations valid after adjustment.">nrDopplerObsUsed</a> = 0;
<a name="l01855"></a>01855     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#8275d4dc03431721fb702b7bfcc51242" title="This indicates the number of valid Doppler observations rejected during adjustment...">nrDopplerObsRejected</a> = 0;
<a name="l01856"></a>01856 
<a name="l01857"></a>01857     nrUsableDopplers = 0;    
<a name="l01858"></a>01858     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01859"></a>01859     {
<a name="l01860"></a>01860       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01861"></a>01861       {
<a name="l01862"></a>01862         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01863"></a>01863         {
<a name="l01864"></a>01864           isGood = 
<a name="l01865"></a>01865             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#6724b397743221c2db515050b9afc822" title="Indicates if the code tracking is locked.">isCodeLocked</a>         &amp; 
<a name="l01866"></a>01866             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#d2bad44526c759c077891f4bb281bed7" title="Indicates if the Doppler if valid for use.">isDopplerValid</a>       &amp;
<a name="l01867"></a>01867             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#f0c85e4b0d82d0a492c890eb1388bf76" title="Indicates if the satellite tracked is above the elevation mask.">isAboveElevationMask</a> &amp;
<a name="l01868"></a>01868             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#254cf7a68efe95bff3039692700f1cf2" title="Indciates if the channel&amp;#39;s C/No is above a threshold value.">isAboveCNoMask</a>       &amp;
<a name="l01869"></a>01869             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#b5ae8b735c11faf0ff297d1369a25d7d" title="Indicates if the channel&amp;#39;s locktime is above a treshold value.">isAboveLockTimeMask</a>  &amp;
<a name="l01870"></a>01870             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2ec0bf073891c2887dbb7468fbdc25fa" title="Indicates if the user has not forced the rejection of this channel or PRN.">isNotUserRejected</a>    &amp;
<a name="l01871"></a>01871             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#7bb3fc309e794584096393d7d8a7ccaf" title="Indicates if the Doppler was not rejected (ie Fault Detection and Exclusion).">isNotDopplerRejected</a> &amp;
<a name="l01872"></a>01872             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#0eeab8eafc92232eb9f06d2eaf689e65" title="Indicates if this channel has valid associated ephemeris information.">isEphemerisValid</a>;
<a name="l01873"></a>01873           <span class="keywordflow">if</span>( isGood )
<a name="l01874"></a>01874           {
<a name="l01875"></a>01875             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> = 1;
<a name="l01876"></a>01876             nrUsableDopplers++;            
<a name="l01877"></a>01877           }
<a name="l01878"></a>01878           <span class="keywordflow">else</span>
<a name="l01879"></a>01879           {
<a name="l01880"></a>01880             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> = 0;
<a name="l01881"></a>01881           }
<a name="l01882"></a>01882         }
<a name="l01883"></a>01883       }
<a name="l01884"></a>01884     }
<a name="l01885"></a>01885     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#ef6921529b460813cf13358dfb972506" title="This indicates the number of valid Doppler observations valid before adjustment.">nrDopplerObsAvailable</a> = nrUsableDopplers;
<a name="l01886"></a>01886     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01887"></a>01887   }
<a name="l01888"></a>01888 
<a name="l01889"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#92db9d6064dda154b675f62f07b53573">01889</a> 
<a name="l01890"></a>01890   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#92db9d6064dda154b675f62f07b53573" title="Determine the differential GPS L1 Doppler measurements.">GNSS_Estimator::DetermineDifferentialDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( 
<a name="l01891"></a>01891     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,                  <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l01892"></a>01892 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,              <span class="comment">//!&lt; The pointer to the reference receiver data. </span>
<a name="l01893"></a>01893 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> setToUseOnlyDifferential,  <span class="comment">//!&lt; This indicates that only differential measurements should be used.</span>
<a name="l01894"></a>01894 <span class="comment"></span>    <span class="keywordtype">unsigned</span> &amp;nrDifferentialDoppler       <span class="comment">//!&lt; The number of usable differential GPS L1 Doppler measurements.    </span>
<a name="l01895"></a>01895 <span class="comment"></span>    )
<a name="l01896"></a>01896   {
<a name="l01897"></a>01897     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01898"></a>01898     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01899"></a>01899     <span class="comment">//unsigned char isGood = 0;</span>
<a name="l01900"></a>01900 
<a name="l01901"></a>01901     <span class="comment">// Initial the indices of the corresponding differential measurements.</span>
<a name="l01902"></a>01902     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ ) 
<a name="l01903"></a>01903     { 
<a name="l01904"></a>01904       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a> = -1; 
<a name="l01905"></a>01905       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#66c05cb9b40418a76fd39719ec3be4bd" title="Indicates if a matching Doppler observation is available from another receiver.">isDifferentialDopplerAvailable</a>= 0;
<a name="l01906"></a>01906     }
<a name="l01907"></a>01907     <span class="keywordflow">for</span>( i = 0; i &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ ) 
<a name="l01908"></a>01908     { 
<a name="l01909"></a>01909       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a> = -1; 
<a name="l01910"></a>01910       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#66c05cb9b40418a76fd39719ec3be4bd" title="Indicates if a matching Doppler observation is available from another receiver.">isDifferentialDopplerAvailable</a> = 0;
<a name="l01911"></a>01911     }
<a name="l01912"></a>01912 
<a name="l01913"></a>01913     nrDifferentialDoppler = 0;    
<a name="l01914"></a>01914     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01915"></a>01915     {
<a name="l01916"></a>01916       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01917"></a>01917       {
<a name="l01918"></a>01918         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01919"></a>01919         {
<a name="l01920"></a>01920           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l01921"></a>01921           {
<a name="l01922"></a>01922             <span class="comment">// Look for a matching differential channel in the base station data.</span>
<a name="l01923"></a>01923             <span class="keywordflow">for</span>( j = 0; j &lt; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; j++ )
<a name="l01924"></a>01924             {
<a name="l01925"></a>01925               <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01926"></a>01926               {
<a name="l01927"></a>01927                 <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01928"></a>01928                 {
<a name="l01929"></a>01929                   <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> )
<a name="l01930"></a>01930                   {                      
<a name="l01931"></a>01931                     <span class="keywordflow">if</span>( rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l01932"></a>01932                     {
<a name="l01933"></a>01933                       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#66c05cb9b40418a76fd39719ec3be4bd" title="Indicates if a matching Doppler observation is available from another receiver.">isDifferentialDopplerAvailable</a> = 1;
<a name="l01934"></a>01934                       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#66c05cb9b40418a76fd39719ec3be4bd" title="Indicates if a matching Doppler observation is available from another receiver.">isDifferentialDopplerAvailable</a> = 1;
<a name="l01935"></a>01935                       rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a>     = j;
<a name="l01936"></a>01936                       rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[j].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a> = i;
<a name="l01937"></a>01937                       
<a name="l01938"></a>01938                       nrDifferentialDoppler++;
<a name="l01939"></a>01939                     }
<a name="l01940"></a>01940                   }
<a name="l01941"></a>01941                 }
<a name="l01942"></a>01942               }
<a name="l01943"></a>01943             }
<a name="l01944"></a>01944           }
<a name="l01945"></a>01945         }
<a name="l01946"></a>01946       }
<a name="l01947"></a>01947     }
<a name="l01948"></a>01948 
<a name="l01949"></a>01949     <span class="keywordflow">if</span>( setToUseOnlyDifferential )
<a name="l01950"></a>01950     {
<a name="l01951"></a>01951       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l01952"></a>01952       {
<a name="l01953"></a>01953         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l01954"></a>01954         {
<a name="l01955"></a>01955           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l01956"></a>01956           {
<a name="l01957"></a>01957             <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l01958"></a>01958             {
<a name="l01959"></a>01959               <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#66c05cb9b40418a76fd39719ec3be4bd" title="Indicates if a matching Doppler observation is available from another receiver.">isDifferentialDopplerAvailable</a> )
<a name="l01960"></a>01960               {
<a name="l01961"></a>01961                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> = 1;                
<a name="l01962"></a>01962               }
<a name="l01963"></a>01963               <span class="keywordflow">else</span>
<a name="l01964"></a>01964               {                
<a name="l01965"></a>01965                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> = 0;
<a name="l01966"></a>01966               }
<a name="l01967"></a>01967             }
<a name="l01968"></a>01968           }
<a name="l01969"></a>01969         }
<a name="l01970"></a>01970       }
<a name="l01971"></a>01971     }
<a name="l01972"></a>01972 
<a name="l01973"></a>01973     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01974"></a>01974   }
<a name="l01975"></a>01975   
<a name="l01976"></a>01976 
<a name="l01977"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941">01977</a> 
<a name="l01978"></a>01978   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">GNSS_Estimator::DetermineDopplerMisclosures_GPSL1</a>( 
<a name="l01979"></a>01979     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,     <span class="comment">//!&lt; The pointer to the receiver data.    </span>
<a name="l01980"></a>01980 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData, <span class="comment">//!&lt; The pointer to the reference receiver data. NULL if not available.    </span>
<a name="l01981"></a>01981 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,        <span class="comment">//!&lt; The number of misclosures.</span>
<a name="l01982"></a>01982 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;w                <span class="comment">//!&lt; The pseudorange misclosure vector [n x 1].</span>
<a name="l01983"></a>01983 <span class="comment"></span>    )
<a name="l01984"></a>01984   {
<a name="l01985"></a>01985     <span class="keywordtype">unsigned</span> i = 0;
<a name="l01986"></a>01986     <span class="keywordtype">unsigned</span> j = 0;
<a name="l01987"></a>01987     <span class="keywordtype">int</span> k = 0;
<a name="l01988"></a>01988     <span class="keywordtype">double</span> doppler_base = 0;
<a name="l01989"></a>01989     <span class="keywordtype">double</span> rangerate_base = 0;
<a name="l01990"></a>01990     <span class="keywordtype">double</span> doppler_measured = 0;
<a name="l01991"></a>01991     <span class="keywordtype">double</span> doppler_computed = 0;
<a name="l01992"></a>01992 
<a name="l01993"></a>01993     <span class="keywordflow">if</span>( n == 0 )
<a name="l01994"></a>01994       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01995"></a>01995 
<a name="l01996"></a>01996     <span class="comment">// Check the dimension of w.</span>
<a name="l01997"></a>01997     <span class="keywordflow">if</span>( w.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || w.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 1 )
<a name="l01998"></a>01998     {
<a name="l01999"></a>01999       <span class="keywordflow">if</span>( !w.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 1 ) )
<a name="l02000"></a>02000         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02001"></a>02001     }
<a name="l02002"></a>02002     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l02003"></a>02003     {
<a name="l02004"></a>02004       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l02005"></a>02005       {
<a name="l02006"></a>02006         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#e2a1cbafc527b892efec50bbc22184b2" title="The measured Doppler minus the computed Doppler estimate [m].">doppler_misclosure</a> = 0.0;            
<a name="l02007"></a>02007 
<a name="l02008"></a>02008         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l02009"></a>02009         {
<a name="l02010"></a>02010           <span class="comment">// always compute the misclosure regardless of whether it is used in solution.</span>
<a name="l02011"></a>02011           
<a name="l02012"></a>02012           <span class="comment">// Compute the pseudorange misclosures in meters/second!</span>
<a name="l02013"></a>02013           doppler_measured = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ed460902c2d33bcc7c6dc6fb4ad6389e" title="The Doppler measurement for this channel [Hz].">doppler</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l02014"></a>02014 
<a name="l02015"></a>02015           <span class="comment">// Add the satellite clock drift.        </span>
<a name="l02016"></a>02016           doppler_measured += rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#107a0e6e2076c3b9270d7c2c1b8df0b3" title="The satellite clock drift correction [m/s].">clkdrift</a>;
<a name="l02017"></a>02017           
<a name="l02018"></a>02018           rangerate_base = 0;
<a name="l02019"></a>02019           <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l02020"></a>02020           {
<a name="l02021"></a>02021             doppler_base = 0;
<a name="l02022"></a>02022             <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#66c05cb9b40418a76fd39719ec3be4bd" title="Indicates if a matching Doppler observation is available from another receiver.">isDifferentialDopplerAvailable</a> )
<a name="l02023"></a>02023             {
<a name="l02024"></a>02024               k = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#94a4ce3fd3f096929ae0c1749e9c2474" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential</a>;
<a name="l02025"></a>02025               <span class="keywordflow">if</span>( k != -1 )
<a name="l02026"></a>02026               {
<a name="l02027"></a>02027                 doppler_base   = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ed460902c2d33bcc7c6dc6fb4ad6389e" title="The Doppler measurement for this channel [Hz].">doppler</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l02028"></a>02028                 rangerate_base = rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b38a70ae40a3fadc3664067f4f80eccc" title="The best estimate of the geometric range rate between the antenna and the satellite...">rangerate</a>;
<a name="l02029"></a>02029               }
<a name="l02030"></a>02030               doppler_measured -= doppler_base;
<a name="l02031"></a>02031             }
<a name="l02032"></a>02032           }
<a name="l02033"></a>02033 
<a name="l02034"></a>02034           <span class="comment">// Calculate the computed doppler = geometric range rate + rx clock drift [m/s]</span>
<a name="l02035"></a>02035           doppler_computed = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b38a70ae40a3fadc3664067f4f80eccc" title="The best estimate of the geometric range rate between the antenna and the satellite...">rangerate</a> - rangerate_base + rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>;
<a name="l02036"></a>02036 
<a name="l02037"></a>02037           <span class="comment">// The misclosure is the corrected measured value minus the computed valid.            </span>
<a name="l02038"></a>02038           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#e2a1cbafc527b892efec50bbc22184b2" title="The measured Doppler minus the computed Doppler estimate [m].">doppler_misclosure</a> = doppler_measured - doppler_computed;
<a name="l02039"></a>02039 
<a name="l02040"></a>02040           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l02041"></a>02041           {
<a name="l02042"></a>02042             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l02043"></a>02043               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02044"></a>02044             
<a name="l02045"></a>02045             w[j] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#e2a1cbafc527b892efec50bbc22184b2" title="The measured Doppler minus the computed Doppler estimate [m].">doppler_misclosure</a>;
<a name="l02046"></a>02046             j++;
<a name="l02047"></a>02047           }
<a name="l02048"></a>02048         }
<a name="l02049"></a>02049       }
<a name="l02050"></a>02050     }
<a name="l02051"></a>02051 
<a name="l02052"></a>02052     <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l02053"></a>02053     {
<a name="l02054"></a>02054       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l02055"></a>02055         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02056"></a>02056 
<a name="l02057"></a>02057       w[j] = 0.0;
<a name="l02058"></a>02058       j++;
<a name="l02059"></a>02059       w[j] = 0.0;
<a name="l02060"></a>02060       j++;
<a name="l02061"></a>02061       w[j] = 0.0;
<a name="l02062"></a>02062       j++;
<a name="l02063"></a>02063     }
<a name="l02064"></a>02064     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l02065"></a>02065     {
<a name="l02066"></a>02066       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l02067"></a>02067         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02068"></a>02068      
<a name="l02069"></a>02069       w[j] = 0.0;
<a name="l02070"></a>02070       j++;
<a name="l02071"></a>02071     }
<a name="l02072"></a>02072 
<a name="l02073"></a>02073     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02074"></a>02074   }
<a name="l02075"></a>02075 
<a name="l02076"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19">02076</a> 
<a name="l02077"></a>02077   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19" title="Determine the design matrix for the GPS L1 velocity solution based on Doppler measurements...">GNSS_Estimator::DetermineDesignMatrixForTheVelocitySolution_GPSL1</a>( 
<a name="l02078"></a>02078     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData, <span class="comment">//!&lt; The receiver data.</span>
<a name="l02079"></a>02079 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,    <span class="comment">//!&lt; The number of rows in the design matrix.</span>
<a name="l02080"></a>02080 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;H            <span class="comment">//!&lt; The velocity &amp; rx clock drift design matrix [n x 4].</span>
<a name="l02081"></a>02081 <span class="comment"></span>    )
<a name="l02082"></a>02082   {
<a name="l02083"></a>02083     <span class="keywordtype">unsigned</span> i = 0;
<a name="l02084"></a>02084     <span class="keywordtype">unsigned</span> j = 0;
<a name="l02085"></a>02085 
<a name="l02086"></a>02086     <span class="keywordflow">if</span>( n == 0 )
<a name="l02087"></a>02087       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02088"></a>02088 
<a name="l02089"></a>02089     <span class="comment">// Check the dimension of H.</span>
<a name="l02090"></a>02090     <span class="keywordflow">if</span>( H.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || H.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 4 )
<a name="l02091"></a>02091     {
<a name="l02092"></a>02092       <span class="keywordflow">if</span>( !H.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 4 ) )
<a name="l02093"></a>02093         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02094"></a>02094     }
<a name="l02095"></a>02095     <span class="comment">// Compute the design matrix for the position solution.</span>
<a name="l02096"></a>02096     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l02097"></a>02097     {
<a name="l02098"></a>02098       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l02099"></a>02099       {
<a name="l02100"></a>02100         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l02101"></a>02101         {
<a name="l02102"></a>02102           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l02103"></a>02103           {
<a name="l02104"></a>02104             <span class="comment">// Sanity index check.            </span>
<a name="l02105"></a>02105             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l02106"></a>02106               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02107"></a>02107             
<a name="l02108"></a>02108             <a class="code" href="navigation_8c.html#ec995132ebeab2494bacdde497df971b" title="Computes the derivative of the pseudorange with respect to latitude, longitude, and...">NAVIGATION_ComputeDerivativesOf_Range_WithRespectToLatitudeLongitudeHeight</a>(
<a name="l02109"></a>02109               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l02110"></a>02110               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>, 
<a name="l02111"></a>02111               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>,
<a name="l02112"></a>02112               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#9a66d084cd609f1a0d98ffbe2231deee" title="The satellite position ECEF, x [m].">x</a>,
<a name="l02113"></a>02113               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#81afeb61267dfb4d48299ac8ccc80663" title="The satellite position ECEF, y [m].">y</a>,
<a name="l02114"></a>02114               rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#da9450c27d228f293a4df1c57cabc882" title="Each channel has an associated satellite pvt struct evaluated at the transmit time...">satellite</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_satellite_p_v_t.html#12fa70321d2a265de1f881859a4a88e5" title="The satellite position ECEF, z [m].">z</a>,
<a name="l02115"></a>02115               &amp;H[j][0],
<a name="l02116"></a>02116               &amp;H[j][1],
<a name="l02117"></a>02117               &amp;H[j][2],
<a name="l02118"></a>02118               &amp;rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#741290d0422b6b2874e5c23cf7149ae7" title="The best estimate of the geometric range between the antenna and the satellite [m]...">range</a>
<a name="l02119"></a>02119               );
<a name="l02120"></a>02120             H[j][0] *= -1.0; <span class="comment">// Doppler sign convention, NovAtel convention, increasing psr means negative Doppler</span>
<a name="l02121"></a>02121             H[j][1] *= -1.0;
<a name="l02122"></a>02122             H[j][2] *= -1.0;
<a name="l02123"></a>02123             H[j][3] = 1.0;
<a name="l02124"></a>02124 
<a name="l02125"></a>02125             <span class="comment">// copy the row of the design matrix </span>
<a name="l02126"></a>02126             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#a6d9b3a6826a739790a91aa3d0c58ff3" title="The design matrix row relating the Doppler measurements to the velocity solution...">H_v</a>[0] = H[j][0];
<a name="l02127"></a>02127             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#a6d9b3a6826a739790a91aa3d0c58ff3" title="The design matrix row relating the Doppler measurements to the velocity solution...">H_v</a>[1] = H[j][1];
<a name="l02128"></a>02128             rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#a6d9b3a6826a739790a91aa3d0c58ff3" title="The design matrix row relating the Doppler measurements to the velocity solution...">H_v</a>[2] = H[j][2];
<a name="l02129"></a>02129 
<a name="l02130"></a>02130             j++;
<a name="l02131"></a>02131           }
<a name="l02132"></a>02132         }
<a name="l02133"></a>02133       }
<a name="l02134"></a>02134     }
<a name="l02135"></a>02135 
<a name="l02136"></a>02136     <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l02137"></a>02137     {
<a name="l02138"></a>02138       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l02139"></a>02139         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02140"></a>02140 
<a name="l02141"></a>02141       H[j][0] = 1.0;
<a name="l02142"></a>02142       H[j][1] = 0.0;
<a name="l02143"></a>02143       H[j][2] = 0.0;      
<a name="l02144"></a>02144       H[j][3] = 0.0;      
<a name="l02145"></a>02145       j++;
<a name="l02146"></a>02146       H[j][0] = 0.0;
<a name="l02147"></a>02147       H[j][1] = 1.0;
<a name="l02148"></a>02148       H[j][2] = 0.0;      
<a name="l02149"></a>02149       H[j][3] = 0.0;            
<a name="l02150"></a>02150       j++;
<a name="l02151"></a>02151       H[j][0] = 0.0;
<a name="l02152"></a>02152       H[j][1] = 0.0;
<a name="l02153"></a>02153       H[j][2] = 1.0;      
<a name="l02154"></a>02154       H[j][3] = 0.0;            
<a name="l02155"></a>02155       j++;
<a name="l02156"></a>02156     }
<a name="l02157"></a>02157     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l02158"></a>02158     {
<a name="l02159"></a>02159       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l02160"></a>02160         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02161"></a>02161      
<a name="l02162"></a>02162       H[j][0] = 0.0;
<a name="l02163"></a>02163       H[j][1] = 0.0;
<a name="l02164"></a>02164       H[j][2] = 1.0;      
<a name="l02165"></a>02165       H[j][3] = 0.0;            
<a name="l02166"></a>02166       j++;
<a name="l02167"></a>02167     }
<a name="l02168"></a>02168 
<a name="l02169"></a>02169     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02170"></a>02170   }
<a name="l02171"></a>02171 
<a name="l02172"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#18f021bfbf3e4a19a20bd03b06e17b8f">02172</a> 
<a name="l02173"></a>02173   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#18f021bfbf3e4a19a20bd03b06e17b8f" title="Determine the measurement weight matrix for the GPS L1 velocity solution based on...">GNSS_Estimator::DetermineMeasurementWeightMatrixForTheVelocitySolution_GPSL1</a>( 
<a name="l02174"></a>02174     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,  <span class="comment">//!&lt; The receiver data.</span>
<a name="l02175"></a>02175 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,     <span class="comment">//!&lt; The number of rows in W.</span>
<a name="l02176"></a>02176 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;W             <span class="comment">//!&lt; The inverse of the Doppler measurement variance-coraiance matrix [n x n].</span>
<a name="l02177"></a>02177 <span class="comment"></span>    )
<a name="l02178"></a>02178   {
<a name="l02179"></a>02179     <span class="keywordtype">unsigned</span> i = 0;
<a name="l02180"></a>02180     <span class="keywordtype">unsigned</span> j = 0;
<a name="l02181"></a>02181     <span class="keywordtype">double</span> std_ms = 0.0; <span class="comment">// stdev in m/s</span>
<a name="l02182"></a>02182 
<a name="l02183"></a>02183     <span class="comment">// Check the dimension of W.</span>
<a name="l02184"></a>02184     <span class="keywordflow">if</span>( W.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || W.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != n )
<a name="l02185"></a>02185     {
<a name="l02186"></a>02186       <span class="keywordflow">if</span>( !W.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, n ) )
<a name="l02187"></a>02187         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02188"></a>02188     }
<a name="l02189"></a>02189     <span class="comment">// Set the weight matrix.</span>
<a name="l02190"></a>02190     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l02191"></a>02191     {
<a name="l02192"></a>02192       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l02193"></a>02193       {
<a name="l02194"></a>02194         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l02195"></a>02195         {
<a name="l02196"></a>02196           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l02197"></a>02197           {
<a name="l02198"></a>02198             <span class="comment">// Sanity index check.</span>
<a name="l02199"></a>02199             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l02200"></a>02200               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02201"></a>02201 
<a name="l02202"></a>02202             <span class="comment">// Check divide by zero.</span>
<a name="l02203"></a>02203             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ba2e69584653c821eebc74640acfee53" title="The estimated Doppler measurement standard deviation [Hz].">stdev_doppler</a> == 0.0 )
<a name="l02204"></a>02204               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02205"></a>02205 
<a name="l02206"></a>02206             std_ms = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ba2e69584653c821eebc74640acfee53" title="The estimated Doppler measurement standard deviation [Hz].">stdev_doppler</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l02207"></a>02207             W[j][j] = 1.0/(std_ms*std_ms);            
<a name="l02208"></a>02208             j++;
<a name="l02209"></a>02209           }
<a name="l02210"></a>02210         }
<a name="l02211"></a>02211       }
<a name="l02212"></a>02212     }
<a name="l02213"></a>02213 
<a name="l02214"></a>02214     <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l02215"></a>02215     {
<a name="l02216"></a>02216       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l02217"></a>02217         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02218"></a>02218 
<a name="l02219"></a>02219       W[j][j] = 1.0/(1.0e-10);
<a name="l02220"></a>02220       j++;
<a name="l02221"></a>02221       W[j][j] = 1.0/(1.0e-10);
<a name="l02222"></a>02222       j++;
<a name="l02223"></a>02223       W[j][j] = 1.0/(1.0e-10);
<a name="l02224"></a>02224       j++;
<a name="l02225"></a>02225     }
<a name="l02226"></a>02226     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l02227"></a>02227     {
<a name="l02228"></a>02228       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l02229"></a>02229         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02230"></a>02230      
<a name="l02231"></a>02231       W[j][j] = 1.0/(1.0e-10);
<a name="l02232"></a>02232       j++;
<a name="l02233"></a>02233     }
<a name="l02234"></a>02234 
<a name="l02235"></a>02235     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02236"></a>02236   }
<a name="l02237"></a>02237 
<a name="l02238"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#981212395e812c74a9ce542c2b7187cd">02238</a> 
<a name="l02239"></a>02239   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#981212395e812c74a9ce542c2b7187cd" title="Determine the measurement variance-covariance matrix for the GPS L1 velocity solution...">GNSS_Estimator::DetermineMeasurementVarianceCovarianceMatrixForTheVelocitySolution_GPSL1</a>( 
<a name="l02240"></a>02240     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,  <span class="comment">//!&lt; The receiver data.</span>
<a name="l02241"></a>02241 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n,     <span class="comment">//!&lt; The number of rows in R.</span>
<a name="l02242"></a>02242 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;R             <span class="comment">//!&lt; The inverse of the Doppler measurement variance-coraiance matrix [n x n].</span>
<a name="l02243"></a>02243 <span class="comment"></span>    )
<a name="l02244"></a>02244   {
<a name="l02245"></a>02245     <span class="keywordtype">unsigned</span> i = 0;
<a name="l02246"></a>02246     <span class="keywordtype">unsigned</span> j = 0;
<a name="l02247"></a>02247     <span class="keywordtype">double</span> std_ms = 0; <span class="comment">// stdev in m/s</span>
<a name="l02248"></a>02248 
<a name="l02249"></a>02249     <span class="comment">// Check the dimension of R.</span>
<a name="l02250"></a>02250     <span class="keywordflow">if</span>( R.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != n || R.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != n )
<a name="l02251"></a>02251     {
<a name="l02252"></a>02252       <span class="keywordflow">if</span>( !R.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, n ) )
<a name="l02253"></a>02253         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02254"></a>02254     }
<a name="l02255"></a>02255     <span class="comment">// Set the weight matrix.</span>
<a name="l02256"></a>02256     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l02257"></a>02257     {
<a name="l02258"></a>02258       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l02259"></a>02259       {
<a name="l02260"></a>02260         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l02261"></a>02261         {
<a name="l02262"></a>02262           <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l02263"></a>02263           {
<a name="l02264"></a>02264             <span class="comment">// Sanity index check.</span>
<a name="l02265"></a>02265             <span class="keywordflow">if</span>( j &gt;= n )
<a name="l02266"></a>02266               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02267"></a>02267 
<a name="l02268"></a>02268             <span class="comment">// Check divide by zero.</span>
<a name="l02269"></a>02269             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ba2e69584653c821eebc74640acfee53" title="The estimated Doppler measurement standard deviation [Hz].">stdev_doppler</a> == 0.0 )
<a name="l02270"></a>02270               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02271"></a>02271 
<a name="l02272"></a>02272             <span class="comment">// Convert to meters/second!</span>
<a name="l02273"></a>02273             std_ms = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ba2e69584653c821eebc74640acfee53" title="The estimated Doppler measurement standard deviation [Hz].">stdev_doppler</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l02274"></a>02274 
<a name="l02275"></a>02275             R[j][j] = std_ms*std_ms;
<a name="l02276"></a>02276             j++;
<a name="l02277"></a>02277           }
<a name="l02278"></a>02278         }
<a name="l02279"></a>02279       }
<a name="l02280"></a>02280     }
<a name="l02281"></a>02281 
<a name="l02282"></a>02282     <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l02283"></a>02283     {
<a name="l02284"></a>02284       <span class="keywordflow">if</span>( j + 3 &gt; n )
<a name="l02285"></a>02285         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02286"></a>02286 
<a name="l02287"></a>02287       R[j][j] = 1.0e-10;
<a name="l02288"></a>02288       j++;
<a name="l02289"></a>02289       R[j][j] = 1.0e-10;
<a name="l02290"></a>02290       j++;
<a name="l02291"></a>02291       R[j][j] = 1.0e-10;
<a name="l02292"></a>02292       j++;
<a name="l02293"></a>02293     }
<a name="l02294"></a>02294     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#26c9434a49fe56e0f9ed028738dba390" title="Is this a height constrained solution [TRUE(1),FALSE(0)].">isHeightConstrained</a> )
<a name="l02295"></a>02295     {
<a name="l02296"></a>02296       <span class="keywordflow">if</span>( j + 1 &gt; n )
<a name="l02297"></a>02297         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02298"></a>02298      
<a name="l02299"></a>02299       R[j][j] = 1.0e-10;
<a name="l02300"></a>02300       j++;
<a name="l02301"></a>02301     }
<a name="l02302"></a>02302 
<a name="l02303"></a>02303     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02304"></a>02304   }
<a name="l02305"></a>02305 
<a name="l02306"></a>02306 
<a name="l02307"></a>02307 <span class="comment"></span>
<a name="l02308"></a>02308 <span class="comment">  /// \brief    Perform the Global Internal Reliability Test, followed by a </span>
<a name="l02309"></a>02309 <span class="comment">  ///           search using local testing for a single measurement fault if </span>
<a name="l02310"></a>02310 <span class="comment">  ///           the global test fails.</span>
<a name="l02311"></a>02311 <span class="comment">  ///</span>
<a name="l02312"></a>02312 <span class="comment">  /// The Global Internal Reliability Test: \n</span>
<a name="l02313"></a>02313 <span class="comment">  /// The aposteriori variance factor is computed and compared to the value </span>
<a name="l02314"></a>02314 <span class="comment">  /// generated using Chi^2 lookup table. The aposerteriori variance factor </span>
<a name="l02315"></a>02315 <span class="comment">  /// indicates the following: \n</span>
<a name="l02316"></a>02316 <span class="comment">  /// if( apv ~= 1 ) \n</span>
<a name="l02317"></a>02317 <span class="comment">  ///   solution and observations are well modelled. \n</span>
<a name="l02318"></a>02318 <span class="comment">  /// if( apv &lt; 1 ) \n</span>
<a name="l02319"></a>02319 <span class="comment">  ///   observation variance matrix is pessimistic. \n</span>
<a name="l02320"></a>02320 <span class="comment">  ///   (observations are better than what you said). \n</span>
<a name="l02321"></a>02321 <span class="comment">  /// if( apv &gt; 1 ) \n</span>
<a name="l02322"></a>02322 <span class="comment">  ///   (1) The math model incorrect, (not likely) \n</span>
<a name="l02323"></a>02323 <span class="comment">  ///   (2) The weight matrix/observation variance matrix is optimistic </span>
<a name="l02324"></a>02324 <span class="comment">  ///      (observations are worse than what you said). \n</span>
<a name="l02325"></a>02325 <span class="comment">  ///   (3) Their is a blunder in the observations that is skewing the normality </span>
<a name="l02326"></a>02326 <span class="comment">  ///       of the solution, and a local test for blunder my be needed. \n</span>
<a name="l02327"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#08bc49b2a24eeb6106182db329612797">02327</a> <span class="comment">  ///</span>
<a name="l02328"></a>02328 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#08bc49b2a24eeb6106182db329612797" title="Perform the Global Internal Reliability Test, followed by a search using local testing...">GNSS_Estimator::PerformGlobalTestAndTestForMeasurementFaults</a>( 
<a name="l02329"></a>02329     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData,           <span class="comment">//!&lt; The receiver data object.</span>
<a name="l02330"></a>02330 <span class="comment"></span>    <span class="keywordtype">bool</span> testPsrOrDoppler,         <span class="comment">//!&lt; This indicates if the psr misclosures are checked, otherwise the Doppler misclosures are checked. </span>
<a name="l02331"></a>02331 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; H,                     <span class="comment">//!&lt; The design matrix, H,                           [n x u].</span>
<a name="l02332"></a>02332 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; Ht,                    <span class="comment">//!&lt; The design matrix transposed, H,                [n x u].</span>
<a name="l02333"></a>02333 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; W,                     <span class="comment">//!&lt; The observation weight matrix, W,               [n x n].</span>
<a name="l02334"></a>02334 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; R,                     <span class="comment">//!&lt; The observation variance-covariance matrix, R,  [n x n].</span>
<a name="l02335"></a>02335 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; r,                     <span class="comment">//!&lt; The observation residual vector,                [n x 1].</span>
<a name="l02336"></a>02336 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; P,                     <span class="comment">//!&lt; The state variance-covariance matrix,           [u x u].</span>
<a name="l02337"></a>02337 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> n,         <span class="comment">//!&lt; The number of observations, n.</span>
<a name="l02338"></a>02338 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> u,         <span class="comment">//!&lt; The number of unknowns, u.</span>
<a name="l02339"></a>02339 <span class="comment"></span>    <span class="keywordtype">double</span> &amp;avf,                   <span class="comment">//!&lt; The computed a-posteriori variance factor is returned.</span>
<a name="l02340"></a>02340 <span class="comment"></span>    <span class="keywordtype">bool</span> &amp;isGlobalTestPassed,      <span class="comment">//!&lt; This indicates if the global test passed.    </span>
<a name="l02341"></a>02341 <span class="comment"></span>    <span class="keywordtype">bool</span> &amp;hasRejectionOccurred,    <span class="comment">//!&lt; This indicates if a rejection occurred. Only one measurement is flagged.</span>
<a name="l02342"></a>02342 <span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> &amp;indexOfRejected <span class="comment">//!&lt; This is the index of the rejected observation.</span>
<a name="l02343"></a>02343 <span class="comment"></span>    )
<a name="l02344"></a>02344   {
<a name="l02345"></a>02345     <span class="keywordtype">double</span> v = n-u; <span class="comment">// The degree of freedom.</span>
<a name="l02346"></a>02346 
<a name="l02347"></a>02347     <span class="keywordtype">unsigned</span> i = 0;
<a name="l02348"></a>02348     <span class="keywordtype">unsigned</span> j = 0; 
<a name="l02349"></a>02349     <span class="keywordtype">unsigned</span> indexvec[<a class="code" href="_g_n_s_s___rx_data_8h.html#de46e7b2c415b2a1a4f5f4011e76d8d8">GNSS_RXDATA_NR_CHANNELS</a>]; <span class="comment">// An array with the indices measurements that are used in solution.</span>
<a name="l02350"></a>02350 
<a name="l02351"></a>02351     <span class="keywordtype">double</span> rv = 0;           <span class="comment">// An unsigned standardized residual value.</span>
<a name="l02352"></a>02352     <span class="keywordtype">double</span> largest_rv = 0.0; <span class="comment">// The largest unsigned standardized residual value.    </span>
<a name="l02353"></a>02353     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> indexOfLargest = 0; <span class="comment">// The index of the largest standardized residual value.  </span>
<a name="l02354"></a>02354 
<a name="l02355"></a>02355     <span class="keywordtype">double</span> chiSquaredValue = 0;                     <span class="comment">// The chi squared test value = look up table value / degrees of freedom.</span>
<a name="l02356"></a>02356     <span class="keywordtype">double</span> chiSquared005[31] = <a class="code" href="_g_n_s_s___estimator_8cpp.html#2023cb42b2282738ee169195e4645046">GNSS_CHISQUARE_00_5</a>; <span class="comment">// The chi squared look up table for alpha = 0.005.</span>
<a name="l02357"></a>02357     
<a name="l02358"></a>02358     <span class="comment">// Initial output values.</span>
<a name="l02359"></a>02359     isGlobalTestPassed = <span class="keyword">false</span>;
<a name="l02360"></a>02360     hasRejectionOccurred = <span class="keyword">false</span>;      
<a name="l02361"></a>02361     
<a name="l02362"></a>02362     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> Cr;             <span class="comment">// The variance-covariance matrix of the residuals [n x n].</span>
<a name="l02363"></a>02363     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> rT;             <span class="comment">// The residuals vector transposed,                [1 x n]</span>
<a name="l02364"></a>02364     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> r_standardized; <span class="comment">// The standardized residuals,                     [n x 1].</span>
<a name="l02365"></a>02365     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpM;
<a name="l02366"></a>02366 
<a name="l02367"></a>02367     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"P"</span>, P );
<a name="l02368"></a>02368 
<a name="l02369"></a>02369     i = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(v);
<a name="l02370"></a>02370     <span class="keywordflow">if</span>( i == 0 )
<a name="l02371"></a>02371       <span class="keywordflow">return</span> <span class="keyword">true</span>; 
<a name="l02372"></a>02372     
<a name="l02373"></a>02373     rT = r;
<a name="l02374"></a>02374     <span class="keywordflow">if</span>( !rT.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>() )
<a name="l02375"></a>02375       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02376"></a>02376 
<a name="l02377"></a>02377     <span class="comment">// Compute the a-posteriori variance factor.</span>
<a name="l02378"></a>02378     tmpM = rT * W * r;
<a name="l02379"></a>02379     avf = tmpM[0] / v;
<a name="l02380"></a>02380     
<a name="l02381"></a>02381     <span class="comment">// Determine the chi squared test statistic value.</span>
<a name="l02382"></a>02382     i = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(v);
<a name="l02383"></a>02383     <span class="keywordflow">if</span>( i &lt; 0 || i &gt; 30 )
<a name="l02384"></a>02384       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02385"></a>02385     chiSquaredValue = chiSquared005[i];
<a name="l02386"></a>02386     chiSquaredValue /= v;
<a name="l02387"></a>02387     
<a name="l02388"></a>02388     <span class="comment">// Perform the Global Test.</span>
<a name="l02389"></a>02389     <span class="keywordflow">if</span>( avf &lt; chiSquaredValue )
<a name="l02390"></a>02390     {
<a name="l02391"></a>02391       <span class="comment">// The Global test passes. No local test will be performed.</span>
<a name="l02392"></a>02392       isGlobalTestPassed = <span class="keyword">true</span>;
<a name="l02393"></a>02393       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02394"></a>02394     }
<a name="l02395"></a>02395 
<a name="l02396"></a>02396     <span class="comment">// Check that there is enough redudancy to remove outliers.</span>
<a name="l02397"></a>02397     i = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(v);
<a name="l02398"></a>02398     <span class="keywordflow">if</span>( i &lt;= 0 )
<a name="l02399"></a>02399     {
<a name="l02400"></a>02400       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02401"></a>02401     }
<a name="l02402"></a>02402 
<a name="l02403"></a>02403     <span class="comment"></span>
<a name="l02404"></a>02404 <span class="comment">    ////</span>
<a name="l02405"></a>02405 <span class="comment"></span>    <span class="comment">// Perform the local test.</span>
<a name="l02406"></a>02406 
<a name="l02407"></a>02407     <span class="comment">// Determine the indices of the observations that match the</span>
<a name="l02408"></a>02408     <span class="comment">// values in the residuals vector.</span>
<a name="l02409"></a>02409     j = 0;
<a name="l02410"></a>02410     <span class="keywordflow">for</span>( i = 0; i &lt; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l02411"></a>02411     {
<a name="l02412"></a>02412       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l02413"></a>02413       {
<a name="l02414"></a>02414         <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l02415"></a>02415         {
<a name="l02416"></a>02416           <span class="keywordflow">if</span>( testPsrOrDoppler )
<a name="l02417"></a>02417           {
<a name="l02418"></a>02418             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l02419"></a>02419             {
<a name="l02420"></a>02420               indexvec[j] = i;
<a name="l02421"></a>02421               j++;
<a name="l02422"></a>02422             }
<a name="l02423"></a>02423           }
<a name="l02424"></a>02424           <span class="keywordflow">else</span>
<a name="l02425"></a>02425           {
<a name="l02426"></a>02426             <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l02427"></a>02427             {
<a name="l02428"></a>02428               indexvec[j] = i;
<a name="l02429"></a>02429               j++;
<a name="l02430"></a>02430             }
<a name="l02431"></a>02431           }
<a name="l02432"></a>02432         }        
<a name="l02433"></a>02433       }
<a name="l02434"></a>02434     }
<a name="l02435"></a>02435     
<a name="l02436"></a>02436     
<a name="l02437"></a>02437     <span class="comment">// Compute the variance-covariance of the residuals.</span>
<a name="l02438"></a>02438     Cr = R - H * P * Ht;
<a name="l02439"></a>02439 
<a name="l02440"></a>02440     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"Cr"</span>, Cr );
<a name="l02441"></a>02441 
<a name="l02442"></a>02442 
<a name="l02443"></a>02443     <span class="comment">// Check the diagonal of Cr for zero and negative values, an error condition.</span>
<a name="l02444"></a>02444     <span class="keywordflow">for</span>( i = 0; i &lt; Cr.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>(); i++ )
<a name="l02445"></a>02445     {
<a name="l02446"></a>02446       <span class="keywordflow">if</span>( Cr[i][i] &lt;= 0.0 )
<a name="l02447"></a>02447       {
<a name="l02448"></a>02448         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02449"></a>02449       }
<a name="l02450"></a>02450     }
<a name="l02451"></a>02451 
<a name="l02452"></a>02452     
<a name="l02453"></a>02453     <span class="keywordflow">if</span>( !r_standardized.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( Cr.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>(), 1) )
<a name="l02454"></a>02454       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02455"></a>02455 
<a name="l02456"></a>02456     <span class="comment">// Compute the standardized residuals, r(i) /= Cr(i,i).</span>
<a name="l02457"></a>02457     <span class="comment">// Determine the largest standardized residual value.</span>
<a name="l02458"></a>02458     <span class="keywordflow">for</span>( i = 0; i &lt; Cr.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>(); i++ )
<a name="l02459"></a>02459     {
<a name="l02460"></a>02460       r_standardized[i] = r[i] / sqrt( Cr[i][i] );
<a name="l02461"></a>02461 
<a name="l02462"></a>02462       rv = fabs( r_standardized[i] );
<a name="l02463"></a>02463 
<a name="l02464"></a>02464       <span class="comment">// don't allow the position constraint to be rejected.</span>
<a name="l02465"></a>02465       <span class="keywordflow">if</span>( rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> )
<a name="l02466"></a>02466       {
<a name="l02467"></a>02467         <span class="keywordflow">if</span>( i &gt;= Cr.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() -3 )
<a name="l02468"></a>02468           <span class="keywordflow">continue</span>;
<a name="l02469"></a>02469       }
<a name="l02470"></a>02470 
<a name="l02471"></a>02471       <span class="keywordflow">if</span>( rv &gt; largest_rv )
<a name="l02472"></a>02472       {
<a name="l02473"></a>02473         largest_rv = rv;
<a name="l02474"></a>02474         indexOfLargest = i; <span class="comment">// This is the index into r.</span>
<a name="l02475"></a>02475       }
<a name="l02476"></a>02476     }
<a name="l02477"></a>02477     indexOfLargest = indexvec[indexOfLargest]; <span class="comment">// This is the index into the observation array.</span>
<a name="l02478"></a>02478 
<a name="l02479"></a>02479     <span class="comment">// sanity index check</span>
<a name="l02480"></a>02480     <span class="keywordflow">if</span>( indexOfLargest &gt;= rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a> )
<a name="l02481"></a>02481       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02482"></a>02482 
<a name="l02483"></a>02483     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"r"</span>, r );
<a name="l02484"></a>02484     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"r_standardized"</span>, r_standardized );
<a name="l02485"></a>02485     
<a name="l02486"></a>02486     <span class="comment">// In reliability testing, alpha = 0.005, n_(1-alpha/2) = 4.57</span>
<a name="l02487"></a>02487     <span class="keywordflow">if</span>( largest_rv &gt; 4.57 ) <span class="comment">// reject only clear blunders</span>
<a name="l02488"></a>02488     {
<a name="l02489"></a>02489       <span class="comment">// An observation will be rejected.</span>
<a name="l02490"></a>02490       hasRejectionOccurred = <span class="keyword">true</span>;      
<a name="l02491"></a>02491 
<a name="l02492"></a>02492       <span class="keywordflow">if</span>( testPsrOrDoppler ) <span class="comment">// true is pseudorange</span>
<a name="l02493"></a>02493         rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[indexOfLargest].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3715357201615d87ae238bc42b71ef24" title="Indicates if the pseudorange was not rejetced (ie Fault Detection and Exclusion)...">isNotPsrRejected</a> = 0;
<a name="l02494"></a>02494       <span class="keywordflow">else</span>
<a name="l02495"></a>02495         rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[indexOfLargest].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#7bb3fc309e794584096393d7d8a7ccaf" title="Indicates if the Doppler was not rejected (ie Fault Detection and Exclusion).">isNotDopplerRejected</a> = 0;      
<a name="l02496"></a>02496     }
<a name="l02497"></a>02497 
<a name="l02498"></a>02498     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02499"></a>02499   }
<a name="l02500"></a>02500 
<a name="l02501"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e0a326c17c9c6e39368f7ebc9aa43ab1">02501</a> 
<a name="l02502"></a>02502   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e0a326c17c9c6e39368f7ebc9aa43ab1">GNSS_Estimator::ComputeTransitionMatrix_8StatePVGM</a>(
<a name="l02503"></a>02503     <span class="keyword">const</span> <span class="keywordtype">double</span> dT,            <span class="comment">//!&lt; The change in time since the last update [s].</span>
<a name="l02504"></a>02504 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;T,                  <span class="comment">//!&lt; The transition matrix [8 x 8].</span>
<a name="l02505"></a>02505 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVn,        <span class="comment">//!&lt; The Gauss Markov beta for northing velocity [1/s].</span>
<a name="l02506"></a>02506 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVe,        <span class="comment">//!&lt; The Gauss Markov beta for easting velocity [1/s].</span>
<a name="l02507"></a>02507 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVup,       <span class="comment">//!&lt; The Gauss Markov beta for up velocity [1/s].</span>
<a name="l02508"></a>02508 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaClkDrift   <span class="comment">//!&lt; The Gauss Markov beta for the clock bias [1/s].</span>
<a name="l02509"></a>02509 <span class="comment"></span>    )
<a name="l02510"></a>02510   {
<a name="l02511"></a>02511     <span class="comment">//double dN = 0;</span>
<a name="l02512"></a>02512     <span class="keywordtype">double</span> eVn = 0;
<a name="l02513"></a>02513     <span class="keywordtype">double</span> eVe = 0;
<a name="l02514"></a>02514     <span class="keywordtype">double</span> eVup = 0;
<a name="l02515"></a>02515     <span class="keywordtype">double</span> eClkDrift = 0;
<a name="l02516"></a>02516 
<a name="l02517"></a>02517     <span class="keywordflow">if</span>( T.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != 8 || T.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 8 )
<a name="l02518"></a>02518     {
<a name="l02519"></a>02519       <span class="keywordflow">if</span>( !T.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>(8,8) )
<a name="l02520"></a>02520         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02521"></a>02521     }    
<a name="l02522"></a>02522     
<a name="l02523"></a>02523     eVn  = exp( -betaVn  * dT );
<a name="l02524"></a>02524     eVe  = exp( -betaVe  * dT );
<a name="l02525"></a>02525     eVup = exp( -betaVup * dT );
<a name="l02526"></a>02526 
<a name="l02527"></a>02527     eClkDrift = exp( -betaClkDrift * dT );
<a name="l02528"></a>02528 
<a name="l02529"></a>02529     T.<a class="code" href="class_zenautics_1_1_matrix.html#31f74d047657ee91ed3160a5cca797ce" title="Zero the entire matrix.">Zero</a>();
<a name="l02530"></a>02530     
<a name="l02531"></a>02531     T[0][0] = 1.0;
<a name="l02532"></a>02532     T[0][3] = (1.0 - eVn) / betaVn;
<a name="l02533"></a>02533 
<a name="l02534"></a>02534     T[1][1] = 1.0;
<a name="l02535"></a>02535     T[1][4] = (1.0 - eVe) / betaVe;
<a name="l02536"></a>02536 
<a name="l02537"></a>02537     T[2][2] = 1.0;
<a name="l02538"></a>02538     T[2][5] = (1.0 - eVup) / betaVup;
<a name="l02539"></a>02539     
<a name="l02540"></a>02540     T[3][3] = eVn;
<a name="l02541"></a>02541     T[4][4] = eVe;
<a name="l02542"></a>02542     T[5][5] = eVup;
<a name="l02543"></a>02543 
<a name="l02544"></a>02544     T[6][6] = 1.0;
<a name="l02545"></a>02545     T[6][7] = (1.0 - eClkDrift) / betaClkDrift;
<a name="l02546"></a>02546 
<a name="l02547"></a>02547     T[7][7] = eClkDrift;
<a name="l02548"></a>02548 
<a name="l02549"></a>02549     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02550"></a>02550   }
<a name="l02551"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6b021d1efba0203fff9992400f4891c5">02551</a> 
<a name="l02552"></a>02552   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6b021d1efba0203fff9992400f4891c5">GNSS_Estimator::ComputeTransitionMatrix_8StatePVGM_Float</a>(
<a name="l02553"></a>02553     <span class="keyword">const</span> <span class="keywordtype">double</span> dT,            <span class="comment">//!&lt; The change in time since the last update [s].</span>
<a name="l02554"></a>02554 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;T,                  <span class="comment">//!&lt; The transition matrix [(8 + nrAmb) x (8 + nrAmb)]. </span>
<a name="l02555"></a>02555 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVn,        <span class="comment">//!&lt; The Gauss Markov beta for northing velocity [1/s].</span>
<a name="l02556"></a>02556 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVe,        <span class="comment">//!&lt; The Gauss Markov beta for easting velocity [1/s].</span>
<a name="l02557"></a>02557 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVup,       <span class="comment">//!&lt; The Gauss Markov beta for up velocity [1/s].</span>
<a name="l02558"></a>02558 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaClkDrift   <span class="comment">//!&lt; The Gauss Markov beta for the clock bias [1/s].</span>
<a name="l02559"></a>02559 <span class="comment"></span>    )
<a name="l02560"></a>02560   {
<a name="l02561"></a>02561     <span class="comment">//double dN = 0;</span>
<a name="l02562"></a>02562     <span class="keywordtype">double</span> eVn = 0;
<a name="l02563"></a>02563     <span class="keywordtype">double</span> eVe = 0;
<a name="l02564"></a>02564     <span class="keywordtype">double</span> eVup = 0;
<a name="l02565"></a>02565     <span class="keywordtype">double</span> eClkDrift = 0;
<a name="l02566"></a>02566     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 8 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.size());
<a name="l02567"></a>02567 
<a name="l02568"></a>02568     T.<a class="code" href="class_zenautics_1_1_matrix.html#69a5e6812dea81dcf051de9b660b191b" title="Set the matrix to identity using the current dimensions.">Identity</a>( u );
<a name="l02569"></a>02569     
<a name="l02570"></a>02570     eVn  = exp( -betaVn  * dT );
<a name="l02571"></a>02571     eVe  = exp( -betaVe  * dT );
<a name="l02572"></a>02572     eVup = exp( -betaVup * dT );
<a name="l02573"></a>02573 
<a name="l02574"></a>02574     eClkDrift = exp( -betaClkDrift * dT );
<a name="l02575"></a>02575 
<a name="l02576"></a>02576     T[0][0] = 1.0;
<a name="l02577"></a>02577     T[0][3] = (1.0 - eVn) / betaVn;
<a name="l02578"></a>02578 
<a name="l02579"></a>02579     T[1][1] = 1.0;
<a name="l02580"></a>02580     T[1][4] = (1.0 - eVe) / betaVe;
<a name="l02581"></a>02581 
<a name="l02582"></a>02582     T[2][2] = 1.0;
<a name="l02583"></a>02583     T[2][5] = (1.0 - eVup) / betaVup;
<a name="l02584"></a>02584     
<a name="l02585"></a>02585     T[3][3] = eVn;
<a name="l02586"></a>02586     T[4][4] = eVe;
<a name="l02587"></a>02587     T[5][5] = eVup;
<a name="l02588"></a>02588 
<a name="l02589"></a>02589     T[6][6] = 1.0;
<a name="l02590"></a>02590     T[6][7] = (1.0 - eClkDrift) / betaClkDrift;
<a name="l02591"></a>02591 
<a name="l02592"></a>02592     T[7][7] = eClkDrift;
<a name="l02593"></a>02593 
<a name="l02594"></a>02594     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02595"></a>02595   }
<a name="l02596"></a>02596 
<a name="l02597"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#45ee367eb2b37a2e0586d55e7b2afdf1">02597</a> 
<a name="l02598"></a>02598   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#45ee367eb2b37a2e0586d55e7b2afdf1">GNSS_Estimator::ComputeProcessNoiseMatrix_8StatePVGM</a>(
<a name="l02599"></a>02599     <span class="keyword">const</span> <span class="keywordtype">double</span> dT,           <span class="comment">//!&lt; The change in time since the last update [s].</span>
<a name="l02600"></a>02600 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;Q,                 <span class="comment">//!&lt; The process noise matrix [8 x 8].</span>
<a name="l02601"></a>02601 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVn,       <span class="comment">//!&lt; The Gauss Markov beta for northing velocity [1/s].</span>
<a name="l02602"></a>02602 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVe,       <span class="comment">//!&lt; The Gauss Markov beta for easting velocity [1/s].</span>
<a name="l02603"></a>02603 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVup,      <span class="comment">//!&lt; The Gauss Markov beta for up velocity [1/s].</span>
<a name="l02604"></a>02604 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaClkDrift, <span class="comment">//!&lt; The Gauss Markov beta for the clock bias [1/s].</span>
<a name="l02605"></a>02605 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qVn,          <span class="comment">//!&lt; The process noise value for northing velocity.</span>
<a name="l02606"></a>02606 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qVe,          <span class="comment">//!&lt; The process noise value for easting  velocity.</span>
<a name="l02607"></a>02607 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qVup,         <span class="comment">//!&lt; The process noise value for up       velocity.</span>
<a name="l02608"></a>02608 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qClkDrift     <span class="comment">//!&lt; The process noise value for clock drift.</span>
<a name="l02609"></a>02609 <span class="comment"></span>    )
<a name="l02610"></a>02610   {
<a name="l02611"></a>02611     <span class="comment">//const double dT2 = dT*dT;</span>
<a name="l02612"></a>02612     <span class="keywordtype">double</span> eVn = 0;
<a name="l02613"></a>02613     <span class="keywordtype">double</span> eVe = 0;
<a name="l02614"></a>02614     <span class="keywordtype">double</span> eVup = 0;
<a name="l02615"></a>02615     <span class="keywordtype">double</span> eClkDrift = 0;
<a name="l02616"></a>02616     <span class="keywordtype">double</span> eVn2 = 0;
<a name="l02617"></a>02617     <span class="keywordtype">double</span> eVe2 = 0;
<a name="l02618"></a>02618     <span class="keywordtype">double</span> eVup2 = 0;
<a name="l02619"></a>02619     <span class="keywordtype">double</span> eClkDrift2 = 0;
<a name="l02620"></a>02620 
<a name="l02621"></a>02621     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 8;
<a name="l02622"></a>02622 
<a name="l02623"></a>02623     <span class="keywordflow">if</span>( Q.<a class="code" href="class_zenautics_1_1_matrix.html#ea99fa271d975e628a72f518958c746d" title="return no. of rows">nrows</a>() != u )
<a name="l02624"></a>02624     {
<a name="l02625"></a>02625       <span class="keywordflow">if</span>( !Q.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( u, u ) )
<a name="l02626"></a>02626       {
<a name="l02627"></a>02627         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02628"></a>02628       }
<a name="l02629"></a>02629     }
<a name="l02630"></a>02630     
<a name="l02631"></a>02631     
<a name="l02632"></a>02632     eVn        = exp( -betaVn  * dT );
<a name="l02633"></a>02633     eVe        = exp( -betaVe  * dT );
<a name="l02634"></a>02634     eVup       = exp( -betaVup * dT );
<a name="l02635"></a>02635     eClkDrift  = exp( -betaClkDrift * dT );
<a name="l02636"></a>02636 
<a name="l02637"></a>02637     eVn2       = exp( -2.0 * betaVn  * dT );
<a name="l02638"></a>02638     eVe2       = exp( -2.0 * betaVe  * dT );
<a name="l02639"></a>02639     eVup2      = exp( -2.0 * betaVup * dT );
<a name="l02640"></a>02640     eClkDrift2 = exp( -2.0 * betaClkDrift * dT );
<a name="l02641"></a>02641 
<a name="l02642"></a>02642     Q[0][0]  = qVn / (betaVn*betaVn);
<a name="l02643"></a>02643     Q[0][0] *= dT - 2.0*(1.0 - eVn)/(betaVn) + (1.0 - eVn2)/(2.0*betaVn);
<a name="l02644"></a>02644 
<a name="l02645"></a>02645     Q[1][1]  = qVe / (betaVe*betaVe);
<a name="l02646"></a>02646     Q[1][1] *= dT - 2.0*(1.0 - eVe)/(betaVe) + (1.0 - eVe2)/(2.0*betaVe);
<a name="l02647"></a>02647 
<a name="l02648"></a>02648     Q[2][2]  = qVn / (betaVup*betaVup);
<a name="l02649"></a>02649     Q[2][2] *= dT - 2.0*(1.0 - eVup)/(betaVup) + (1.0 - eVup2)/(2.0*betaVup);
<a name="l02650"></a>02650 
<a name="l02651"></a>02651     Q[3][3]  = qVn * (1.0 - eVn2) / (2.0*betaVn);
<a name="l02652"></a>02652     
<a name="l02653"></a>02653     Q[4][4]  = qVe * (1.0 - eVe2) / (2.0*betaVe);
<a name="l02654"></a>02654 
<a name="l02655"></a>02655     Q[5][5]  = qVup * (1.0 - eVup2) / (2.0*betaVup);
<a name="l02656"></a>02656 
<a name="l02657"></a>02657     <span class="comment">// GDM_HACK added the 0.009</span>
<a name="l02658"></a>02658     <span class="comment">//Q[6][6]  = 0.3*dT + qClkDrift / (betaClkDrift*betaClkDrift);</span>
<a name="l02659"></a>02659     Q[6][6]  = qClkDrift / (betaClkDrift*betaClkDrift);
<a name="l02660"></a>02660     Q[6][6] *= dT - 2.0*(1.0 - eClkDrift)/(betaClkDrift) + (1.0 - eClkDrift2)/(2.0*betaClkDrift);
<a name="l02661"></a>02661     
<a name="l02662"></a>02662     Q[7][7]  = qClkDrift * (1.0 - eClkDrift2) / (2.0*betaClkDrift);
<a name="l02663"></a>02663 
<a name="l02664"></a>02664     Q[0][3]  = qVn / betaVn;
<a name="l02665"></a>02665     Q[0][3] *= (1.0 - eVn)/betaVn - (1.0 - eVn2)/(2.0*betaVn);
<a name="l02666"></a>02666     Q[3][0]  = Q[0][3];
<a name="l02667"></a>02667 
<a name="l02668"></a>02668     Q[1][4]  = qVe / betaVe;
<a name="l02669"></a>02669     Q[1][4] *= (1.0 - eVe)/betaVe - (1.0 - eVe2)/(2.0*betaVe);
<a name="l02670"></a>02670     Q[4][1]  = Q[1][4];
<a name="l02671"></a>02671 
<a name="l02672"></a>02672     Q[2][5]  = qVup / betaVup;
<a name="l02673"></a>02673     Q[2][5] *= (1.0 - eVup)/betaVup - (1.0 - eVup2)/(2.0*betaVup);
<a name="l02674"></a>02674     Q[5][2]  = Q[2][5];
<a name="l02675"></a>02675 
<a name="l02676"></a>02676     Q[6][7]  = qClkDrift / betaClkDrift;
<a name="l02677"></a>02677     Q[6][7] *= (1.0 - eClkDrift)/betaClkDrift - (1.0 - eClkDrift2)/(2.0*betaClkDrift);
<a name="l02678"></a>02678     Q[7][6]  = Q[6][7];
<a name="l02679"></a>02679 
<a name="l02680"></a>02680     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02681"></a>02681   }
<a name="l02682"></a>02682 
<a name="l02683"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b55a5de11ab9a6a91bde4ac385a23bbe">02683</a>   
<a name="l02684"></a>02684   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b55a5de11ab9a6a91bde4ac385a23bbe">GNSS_Estimator::ComputeProcessNoiseMatrix_8StatePVGM_Float</a>(
<a name="l02685"></a>02685     <span class="keyword">const</span> <span class="keywordtype">double</span> dT,           <span class="comment">//!&lt; The change in time since the last update [s].</span>
<a name="l02686"></a>02686 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;Q,                 <span class="comment">//!&lt; The process noise matrix [(8 + nrAmb) x (8 + nrAmb)].</span>
<a name="l02687"></a>02687 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVn,       <span class="comment">//!&lt; The Gauss Markov beta for northing velocity [1/s].</span>
<a name="l02688"></a>02688 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVe,       <span class="comment">//!&lt; The Gauss Markov beta for easting velocity [1/s].</span>
<a name="l02689"></a>02689 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaVup,      <span class="comment">//!&lt; The Gauss Markov beta for up velocity [1/s].</span>
<a name="l02690"></a>02690 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> betaClkDrift, <span class="comment">//!&lt; The Gauss Markov beta for the clock bias [1/s].</span>
<a name="l02691"></a>02691 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qVn,          <span class="comment">//!&lt; The process noise value for northing velocity.</span>
<a name="l02692"></a>02692 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qVe,          <span class="comment">//!&lt; The process noise value for easting  velocity.</span>
<a name="l02693"></a>02693 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qVup,         <span class="comment">//!&lt; The process noise value for up       velocity.</span>
<a name="l02694"></a>02694 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> qClkDrift     <span class="comment">//!&lt; The process noise value for clock drift.</span>
<a name="l02695"></a>02695 <span class="comment"></span>    )
<a name="l02696"></a>02696   {
<a name="l02697"></a>02697     <span class="comment">//const double dT2 = dT*dT;</span>
<a name="l02698"></a>02698     <span class="keywordtype">double</span> eVn = 0;
<a name="l02699"></a>02699     <span class="keywordtype">double</span> eVe = 0;
<a name="l02700"></a>02700     <span class="keywordtype">double</span> eVup = 0;
<a name="l02701"></a>02701     <span class="keywordtype">double</span> eClkDrift = 0;
<a name="l02702"></a>02702     <span class="keywordtype">double</span> eVn2 = 0;
<a name="l02703"></a>02703     <span class="keywordtype">double</span> eVe2 = 0;
<a name="l02704"></a>02704     <span class="keywordtype">double</span> eVup2 = 0;
<a name="l02705"></a>02705     <span class="keywordtype">double</span> eClkDrift2 = 0;
<a name="l02706"></a>02706 
<a name="l02707"></a>02707     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 8 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.size());
<a name="l02708"></a>02708 
<a name="l02709"></a>02709     <span class="keywordflow">if</span>( Q.<a class="code" href="class_zenautics_1_1_matrix.html#ea99fa271d975e628a72f518958c746d" title="return no. of rows">nrows</a>() != u )
<a name="l02710"></a>02710     {
<a name="l02711"></a>02711       <span class="keywordflow">if</span>( !Q.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( u, u ) )
<a name="l02712"></a>02712       {
<a name="l02713"></a>02713         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02714"></a>02714       }
<a name="l02715"></a>02715     }
<a name="l02716"></a>02716     
<a name="l02717"></a>02717     eVn        = exp( -betaVn  * dT );
<a name="l02718"></a>02718     eVe        = exp( -betaVe  * dT );
<a name="l02719"></a>02719     eVup       = exp( -betaVup * dT );
<a name="l02720"></a>02720     eClkDrift  = exp( -betaClkDrift * dT );
<a name="l02721"></a>02721 
<a name="l02722"></a>02722     eVn2       = exp( -2.0 * betaVn  * dT );
<a name="l02723"></a>02723     eVe2       = exp( -2.0 * betaVe  * dT );
<a name="l02724"></a>02724     eVup2      = exp( -2.0 * betaVup * dT );
<a name="l02725"></a>02725     eClkDrift2 = exp( -2.0 * betaClkDrift * dT );
<a name="l02726"></a>02726 
<a name="l02727"></a>02727     Q[0][0]  = qVn / (betaVn*betaVn);
<a name="l02728"></a>02728     Q[0][0] *= dT - 2.0*(1.0 - eVn)/(betaVn) + (1.0 - eVn2)/(2.0*betaVn);
<a name="l02729"></a>02729 
<a name="l02730"></a>02730     Q[1][1]  = qVe / (betaVe*betaVe);
<a name="l02731"></a>02731     Q[1][1] *= dT - 2.0*(1.0 - eVe)/(betaVe) + (1.0 - eVe2)/(2.0*betaVe);
<a name="l02732"></a>02732 
<a name="l02733"></a>02733     Q[2][2]  = qVn / (betaVup*betaVup);
<a name="l02734"></a>02734     Q[2][2] *= dT - 2.0*(1.0 - eVup)/(betaVup) + (1.0 - eVup2)/(2.0*betaVup);
<a name="l02735"></a>02735 
<a name="l02736"></a>02736     Q[3][3]  = qVn * (1.0 - eVn2) / (2.0*betaVn);
<a name="l02737"></a>02737     
<a name="l02738"></a>02738     Q[4][4]  = qVe * (1.0 - eVe2) / (2.0*betaVe);
<a name="l02739"></a>02739 
<a name="l02740"></a>02740     Q[5][5]  = qVup * (1.0 - eVup2) / (2.0*betaVup);
<a name="l02741"></a>02741 
<a name="l02742"></a>02742     <span class="comment">// GDM_HACK added the 0.009</span>
<a name="l02743"></a>02743     <span class="comment">//Q[6][6]  = 0.3*dT + qClkDrift / (betaClkDrift*betaClkDrift);</span>
<a name="l02744"></a>02744     Q[6][6]  = qClkDrift / (betaClkDrift*betaClkDrift);
<a name="l02745"></a>02745     Q[6][6] *= dT - 2.0*(1.0 - eClkDrift)/(betaClkDrift) + (1.0 - eClkDrift2)/(2.0*betaClkDrift);
<a name="l02746"></a>02746     
<a name="l02747"></a>02747     Q[7][7]  = qClkDrift * (1.0 - eClkDrift2) / (2.0*betaClkDrift);
<a name="l02748"></a>02748 
<a name="l02749"></a>02749     Q[0][3]  = qVn / betaVn;
<a name="l02750"></a>02750     Q[0][3] *= (1.0 - eVn)/betaVn - (1.0 - eVn2)/(2.0*betaVn);
<a name="l02751"></a>02751     Q[3][0]  = Q[0][3];
<a name="l02752"></a>02752 
<a name="l02753"></a>02753     Q[1][4]  = qVe / betaVe;
<a name="l02754"></a>02754     Q[1][4] *= (1.0 - eVe)/betaVe - (1.0 - eVe2)/(2.0*betaVe);
<a name="l02755"></a>02755     Q[4][1]  = Q[1][4];
<a name="l02756"></a>02756 
<a name="l02757"></a>02757     Q[2][5]  = qVup / betaVup;
<a name="l02758"></a>02758     Q[2][5] *= (1.0 - eVup)/betaVup - (1.0 - eVup2)/(2.0*betaVup);
<a name="l02759"></a>02759     Q[5][2]  = Q[2][5];
<a name="l02760"></a>02760 
<a name="l02761"></a>02761     Q[6][7]  = qClkDrift / betaClkDrift;
<a name="l02762"></a>02762     Q[6][7] *= (1.0 - eClkDrift)/betaClkDrift - (1.0 - eClkDrift2)/(2.0*betaClkDrift);
<a name="l02763"></a>02763     Q[7][6]  = Q[6][7];
<a name="l02764"></a>02764 
<a name="l02765"></a>02765     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02766"></a>02766   }
<a name="l02767"></a>02767 
<a name="l02768"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#cdd7b4c1d5caf5aa6a048bf18f7c0b3f">02768</a> 
<a name="l02769"></a>02769   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#cdd7b4c1d5caf5aa6a048bf18f7c0b3f">GNSS_Estimator::PredictAhead_8StatePVGM</a>(
<a name="l02770"></a>02770     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData, <span class="comment">//!&lt; The receiver data.</span>
<a name="l02771"></a>02771 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dT,     <span class="comment">//!&lt; The change in time since the last update [s].</span>
<a name="l02772"></a>02772 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;T,           <span class="comment">//!&lt; The transition matrix                                 [8 x 8] (output).</span>
<a name="l02773"></a>02773 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;Q,           <span class="comment">//!&lt; The process noise matrix                              [8 x 8] (output).</span>
<a name="l02774"></a>02774 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P            <span class="comment">//!&lt; The state variance covariance matrix                  [8 x 8] (input/output).      </span>
<a name="l02775"></a>02775 <span class="comment"></span>    )
<a name="l02776"></a>02776   {
<a name="l02777"></a>02777     <span class="keywordtype">double</span> M = 0; <span class="comment">// The meridian radius of curvature.</span>
<a name="l02778"></a>02778     <span class="keywordtype">double</span> N = 0; <span class="comment">// The prime vertical radius of curvature.</span>
<a name="l02779"></a>02779     <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l02780"></a>02780     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMat;
<a name="l02781"></a>02781     <span class="keywordtype">double</span> lat = 0;
<a name="l02782"></a>02782     <span class="keywordtype">double</span> h = 0;
<a name="l02783"></a>02783 
<a name="l02784"></a>02784     <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>(
<a name="l02785"></a>02785       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l02786"></a>02786       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l02787"></a>02787       &amp;M );
<a name="l02788"></a>02788 
<a name="l02789"></a>02789     <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l02790"></a>02790       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l02791"></a>02791       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l02792"></a>02792       &amp;N );
<a name="l02793"></a>02793 
<a name="l02794"></a>02794     <span class="comment">// Get the transition Matrix</span>
<a name="l02795"></a>02795     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e0a326c17c9c6e39368f7ebc9aa43ab1">ComputeTransitionMatrix_8StatePVGM</a>(
<a name="l02796"></a>02796       dT,
<a name="l02797"></a>02797       T,
<a name="l02798"></a>02798       m_betaVn,
<a name="l02799"></a>02799       m_betaVe,
<a name="l02800"></a>02800       m_betaVup,
<a name="l02801"></a>02801       m_betaClkDrift );
<a name="l02802"></a>02802     <span class="keywordflow">if</span>( result == <span class="keyword">false</span> )
<a name="l02803"></a>02803       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02804"></a>02804 
<a name="l02805"></a>02805     <span class="comment">// Set the process noise Matrix</span>
<a name="l02806"></a>02806     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#45ee367eb2b37a2e0586d55e7b2afdf1">ComputeProcessNoiseMatrix_8StatePVGM</a>(
<a name="l02807"></a>02807       dT,
<a name="l02808"></a>02808       Q,
<a name="l02809"></a>02809       m_betaVn,
<a name="l02810"></a>02810       m_betaVe,
<a name="l02811"></a>02811       m_betaVup,
<a name="l02812"></a>02812       m_betaClkDrift,
<a name="l02813"></a>02813       m_qVn,
<a name="l02814"></a>02814       m_qVe,
<a name="l02815"></a>02815       m_qVup,
<a name="l02816"></a>02816       m_qClkDrift );
<a name="l02817"></a>02817     <span class="keywordflow">if</span>( result == <span class="keyword">false</span> )
<a name="l02818"></a>02818       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02819"></a>02819 
<a name="l02820"></a>02820 
<a name="l02821"></a>02821     <span class="comment"></span>
<a name="l02822"></a>02822 <span class="comment">    ////</span>
<a name="l02823"></a>02823 <span class="comment"></span>    <span class="comment">// predict the states ahead    </span>
<a name="l02824"></a>02824     
<a name="l02825"></a>02825     <span class="comment">// for use of use</span>
<a name="l02826"></a>02826     lat = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>;
<a name="l02827"></a>02827     h   = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l02828"></a>02828     
<a name="l02829"></a>02829     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>  += T[0][3] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a> / (M+h);  <span class="comment">// for small dT, this should be: lat += dT * vn / M</span>
<a name="l02830"></a>02830     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a> += T[1][4] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a> / ((N+h)*cos(lat));  <span class="comment">// for small dT, this should be: lon += dT * ve / ((N+h)*cos(lat))</span>
<a name="l02831"></a>02831     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>    += T[2][5] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a>;  <span class="comment">// for small dT, this should be: hgt += dT * vup    </span>
<a name="l02832"></a>02832     
<a name="l02833"></a>02833     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a>  *= T[3][3];  <span class="comment">// for small dT, this should be vn = vn    </span>
<a name="l02834"></a>02834     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a>  *= T[4][4];  <span class="comment">// for small dT, this should be ve = ve</span>
<a name="l02835"></a>02835     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a> *= T[5][5];  <span class="comment">// for small dT, this should be vup = vup</span>
<a name="l02836"></a>02836 
<a name="l02837"></a>02837     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a> += T[6][7] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>;  <span class="comment">// for small dT, this should be: clk += dT * clkrate</span>
<a name="l02838"></a>02838     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>  *= T[7][7];  <span class="comment">// for small dT, this should be clkdrift = clkdrift</span>
<a name="l02839"></a>02839 
<a name="l02840"></a>02840     <span class="comment">//</span><span class="comment"></span>
<a name="l02841"></a>02841 <span class="comment">    ////</span>
<a name="l02842"></a>02842 <span class="comment"></span>
<a name="l02843"></a>02843 <span class="comment"></span>
<a name="l02844"></a>02844 <span class="comment">    ////</span>
<a name="l02845"></a>02845 <span class="comment"></span>    <span class="comment">// predict the new state variance/covariance</span>
<a name="l02846"></a>02846 
<a name="l02847"></a>02847     <span class="comment">// It can be done this way:</span>
<a name="l02848"></a>02848     <span class="comment">// P = T * P * T.transpose() + Q;</span>
<a name="l02849"></a>02849     <span class="comment">// but the following is more efficient</span>
<a name="l02850"></a>02850     tmpMat = T;
<a name="l02851"></a>02851     <span class="keywordflow">if</span>( !tmpMat.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>() )
<a name="l02852"></a>02852       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02853"></a>02853 
<a name="l02854"></a>02854     <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#a9d8e47f2c3aceb214ce69d7c472909f" title="Pre-Multiply this matrix by B. A = B*A, inplace.">Inplace_PreMultiply</a>( T ) )
<a name="l02855"></a>02855       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02856"></a>02856 
<a name="l02857"></a>02857     <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( tmpMat ) )
<a name="l02858"></a>02858       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02859"></a>02859 
<a name="l02860"></a>02860     <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#79be5cbbc0bd69048200d2713a211f90" title="Add matrix B to this matrix inplace. A += B, inplace.">Inplace_Add</a>( Q ) )
<a name="l02861"></a>02861       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02862"></a>02862     <span class="comment">//</span><span class="comment"></span>
<a name="l02863"></a>02863 <span class="comment">    ////</span>
<a name="l02864"></a>02864 <span class="comment"></span>
<a name="l02865"></a>02865     <span class="keywordflow">return</span> <span class="keyword">true</span>;    
<a name="l02866"></a>02866   }
<a name="l02867"></a>02867 
<a name="l02868"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#56a5d9a80462c6aa673c52e94561b83a">02868</a> 
<a name="l02869"></a>02869   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#56a5d9a80462c6aa673c52e94561b83a">GNSS_Estimator::PredictAhead_8StatePVGM_Float</a>(
<a name="l02870"></a>02870     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> &amp;rxData, <span class="comment">//!&lt; The receiver data.</span>
<a name="l02871"></a>02871 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dT,     <span class="comment">//!&lt; The change in time since the last update [s].</span>
<a name="l02872"></a>02872 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;T,           <span class="comment">//!&lt; The transition matrix                                 [(8 + nrAmb) x (8 + nrAmb)] (output).</span>
<a name="l02873"></a>02873 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;Q,           <span class="comment">//!&lt; The process noise matrix                              [(8 + nrAmb) x (8 + nrAmb)] (output).</span>
<a name="l02874"></a>02874 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P            <span class="comment">//!&lt; The state variance covariance matrix                  [(8 + nrAmb) x (8 + nrAmb)] (input/output).      </span>
<a name="l02875"></a>02875 <span class="comment"></span>    )
<a name="l02876"></a>02876   {
<a name="l02877"></a>02877     <span class="keywordtype">double</span> M = 0; <span class="comment">// The meridian radius of curvature.</span>
<a name="l02878"></a>02878     <span class="keywordtype">double</span> N = 0; <span class="comment">// The prime vertical radius of curvature.</span>
<a name="l02879"></a>02879     <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l02880"></a>02880     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMat;
<a name="l02881"></a>02881     <span class="keywordtype">double</span> lat = 0;
<a name="l02882"></a>02882     <span class="keywordtype">double</span> h = 0;
<a name="l02883"></a>02883 
<a name="l02884"></a>02884     <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>(
<a name="l02885"></a>02885       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l02886"></a>02886       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l02887"></a>02887       &amp;M );
<a name="l02888"></a>02888 
<a name="l02889"></a>02889     <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l02890"></a>02890       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l02891"></a>02891       rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>,
<a name="l02892"></a>02892       &amp;N );
<a name="l02893"></a>02893 
<a name="l02894"></a>02894     <span class="comment">// Get the transition Matrix</span>
<a name="l02895"></a>02895     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6b021d1efba0203fff9992400f4891c5">ComputeTransitionMatrix_8StatePVGM_Float</a>(
<a name="l02896"></a>02896       dT,
<a name="l02897"></a>02897       T,
<a name="l02898"></a>02898       m_betaVn,
<a name="l02899"></a>02899       m_betaVe,
<a name="l02900"></a>02900       m_betaVup,
<a name="l02901"></a>02901       m_betaClkDrift );
<a name="l02902"></a>02902     <span class="keywordflow">if</span>( result == <span class="keyword">false</span> )
<a name="l02903"></a>02903       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02904"></a>02904 
<a name="l02905"></a>02905     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"T"</span>, T );
<a name="l02906"></a>02906 
<a name="l02907"></a>02907     <span class="comment">// Set the process noise Matrix</span>
<a name="l02908"></a>02908     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b55a5de11ab9a6a91bde4ac385a23bbe">ComputeProcessNoiseMatrix_8StatePVGM_Float</a>(
<a name="l02909"></a>02909       dT,
<a name="l02910"></a>02910       Q,
<a name="l02911"></a>02911       m_betaVn,
<a name="l02912"></a>02912       m_betaVe,
<a name="l02913"></a>02913       m_betaVup,
<a name="l02914"></a>02914       m_betaClkDrift,
<a name="l02915"></a>02915       m_qVn,
<a name="l02916"></a>02916       m_qVe,
<a name="l02917"></a>02917       m_qVup,
<a name="l02918"></a>02918       m_qClkDrift );
<a name="l02919"></a>02919     <span class="keywordflow">if</span>( result == <span class="keyword">false</span> )
<a name="l02920"></a>02920       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02921"></a>02921 
<a name="l02922"></a>02922     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"Q"</span>, Q );
<a name="l02923"></a>02923     <span class="comment"></span>
<a name="l02924"></a>02924 <span class="comment">    ////</span>
<a name="l02925"></a>02925 <span class="comment"></span>    <span class="comment">// predict the states ahead    </span>
<a name="l02926"></a>02926     
<a name="l02927"></a>02927     <span class="comment">// for use of use</span>
<a name="l02928"></a>02928     lat = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>;
<a name="l02929"></a>02929     h   = rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l02930"></a>02930     
<a name="l02931"></a>02931     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>  += T[0][3] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a> / (M+h);  <span class="comment">// for small dT, this should be: lat += dT * vn / M</span>
<a name="l02932"></a>02932     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a> += T[1][4] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a> / ((N+h)*cos(lat));  <span class="comment">// for small dT, this should be: lon += dT * ve / ((N+h)*cos(lat))</span>
<a name="l02933"></a>02933     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>    += T[2][5] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a>;  <span class="comment">// for small dT, this should be: hgt += dT * vup    </span>
<a name="l02934"></a>02934     
<a name="l02935"></a>02935     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a>  *= T[3][3];  <span class="comment">// for small dT, this should be vn = vn    </span>
<a name="l02936"></a>02936     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a>  *= T[4][4];  <span class="comment">// for small dT, this should be ve = ve</span>
<a name="l02937"></a>02937     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a> *= T[5][5];  <span class="comment">// for small dT, this should be vup = vup</span>
<a name="l02938"></a>02938 
<a name="l02939"></a>02939     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a> += T[6][7] * rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>;  <span class="comment">// for small dT, this should be: clk += dT * clkrate</span>
<a name="l02940"></a>02940     rxData.<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>  *= T[7][7];  <span class="comment">// for small dT, this should be clkdrift = clkdrift</span>
<a name="l02941"></a>02941 
<a name="l02942"></a>02942     <span class="comment">//</span><span class="comment"></span>
<a name="l02943"></a>02943 <span class="comment">    ////</span>
<a name="l02944"></a>02944 <span class="comment"></span>
<a name="l02945"></a>02945 <span class="comment"></span>
<a name="l02946"></a>02946 <span class="comment">    ////</span>
<a name="l02947"></a>02947 <span class="comment"></span>    <span class="comment">// predict the new state variance/covariance</span>
<a name="l02948"></a>02948 
<a name="l02949"></a>02949     <span class="comment">// It can be done this way:</span>
<a name="l02950"></a>02950     <span class="comment">// P = T * P * T.transpose() + Q;</span>
<a name="l02951"></a>02951     <span class="comment">// but the following is more efficient</span>
<a name="l02952"></a>02952     tmpMat = T;
<a name="l02953"></a>02953     <span class="keywordflow">if</span>( !tmpMat.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>() )
<a name="l02954"></a>02954       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02955"></a>02955 
<a name="l02956"></a>02956     <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#a9d8e47f2c3aceb214ce69d7c472909f" title="Pre-Multiply this matrix by B. A = B*A, inplace.">Inplace_PreMultiply</a>( T ) )
<a name="l02957"></a>02957       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02958"></a>02958 
<a name="l02959"></a>02959     <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( tmpMat ) )
<a name="l02960"></a>02960       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02961"></a>02961 
<a name="l02962"></a>02962     <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#79be5cbbc0bd69048200d2713a211f90" title="Add matrix B to this matrix inplace. A += B, inplace.">Inplace_Add</a>( Q ) )
<a name="l02963"></a>02963       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02964"></a>02964     <span class="comment">//</span><span class="comment"></span>
<a name="l02965"></a>02965 <span class="comment">    ////</span>
<a name="l02966"></a>02966 <span class="comment"></span>
<a name="l02967"></a>02967     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"P"</span>, P );
<a name="l02968"></a>02968 
<a name="l02969"></a>02969     <span class="keywordflow">return</span> <span class="keyword">true</span>;    
<a name="l02970"></a>02970   }
<a name="l02971"></a>02971 
<a name="l02972"></a>02972 
<a name="l02973"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#286a380dfdb7472d35a875916189da92">02973</a> 
<a name="l02974"></a>02974   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#286a380dfdb7472d35a875916189da92" title="Initialize the state variance-covariance matrix for the 8 state PV Gauss Markov model...">GNSS_Estimator::InitializeStateVarianceCovariance_8StatePVGM</a>(
<a name="l02975"></a>02975     <span class="keyword">const</span> <span class="keywordtype">double</span> std_lat,        <span class="comment">//!&lt; The standard deviation uncertainty in the latitude [m].</span>
<a name="l02976"></a>02976 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_lon,        <span class="comment">//!&lt; The standard deviation uncertainty in the longitude [m]. </span>
<a name="l02977"></a>02977 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_hgt,        <span class="comment">//!&lt; The standard deviation uncertainty in the height [m].</span>
<a name="l02978"></a>02978 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_vn,         <span class="comment">//!&lt; The standard deviation uncertainty in the northing velocity [m/s].</span>
<a name="l02979"></a>02979 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_ve,         <span class="comment">//!&lt; The standard deviation uncertainty in the easting velocity [m/s].</span>
<a name="l02980"></a>02980 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_vup,        <span class="comment">//!&lt; The standard deviation uncertainty in the up velocity [m/s].</span>
<a name="l02981"></a>02981 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_clk,        <span class="comment">//!&lt; The standard deviation uncertainty in the clock offset [m].</span>
<a name="l02982"></a>02982 <span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> std_clkdrift,   <span class="comment">//!&lt; The standard deviation uncertainty in the clock drift [m/s].    </span>
<a name="l02983"></a>02983 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P                    <span class="comment">//!&lt; The variance covariance of the states [8x8].</span>
<a name="l02984"></a>02984 <span class="comment"></span>    )
<a name="l02985"></a>02985   {
<a name="l02986"></a>02986     <span class="keywordflow">if</span>( P.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() != 8 || P.<a class="code" href="class_zenautics_1_1_matrix.html#d93c7061e466745efb1a43377a3e2299" title="return no. of cols">GetNrCols</a>() != 8 )
<a name="l02987"></a>02987     {
<a name="l02988"></a>02988       <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( 8, 8 ) )
<a name="l02989"></a>02989       {
<a name="l02990"></a>02990         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02991"></a>02991       }
<a name="l02992"></a>02992     }
<a name="l02993"></a>02993 
<a name="l02994"></a>02994     P[0][0] = std_lat*std_lat;
<a name="l02995"></a>02995     P[1][1] = std_lon*std_lon;
<a name="l02996"></a>02996     P[2][2] = std_hgt*std_hgt;
<a name="l02997"></a>02997     P[3][3] = std_vn*std_vn;
<a name="l02998"></a>02998     P[4][4] = std_ve*std_ve;
<a name="l02999"></a>02999     P[5][5] = std_vup*std_vup;
<a name="l03000"></a>03000     P[6][6] = std_clk*std_clk;
<a name="l03001"></a>03001     P[7][7] = std_clkdrift*std_clkdrift;
<a name="l03002"></a>03002 
<a name="l03003"></a>03003     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"P"</span>, P );
<a name="l03004"></a>03004 
<a name="l03005"></a>03005     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03006"></a>03006   }
<a name="l03007"></a>03007 
<a name="l03008"></a>03008 
<a name="l03009"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d008f26fa7972d3b73dcd6d8e51aa9d8">03009</a> 
<a name="l03010"></a>03010   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d008f26fa7972d3b73dcd6d8e51aa9d8">GNSS_Estimator::Kalman_Update_8StatePVGM</a>(
<a name="l03011"></a>03011     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,      <span class="comment">//!&lt; A pointer to the rover receiver data. This must be a valid pointer.</span>
<a name="l03012"></a>03012 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,  <span class="comment">//!&lt; A pointer to the reference receiver data if available. NULL if not available.</span>
<a name="l03013"></a>03013 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P                 <span class="comment">//!&lt; The variance-covariance of the states.</span>
<a name="l03014"></a>03014 <span class="comment"></span>    )
<a name="l03015"></a>03015   {
<a name="l03016"></a>03016     <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l03017"></a>03017     <span class="keywordtype">unsigned</span> i = 0;
<a name="l03018"></a>03018     <span class="keywordtype">unsigned</span> j = 0;
<a name="l03019"></a>03019     <span class="keywordtype">unsigned</span> n = 0;
<a name="l03020"></a>03020     <span class="keywordtype">unsigned</span> nrP = 0;           <span class="comment">// The number of valid psr.</span>
<a name="l03021"></a>03021     <span class="keywordtype">unsigned</span> nrP_base = 0;      <span class="comment">// The number of valid psr for the reference station.</span>
<a name="l03022"></a>03022     <span class="keywordtype">unsigned</span> nrD = 0;           <span class="comment">// The number of valid Doppler.</span>
<a name="l03023"></a>03023     <span class="keywordtype">unsigned</span> nrD_base = 0;      <span class="comment">// The number of valid Doppler for the reference station.</span>
<a name="l03024"></a>03024     <span class="keywordtype">unsigned</span> nrValidEph = 0;    <span class="comment">// The number of valid ephemeris.</span>
<a name="l03025"></a>03025     <span class="keywordtype">unsigned</span> nrDifferentialPsr = 0;     <span class="comment">// The number of differential psr.</span>
<a name="l03026"></a>03026     <span class="keywordtype">unsigned</span> nrDifferentialDoppler = 0; <span class="comment">// The number of differential Doppler.</span>
<a name="l03027"></a>03027     <span class="keywordtype">bool</span> isDifferential = <span class="keyword">false</span>;
<a name="l03028"></a>03028 
<a name="l03029"></a>03029     <span class="keywordtype">double</span> lat = 0;
<a name="l03030"></a>03030     <span class="keywordtype">double</span> lon = 0;
<a name="l03031"></a>03031     <span class="keywordtype">double</span> hgt = 0;
<a name="l03032"></a>03032     <span class="keywordtype">double</span> clk = 0;
<a name="l03033"></a>03033     <span class="keywordtype">double</span> vn = 0;
<a name="l03034"></a>03034     <span class="keywordtype">double</span> ve = 0;
<a name="l03035"></a>03035     <span class="keywordtype">double</span> vup = 0;
<a name="l03036"></a>03036     <span class="keywordtype">double</span> clkdrift = 0;
<a name="l03037"></a>03037     <span class="keywordtype">double</span> M = 0;   <span class="comment">// The computed meridian radius of curvature [m].</span>
<a name="l03038"></a>03038     <span class="keywordtype">double</span> N = 0;   <span class="comment">// The computed prime vertical radius of curvature [m].</span>
<a name="l03039"></a>03039 
<a name="l03040"></a>03040     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_p;
<a name="l03041"></a>03041     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_v;
<a name="l03042"></a>03042     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H;
<a name="l03043"></a>03043     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> Ht;
<a name="l03044"></a>03044     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_p;
<a name="l03045"></a>03045     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_v;
<a name="l03046"></a>03046     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R;
<a name="l03047"></a>03047     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_p;
<a name="l03048"></a>03048     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_v;
<a name="l03049"></a>03049     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w;
<a name="l03050"></a>03050     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> K;
<a name="l03051"></a>03051     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMat;
<a name="l03052"></a>03052     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMatP;
<a name="l03053"></a>03053     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> dx(8);
<a name="l03054"></a>03054     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> I;
<a name="l03055"></a>03055 
<a name="l03056"></a>03056     
<a name="l03057"></a>03057     dx.<a class="code" href="class_zenautics_1_1_matrix.html#31f74d047657ee91ed3160a5cca797ce" title="Zero the entire matrix.">Zero</a>();
<a name="l03058"></a>03058     
<a name="l03059"></a>03059     <span class="comment">// Store the current input pvt as the previous pvt since we are updating.</span>
<a name="l03060"></a>03060     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>;
<a name="l03061"></a>03061 
<a name="l03062"></a>03062     lat = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>;
<a name="l03063"></a>03063     lon = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>;
<a name="l03064"></a>03064     hgt = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l03065"></a>03065     clk = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a>;
<a name="l03066"></a>03066     vn  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a>;
<a name="l03067"></a>03067     ve  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a>;
<a name="l03068"></a>03068     vup = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a>;
<a name="l03069"></a>03069     clkdrift = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>; 
<a name="l03070"></a>03070 
<a name="l03071"></a>03071 
<a name="l03072"></a>03072     <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l03073"></a>03073       isDifferential = <span class="keyword">true</span>;
<a name="l03074"></a>03074 
<a name="l03075"></a>03075 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03076"></a>03076 <span class="preprocessor"></span>    rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> = 1;
<a name="l03077"></a>03077 <span class="preprocessor">#else</span>
<a name="l03078"></a>03078 <span class="preprocessor"></span>    rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> = 0;
<a name="l03079"></a>03079 <span class="preprocessor">#endif</span>
<a name="l03080"></a>03080 <span class="preprocessor"></span>    
<a name="l03081"></a>03081     <span class="comment"></span>
<a name="l03082"></a>03082 <span class="comment">    ////</span>
<a name="l03083"></a>03083 <span class="comment"></span>    <span class="comment">// Perform operations specific to the rover.</span>
<a name="l03084"></a>03084 
<a name="l03085"></a>03085     <span class="comment">// Update the receiver time information (UTC and day of year)</span>
<a name="l03086"></a>03086     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxData );
<a name="l03087"></a>03087     <span class="keywordflow">if</span>( !result )
<a name="l03088"></a>03088       <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l03089"></a>03089     <span class="keywordflow">if</span>( isDifferential )
<a name="l03090"></a>03090     {
<a name="l03091"></a>03091       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxBaseData );
<a name="l03092"></a>03092       <span class="keywordflow">if</span>( !result )
<a name="l03093"></a>03093         <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l03094"></a>03094     }
<a name="l03095"></a>03095 
<a name="l03096"></a>03096     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b65e9ee3b9983ceb2583fd21982ddbe8" title="Determine the satellite clock corrections, positions, and velocities for the rover...">DetermineSatellitePVT_GPSL1</a>( rxData, rxBaseData, nrValidEph );
<a name="l03097"></a>03097     <span class="keywordflow">if</span>( !result )
<a name="l03098"></a>03098       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03099"></a>03099 
<a name="l03100"></a>03100 
<a name="l03101"></a>03101     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxData );
<a name="l03102"></a>03102     <span class="keywordflow">if</span>( !result )
<a name="l03103"></a>03103       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03104"></a>03104     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxData, nrP );
<a name="l03105"></a>03105     <span class="keywordflow">if</span>( !result )
<a name="l03106"></a>03106       <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l03107"></a>03107     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxData, nrD );
<a name="l03108"></a>03108     <span class="keywordflow">if</span>( !result )
<a name="l03109"></a>03109       <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l03110"></a>03110     
<a name="l03111"></a>03111 
<a name="l03112"></a>03112     <span class="keywordflow">if</span>( isDifferential )
<a name="l03113"></a>03113     {
<a name="l03114"></a>03114       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxBaseData );
<a name="l03115"></a>03115       <span class="keywordflow">if</span>( !result )
<a name="l03116"></a>03116         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03117"></a>03117       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxBaseData, nrP_base );
<a name="l03118"></a>03118       <span class="keywordflow">if</span>( !result )
<a name="l03119"></a>03119         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03120"></a>03120       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxBaseData, nrD_base );
<a name="l03121"></a>03121       <span class="keywordflow">if</span>( !result )
<a name="l03122"></a>03122         <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l03123"></a>03123 
<a name="l03124"></a>03124 
<a name="l03125"></a>03125       <span class="comment">// When in differential mode, only differntial measurements will be used</span>
<a name="l03126"></a>03126       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0325ac1ddd31befdbfc2a8b67e97c69c" title="Determine the differential GPS L1 pseudorange measurements.">DetermineDifferentialPseudorangeMeasurementsForThePositionSolution_GPSL1</a>(
<a name="l03127"></a>03127         rxData,
<a name="l03128"></a>03128         rxBaseData,
<a name="l03129"></a>03129         <span class="keyword">true</span>,
<a name="l03130"></a>03130         nrDifferentialPsr );
<a name="l03131"></a>03131       <span class="keywordflow">if</span>( !result )
<a name="l03132"></a>03132         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03133"></a>03133 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03134"></a>03134 <span class="preprocessor"></span>      nrP = nrDifferentialPsr+3;
<a name="l03135"></a>03135 <span class="preprocessor">#else</span>
<a name="l03136"></a>03136 <span class="preprocessor"></span>      nrP = nrDifferentialPsr;
<a name="l03137"></a>03137 <span class="preprocessor">#endif</span>
<a name="l03138"></a>03138 <span class="preprocessor"></span>
<a name="l03139"></a>03139       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#92db9d6064dda154b675f62f07b53573" title="Determine the differential GPS L1 Doppler measurements.">DetermineDifferentialDopplerMeasurementsForTheVelocitySolution_GPSL1</a>(
<a name="l03140"></a>03140         rxData,
<a name="l03141"></a>03141         rxBaseData,
<a name="l03142"></a>03142         <span class="keyword">true</span>,
<a name="l03143"></a>03143         nrDifferentialDoppler );
<a name="l03144"></a>03144       <span class="keywordflow">if</span>( !result )
<a name="l03145"></a>03145         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03146"></a>03146 
<a name="l03147"></a>03147 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03148"></a>03148 <span class="preprocessor"></span>      nrD = nrDifferentialPsr+3;
<a name="l03149"></a>03149 <span class="preprocessor">#else</span>
<a name="l03150"></a>03150 <span class="preprocessor"></span>      nrD = nrDifferentialPsr;
<a name="l03151"></a>03151 <span class="preprocessor">#endif</span>
<a name="l03152"></a>03152 <span class="preprocessor"></span>    }
<a name="l03153"></a>03153 
<a name="l03154"></a>03154     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6" title="Determine the design matrix for the GPS L1 position solution based on pseudroange...">DetermineDesignMatrixForThePositionSolution_GPSL1</a>(
<a name="l03155"></a>03155       *rxData,
<a name="l03156"></a>03156       nrP,
<a name="l03157"></a>03157       H_p );
<a name="l03158"></a>03158     <span class="keywordflow">if</span>( !result )
<a name="l03159"></a>03159       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03160"></a>03160     
<a name="l03161"></a>03161     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19" title="Determine the design matrix for the GPS L1 velocity solution based on Doppler measurements...">DetermineDesignMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l03162"></a>03162       *rxData,
<a name="l03163"></a>03163       nrD,
<a name="l03164"></a>03164       H_v );
<a name="l03165"></a>03165     <span class="keywordflow">if</span>( !result )
<a name="l03166"></a>03166       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03167"></a>03167 
<a name="l03168"></a>03168 
<a name="l03169"></a>03169     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a0c642977c8e788817fbde37909533d3" title="Determine the measurement variance-coariance matrix for the GPS L1 position solution...">DetermineMeasurementVarianceCovarianceMatrixForThePositionSolution_GPSL1</a>(
<a name="l03170"></a>03170       *rxData,
<a name="l03171"></a>03171       nrP,
<a name="l03172"></a>03172       R_p );
<a name="l03173"></a>03173     <span class="keywordflow">if</span>( !result )
<a name="l03174"></a>03174       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03175"></a>03175 
<a name="l03176"></a>03176 
<a name="l03177"></a>03177     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#981212395e812c74a9ce542c2b7187cd" title="Determine the measurement variance-covariance matrix for the GPS L1 velocity solution...">DetermineMeasurementVarianceCovarianceMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l03178"></a>03178       *rxData,
<a name="l03179"></a>03179       nrD,
<a name="l03180"></a>03180       R_v );
<a name="l03181"></a>03181     <span class="keywordflow">if</span>( !result )
<a name="l03182"></a>03182       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03183"></a>03183 
<a name="l03184"></a>03184 
<a name="l03185"></a>03185     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">DeterminePseudorangeMisclosures_GPSL1</a>(
<a name="l03186"></a>03186       rxData,
<a name="l03187"></a>03187       rxBaseData,
<a name="l03188"></a>03188       nrP,
<a name="l03189"></a>03189       w_p );
<a name="l03190"></a>03190     <span class="keywordflow">if</span>( !result )
<a name="l03191"></a>03191       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03192"></a>03192 
<a name="l03193"></a>03193     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">DetermineDopplerMisclosures_GPSL1</a>(
<a name="l03194"></a>03194       rxData,
<a name="l03195"></a>03195       rxBaseData,
<a name="l03196"></a>03196       nrD,
<a name="l03197"></a>03197       w_v );
<a name="l03198"></a>03198     <span class="keywordflow">if</span>( !result )
<a name="l03199"></a>03199       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03200"></a>03200 
<a name="l03201"></a>03201     <span class="comment">// Form the combined design matrix.</span>
<a name="l03202"></a>03202     n = H_p.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() + H_v.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>();
<a name="l03203"></a>03203 
<a name="l03204"></a>03204     result = H.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 8 );
<a name="l03205"></a>03205     <span class="keywordflow">if</span>( !result )
<a name="l03206"></a>03206       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03207"></a>03207 
<a name="l03208"></a>03208     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03209"></a>03209     {
<a name="l03210"></a>03210       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03211"></a>03211       {
<a name="l03212"></a>03212         <span class="keywordflow">for</span>( j = 0; j &lt; 3; j++ )
<a name="l03213"></a>03213           H[i][j] = H_p[i][j];
<a name="l03214"></a>03214 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03215"></a>03215 <span class="preprocessor"></span>        <span class="keywordflow">if</span>( i &lt; nrP-3 )
<a name="l03216"></a>03216           H[i][6] = 1.0;
<a name="l03217"></a>03217 <span class="preprocessor">#else</span>
<a name="l03218"></a>03218 <span class="preprocessor"></span>        H[i][6] = 1.0;
<a name="l03219"></a>03219 <span class="preprocessor">#endif</span>
<a name="l03220"></a>03220 <span class="preprocessor"></span>      }
<a name="l03221"></a>03221       <span class="keywordflow">else</span>
<a name="l03222"></a>03222       {
<a name="l03223"></a>03223         <span class="keywordflow">for</span>( j = 0; j &lt; 3; j++ )
<a name="l03224"></a>03224           H[i][j+3] = H_v[i-nrP][j];
<a name="l03225"></a>03225 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03226"></a>03226 <span class="preprocessor"></span>        <span class="keywordflow">if</span>( i &lt; n-3 )
<a name="l03227"></a>03227           H[i][7] = 1.0;
<a name="l03228"></a>03228 <span class="preprocessor">#else</span>
<a name="l03229"></a>03229 <span class="preprocessor"></span>        H[i][7] = 1.0;
<a name="l03230"></a>03230 <span class="preprocessor">#endif</span>
<a name="l03231"></a>03231 <span class="preprocessor"></span>      }
<a name="l03232"></a>03232     }
<a name="l03233"></a>03233     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"H"</span>, H );
<a name="l03234"></a>03234     
<a name="l03235"></a>03235     
<a name="l03236"></a>03236     result = R.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, n );
<a name="l03237"></a>03237     <span class="keywordflow">if</span>( !result )
<a name="l03238"></a>03238       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03239"></a>03239 
<a name="l03240"></a>03240     <span class="comment">// Form the combined measurement variance-covariance matrix.</span>
<a name="l03241"></a>03241     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03242"></a>03242     {
<a name="l03243"></a>03243       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03244"></a>03244       {
<a name="l03245"></a>03245         <span class="keywordflow">for</span>( j = 0; j &lt; nrP; j++ )
<a name="l03246"></a>03246           R[i][j] = R_p[i][j];
<a name="l03247"></a>03247       }
<a name="l03248"></a>03248       <span class="keywordflow">else</span>
<a name="l03249"></a>03249       {
<a name="l03250"></a>03250         <span class="keywordflow">for</span>( j = 0; j &lt; nrD; j++ )
<a name="l03251"></a>03251           R[i][j+nrD] = R_v[i-nrP][j];
<a name="l03252"></a>03252       }
<a name="l03253"></a>03253     }
<a name="l03254"></a>03254     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"R"</span>, R );
<a name="l03255"></a>03255 
<a name="l03256"></a>03256 
<a name="l03257"></a>03257     <span class="comment">// Form the combined misclosure vector.</span>
<a name="l03258"></a>03258     result = w.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 1 );
<a name="l03259"></a>03259     <span class="keywordflow">if</span>( !result )
<a name="l03260"></a>03260       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03261"></a>03261     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03262"></a>03262     {
<a name="l03263"></a>03263       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03264"></a>03264       {
<a name="l03265"></a>03265         w[i] = w_p[i];
<a name="l03266"></a>03266       }
<a name="l03267"></a>03267       <span class="keywordflow">else</span>
<a name="l03268"></a>03268       {
<a name="l03269"></a>03269         w[i] = w_v[i-nrP];
<a name="l03270"></a>03270       }
<a name="l03271"></a>03271     }
<a name="l03272"></a>03272 
<a name="l03273"></a>03273     
<a name="l03274"></a>03274     <span class="comment">// Form H transposed.</span>
<a name="l03275"></a>03275     Ht = H;
<a name="l03276"></a>03276     result = Ht.<a class="code" href="class_zenautics_1_1_matrix.html#3e28be63b2a0bc17fe0c009a0a7fc520" title="Transpose the matrix as an inplace operation.">Inplace_Transpose</a>();
<a name="l03277"></a>03277     <span class="keywordflow">if</span>( !result )
<a name="l03278"></a>03278       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03279"></a>03279 
<a name="l03280"></a>03280 
<a name="l03281"></a>03281     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"H"</span>, H );
<a name="l03282"></a>03282     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"R"</span>, R );
<a name="l03283"></a>03283     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"w"</span>, w );
<a name="l03284"></a>03284     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"P"</span>, P );
<a name="l03285"></a>03285 
<a name="l03286"></a>03286     <span class="comment">// Compute the Kalman gain matrix.</span>
<a name="l03287"></a>03287     <span class="comment">// K = P*Ht*(H*P*Ht+R)^-1</span>
<a name="l03288"></a>03288     <span class="comment">// do (H*P*Ht+R)^-1 first</span>
<a name="l03289"></a>03289     tmpMat = H*P*Ht + R;
<a name="l03290"></a>03290     result = tmpMat.<a class="code" href="class_zenautics_1_1_matrix.html#dc1d6447f68b5639d2845f4e7d660888" title="Computes the inplace inverse of the matrix.">Inplace_Invert</a>();
<a name="l03291"></a>03291     <span class="keywordflow">if</span>( !result )
<a name="l03292"></a>03292       <span class="keywordflow">return</span> <span class="keyword">false</span>;    
<a name="l03293"></a>03293     K = P*Ht*tmpMat;
<a name="l03294"></a>03294     
<a name="l03295"></a>03295 
<a name="l03296"></a>03296     <span class="comment">// Compute the change in states due to the innovations (misclosures).</span>
<a name="l03297"></a>03297     dx = K*w;
<a name="l03298"></a>03298 
<a name="l03299"></a>03299     
<a name="l03300"></a>03300 
<a name="l03301"></a>03301     <span class="comment">// Compute the updated state variance-covariance matrix, P.</span>
<a name="l03302"></a>03302     result = I.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( 8, 8 );
<a name="l03303"></a>03303     <span class="keywordflow">if</span>( !result )
<a name="l03304"></a>03304       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03305"></a>03305     result = I.<a class="code" href="class_zenautics_1_1_matrix.html#69a5e6812dea81dcf051de9b660b191b" title="Set the matrix to identity using the current dimensions.">Identity</a>();
<a name="l03306"></a>03306     <span class="keywordflow">if</span>( !result )
<a name="l03307"></a>03307       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03308"></a>03308 
<a name="l03309"></a>03309     P = (I - K * H)*P;
<a name="l03310"></a>03310     
<a name="l03311"></a>03311     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"dx"</span>, dx );
<a name="l03312"></a>03312     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"P"</span>, P );
<a name="l03313"></a>03313     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"K"</span>, K );
<a name="l03314"></a>03314 
<a name="l03315"></a>03315     
<a name="l03316"></a>03316     <span class="comment">// Update the position and clock states</span>
<a name="l03317"></a>03317     <span class="comment">// Update height first as it is need to reduce the corrections for lat and lon.</span>
<a name="l03318"></a>03318     hgt += dx[2];
<a name="l03319"></a>03319     clk += dx[6];
<a name="l03320"></a>03320 
<a name="l03321"></a>03321     <span class="comment">// The corrections for lat and lon, dx_p, must be converted to [rad] from [m].</span>
<a name="l03322"></a>03322     <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l03323"></a>03323       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>, 
<a name="l03324"></a>03324       lat,
<a name="l03325"></a>03325       &amp;N );
<a name="l03326"></a>03326     <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>(
<a name="l03327"></a>03327       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>, 
<a name="l03328"></a>03328       lat,
<a name="l03329"></a>03329       &amp;M );
<a name="l03330"></a>03330 
<a name="l03331"></a>03331      lat += dx[0] / ( M + hgt );             <span class="comment">// convert from meters to radians.</span>
<a name="l03332"></a>03332      lon += dx[1] / (( N + hgt )*cos(lat));  <span class="comment">// convert from meters to radians.</span>
<a name="l03333"></a>03333 
<a name="l03334"></a>03334      result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#52a8d17635ab44c6add3566bc700a30f" title="Update the receiver position and clock offset.">UpdatePositionAndRxClock</a>(
<a name="l03335"></a>03335        lat,
<a name="l03336"></a>03336        lon,
<a name="l03337"></a>03337        hgt,
<a name="l03338"></a>03338        clk,
<a name="l03339"></a>03339        sqrt(P[0][0]),
<a name="l03340"></a>03340        sqrt(P[1][1]),
<a name="l03341"></a>03341        sqrt(P[2][2]),
<a name="l03342"></a>03342        sqrt(P[6][6])
<a name="l03343"></a>03343        );
<a name="l03344"></a>03344      <span class="keywordflow">if</span>( !result )
<a name="l03345"></a>03345        <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03346"></a>03346 
<a name="l03347"></a>03347 
<a name="l03348"></a>03348      <span class="comment">// Update the velocity and clock drift states.</span>
<a name="l03349"></a>03349      vn        += dx[3];
<a name="l03350"></a>03350      ve        += dx[4];
<a name="l03351"></a>03351      vup       += dx[5];
<a name="l03352"></a>03352      clkdrift  += dx[7];
<a name="l03353"></a>03353 
<a name="l03354"></a>03354      result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#41cd9f52d3cc745937c4832b3e4021d7" title="Update the receiver velocity and clock drift.">UpdateVelocityAndClockDrift</a>(
<a name="l03355"></a>03355        vn,
<a name="l03356"></a>03356        ve,
<a name="l03357"></a>03357        vup,
<a name="l03358"></a>03358        clkdrift,
<a name="l03359"></a>03359        sqrt(P[3][3]),
<a name="l03360"></a>03360        sqrt(P[4][4]),
<a name="l03361"></a>03361        sqrt(P[5][5]),
<a name="l03362"></a>03362        sqrt(P[7][7]) );
<a name="l03363"></a>03363      <span class="keywordflow">if</span>( !result )
<a name="l03364"></a>03364        <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03365"></a>03365 
<a name="l03366"></a>03366      <span class="comment">/*</span>
<a name="l03367"></a>03367 <span class="comment">     // GDM - recomputing the misclosures after adjustment!</span>
<a name="l03368"></a>03368 <span class="comment">    result = DeterminePseudorangeMisclosures_GPSL1(</span>
<a name="l03369"></a>03369 <span class="comment">      rxData,</span>
<a name="l03370"></a>03370 <span class="comment">      rxBaseData,</span>
<a name="l03371"></a>03371 <span class="comment">      nrP,</span>
<a name="l03372"></a>03372 <span class="comment">      w_p );</span>
<a name="l03373"></a>03373 <span class="comment">    if( !result )</span>
<a name="l03374"></a>03374 <span class="comment">      return false;</span>
<a name="l03375"></a>03375 <span class="comment"></span>
<a name="l03376"></a>03376 <span class="comment">    result = DetermineDopplerMisclosures_GPSL1(</span>
<a name="l03377"></a>03377 <span class="comment">      rxData,</span>
<a name="l03378"></a>03378 <span class="comment">      rxBaseData,</span>
<a name="l03379"></a>03379 <span class="comment">      nrD,</span>
<a name="l03380"></a>03380 <span class="comment">      w_v );</span>
<a name="l03381"></a>03381 <span class="comment">    if( !result )</span>
<a name="l03382"></a>03382 <span class="comment">      return false;</span>
<a name="l03383"></a>03383 <span class="comment">      */</span>
<a name="l03384"></a>03384 
<a name="l03385"></a>03385 
<a name="l03386"></a>03386     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03387"></a>03387   }
<a name="l03388"></a>03388   
<a name="l03389"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5107d9bfcb51cd32c4c65c05dbfec510">03389</a>   
<a name="l03390"></a>03390   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5107d9bfcb51cd32c4c65c05dbfec510">GNSS_Estimator::Kalman_Update_8StatePVGM_SequentialMode</a>(
<a name="l03391"></a>03391     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,      <span class="comment">//!&lt; A pointer to the rover receiver data. This must be a valid pointer.</span>
<a name="l03392"></a>03392 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,  <span class="comment">//!&lt; A pointer to the reference receiver data if available. NULL if not available.</span>
<a name="l03393"></a>03393 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P                 <span class="comment">//!&lt; The variance-covariance of the states.</span>
<a name="l03394"></a>03394 <span class="comment"></span>  )
<a name="l03395"></a>03395   {
<a name="l03396"></a>03396     <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l03397"></a>03397     <span class="keywordtype">unsigned</span> index = 0;
<a name="l03398"></a>03398     <span class="keywordtype">unsigned</span> i = 0;
<a name="l03399"></a>03399     <span class="keywordtype">unsigned</span> j = 0;
<a name="l03400"></a>03400     <span class="keywordtype">unsigned</span> n = 0;
<a name="l03401"></a>03401     <span class="keywordtype">unsigned</span> nrP = 0;           <span class="comment">// The number of valid psr.</span>
<a name="l03402"></a>03402     <span class="keywordtype">unsigned</span> nrP_base = 0;      <span class="comment">// The number of valid psr for the reference station.</span>
<a name="l03403"></a>03403     <span class="keywordtype">unsigned</span> nrD = 0;           <span class="comment">// The number of valid Doppler.</span>
<a name="l03404"></a>03404     <span class="keywordtype">unsigned</span> nrD_base = 0;      <span class="comment">// The number of valid Doppler for the reference station.</span>
<a name="l03405"></a>03405     <span class="keywordtype">unsigned</span> nrValidEph = 0;    <span class="comment">// The number of valid ephemeris.</span>
<a name="l03406"></a>03406     <span class="keywordtype">unsigned</span> nrDifferentialPsr = 0;     <span class="comment">// The number of differential psr.</span>
<a name="l03407"></a>03407     <span class="keywordtype">unsigned</span> nrDifferentialDoppler = 0; <span class="comment">// The number of differential Doppler.</span>
<a name="l03408"></a>03408     <span class="keywordtype">bool</span> isDifferential = <span class="keyword">false</span>;
<a name="l03409"></a>03409     <span class="keywordtype">unsigned</span> u = 0;
<a name="l03410"></a>03410 
<a name="l03411"></a>03411     <span class="keywordtype">double</span> lat = 0;
<a name="l03412"></a>03412     <span class="keywordtype">double</span> lon = 0;
<a name="l03413"></a>03413     <span class="keywordtype">double</span> hgt = 0;
<a name="l03414"></a>03414     <span class="keywordtype">double</span> clk = 0;
<a name="l03415"></a>03415     <span class="keywordtype">double</span> vn = 0;
<a name="l03416"></a>03416     <span class="keywordtype">double</span> ve = 0;
<a name="l03417"></a>03417     <span class="keywordtype">double</span> vup = 0;
<a name="l03418"></a>03418     <span class="keywordtype">double</span> clkdrift = 0;
<a name="l03419"></a>03419     <span class="keywordtype">double</span> M = 0;   <span class="comment">// The computed meridian radius of curvature [m].</span>
<a name="l03420"></a>03420     <span class="keywordtype">double</span> N = 0;   <span class="comment">// The computed prime vertical radius of curvature [m].</span>
<a name="l03421"></a>03421 
<a name="l03422"></a>03422     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_p;
<a name="l03423"></a>03423     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_v;
<a name="l03424"></a>03424     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H;
<a name="l03425"></a>03425     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_p;
<a name="l03426"></a>03426     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_v;
<a name="l03427"></a>03427     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R;
<a name="l03428"></a>03428     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_p;
<a name="l03429"></a>03429     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_v;
<a name="l03430"></a>03430     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w;
<a name="l03431"></a>03431     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> K;
<a name="l03432"></a>03432     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMat;
<a name="l03433"></a>03433     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMatP;
<a name="l03434"></a>03434     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> dx(8);
<a name="l03435"></a>03435     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> I;
<a name="l03436"></a>03436 
<a name="l03437"></a>03437     dx.<a class="code" href="class_zenautics_1_1_matrix.html#31f74d047657ee91ed3160a5cca797ce" title="Zero the entire matrix.">Zero</a>();
<a name="l03438"></a>03438     
<a name="l03439"></a>03439     <span class="comment">// Store the current input pvt as the previous pvt since we are updating.</span>
<a name="l03440"></a>03440     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#b5a4d70eb050a710917d2593c63c5392" title="The receiver&amp;#39;s previous position, velocity, and time information.">m_prev_pvt</a> = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>;
<a name="l03441"></a>03441         
<a name="l03442"></a>03442     lat = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>;
<a name="l03443"></a>03443     lon = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>;
<a name="l03444"></a>03444     hgt = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l03445"></a>03445     clk = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a>;
<a name="l03446"></a>03446     vn  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a>;
<a name="l03447"></a>03447     ve  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a>;
<a name="l03448"></a>03448     vup = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a>;
<a name="l03449"></a>03449     clkdrift = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>;
<a name="l03450"></a>03450         
<a name="l03451"></a>03451     <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l03452"></a>03452       isDifferential = <span class="keyword">true</span>;
<a name="l03453"></a>03453 
<a name="l03454"></a>03454 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03455"></a>03455 <span class="preprocessor"></span>    rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> = 1;
<a name="l03456"></a>03456 <span class="preprocessor">#else</span>
<a name="l03457"></a>03457 <span class="preprocessor"></span>    rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> = 0;
<a name="l03458"></a>03458 <span class="preprocessor">#endif</span>
<a name="l03459"></a>03459 <span class="preprocessor"></span>    
<a name="l03460"></a>03460     <span class="comment"></span>
<a name="l03461"></a>03461 <span class="comment">    ////</span>
<a name="l03462"></a>03462 <span class="comment"></span>    <span class="comment">// Perform operations specific to the rover.</span>
<a name="l03463"></a>03463 
<a name="l03464"></a>03464     <span class="comment">// Update the receiver time information (UTC and day of year)</span>
<a name="l03465"></a>03465     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxData );
<a name="l03466"></a>03466     <span class="keywordflow">if</span>( !result )
<a name="l03467"></a>03467       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03468"></a>03468 
<a name="l03469"></a>03469     <span class="keywordflow">if</span>( isDifferential )
<a name="l03470"></a>03470     {
<a name="l03471"></a>03471       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxBaseData );
<a name="l03472"></a>03472       <span class="keywordflow">if</span>( !result )
<a name="l03473"></a>03473       {
<a name="l03474"></a>03474         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03475"></a>03475       }
<a name="l03476"></a>03476     }
<a name="l03477"></a>03477 
<a name="l03478"></a>03478     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b65e9ee3b9983ceb2583fd21982ddbe8" title="Determine the satellite clock corrections, positions, and velocities for the rover...">DetermineSatellitePVT_GPSL1</a>( rxData, rxBaseData, nrValidEph );
<a name="l03479"></a>03479     <span class="keywordflow">if</span>( !result )
<a name="l03480"></a>03480     {
<a name="l03481"></a>03481       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03482"></a>03482     }
<a name="l03483"></a>03483 
<a name="l03484"></a>03484 
<a name="l03485"></a>03485     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxData );
<a name="l03486"></a>03486     <span class="keywordflow">if</span>( !result )
<a name="l03487"></a>03487     {
<a name="l03488"></a>03488       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03489"></a>03489     }
<a name="l03490"></a>03490     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxData, nrP );
<a name="l03491"></a>03491     <span class="keywordflow">if</span>( !result )
<a name="l03492"></a>03492     {
<a name="l03493"></a>03493     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03494"></a>03494     }
<a name="l03495"></a>03495     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxData, nrD );
<a name="l03496"></a>03496     <span class="keywordflow">if</span>( !result )
<a name="l03497"></a>03497     {
<a name="l03498"></a>03498       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03499"></a>03499     }
<a name="l03500"></a>03500 
<a name="l03501"></a>03501     <span class="keywordflow">if</span>( isDifferential )
<a name="l03502"></a>03502     {
<a name="l03503"></a>03503       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxBaseData );
<a name="l03504"></a>03504       <span class="keywordflow">if</span>( !result )
<a name="l03505"></a>03505         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03506"></a>03506       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxBaseData, nrP_base );
<a name="l03507"></a>03507       <span class="keywordflow">if</span>( !result )
<a name="l03508"></a>03508         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03509"></a>03509       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxBaseData, nrD_base );
<a name="l03510"></a>03510       <span class="keywordflow">if</span>( !result )
<a name="l03511"></a>03511         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03512"></a>03512 
<a name="l03513"></a>03513 
<a name="l03514"></a>03514       <span class="comment">// When in differential mode, only differntial measurements will be used</span>
<a name="l03515"></a>03515       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0325ac1ddd31befdbfc2a8b67e97c69c" title="Determine the differential GPS L1 pseudorange measurements.">DetermineDifferentialPseudorangeMeasurementsForThePositionSolution_GPSL1</a>(
<a name="l03516"></a>03516         rxData,
<a name="l03517"></a>03517         rxBaseData,
<a name="l03518"></a>03518         <span class="keyword">true</span>,
<a name="l03519"></a>03519         nrDifferentialPsr );
<a name="l03520"></a>03520       <span class="keywordflow">if</span>( !result )
<a name="l03521"></a>03521       {
<a name="l03522"></a>03522         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03523"></a>03523       }
<a name="l03524"></a>03524 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03525"></a>03525 <span class="preprocessor"></span>      nrP = nrDifferentialPsr+3;
<a name="l03526"></a>03526 <span class="preprocessor">#else</span>
<a name="l03527"></a>03527 <span class="preprocessor"></span>      nrP = nrDifferentialPsr;
<a name="l03528"></a>03528 <span class="preprocessor">#endif</span>
<a name="l03529"></a>03529 <span class="preprocessor"></span>
<a name="l03530"></a>03530       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#92db9d6064dda154b675f62f07b53573" title="Determine the differential GPS L1 Doppler measurements.">DetermineDifferentialDopplerMeasurementsForTheVelocitySolution_GPSL1</a>(
<a name="l03531"></a>03531         rxData,
<a name="l03532"></a>03532         rxBaseData,
<a name="l03533"></a>03533         <span class="keyword">true</span>,
<a name="l03534"></a>03534         nrDifferentialDoppler );
<a name="l03535"></a>03535       <span class="keywordflow">if</span>( !result )
<a name="l03536"></a>03536       {
<a name="l03537"></a>03537         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03538"></a>03538       }
<a name="l03539"></a>03539 
<a name="l03540"></a>03540 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03541"></a>03541 <span class="preprocessor"></span>      nrD = nrDifferentialPsr+3;
<a name="l03542"></a>03542 <span class="preprocessor">#else</span>
<a name="l03543"></a>03543 <span class="preprocessor"></span>      nrD = nrDifferentialPsr;
<a name="l03544"></a>03544 <span class="preprocessor">#endif</span>
<a name="l03545"></a>03545 <span class="preprocessor"></span>    }
<a name="l03546"></a>03546 
<a name="l03547"></a>03547     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6" title="Determine the design matrix for the GPS L1 position solution based on pseudroange...">DetermineDesignMatrixForThePositionSolution_GPSL1</a>(
<a name="l03548"></a>03548       *rxData,
<a name="l03549"></a>03549       nrP,
<a name="l03550"></a>03550       H_p );
<a name="l03551"></a>03551     <span class="keywordflow">if</span>( !result )
<a name="l03552"></a>03552     {
<a name="l03553"></a>03553       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03554"></a>03554     }
<a name="l03555"></a>03555     
<a name="l03556"></a>03556     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19" title="Determine the design matrix for the GPS L1 velocity solution based on Doppler measurements...">DetermineDesignMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l03557"></a>03557       *rxData,
<a name="l03558"></a>03558       nrD,
<a name="l03559"></a>03559       H_v );
<a name="l03560"></a>03560     <span class="keywordflow">if</span>( !result )
<a name="l03561"></a>03561     {
<a name="l03562"></a>03562       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03563"></a>03563     }
<a name="l03564"></a>03564 
<a name="l03565"></a>03565 
<a name="l03566"></a>03566     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a0c642977c8e788817fbde37909533d3" title="Determine the measurement variance-coariance matrix for the GPS L1 position solution...">DetermineMeasurementVarianceCovarianceMatrixForThePositionSolution_GPSL1</a>(
<a name="l03567"></a>03567       *rxData,
<a name="l03568"></a>03568       nrP,
<a name="l03569"></a>03569       R_p );
<a name="l03570"></a>03570     <span class="keywordflow">if</span>( !result )
<a name="l03571"></a>03571     {
<a name="l03572"></a>03572       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03573"></a>03573     }
<a name="l03574"></a>03574 
<a name="l03575"></a>03575 
<a name="l03576"></a>03576     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#981212395e812c74a9ce542c2b7187cd" title="Determine the measurement variance-covariance matrix for the GPS L1 velocity solution...">DetermineMeasurementVarianceCovarianceMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l03577"></a>03577       *rxData,
<a name="l03578"></a>03578       nrD,
<a name="l03579"></a>03579       R_v );
<a name="l03580"></a>03580     <span class="keywordflow">if</span>( !result )
<a name="l03581"></a>03581     {
<a name="l03582"></a>03582       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03583"></a>03583     }
<a name="l03584"></a>03584 
<a name="l03585"></a>03585 
<a name="l03586"></a>03586     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">DeterminePseudorangeMisclosures_GPSL1</a>(
<a name="l03587"></a>03587       rxData,
<a name="l03588"></a>03588       rxBaseData,
<a name="l03589"></a>03589       nrP,
<a name="l03590"></a>03590       w_p );
<a name="l03591"></a>03591     <span class="keywordflow">if</span>( !result )
<a name="l03592"></a>03592     {
<a name="l03593"></a>03593       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03594"></a>03594     }
<a name="l03595"></a>03595 
<a name="l03596"></a>03596     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">DetermineDopplerMisclosures_GPSL1</a>(
<a name="l03597"></a>03597       rxData,
<a name="l03598"></a>03598       rxBaseData,
<a name="l03599"></a>03599       nrD,
<a name="l03600"></a>03600       w_v );
<a name="l03601"></a>03601     <span class="keywordflow">if</span>( !result )
<a name="l03602"></a>03602     {
<a name="l03603"></a>03603       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03604"></a>03604     }
<a name="l03605"></a>03605 
<a name="l03606"></a>03606     <span class="comment">// Form the combined design matrix.</span>
<a name="l03607"></a>03607     n = H_p.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>() + H_v.<a class="code" href="class_zenautics_1_1_matrix.html#b910aeb1c41811b2a9439dc1ca7f1a62" title="return no. of rows">GetNrRows</a>();
<a name="l03608"></a>03608 
<a name="l03609"></a>03609     result = H.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 8 );
<a name="l03610"></a>03610     <span class="keywordflow">if</span>( !result )
<a name="l03611"></a>03611     {
<a name="l03612"></a>03612       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03613"></a>03613     }
<a name="l03614"></a>03614 
<a name="l03615"></a>03615     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03616"></a>03616     {
<a name="l03617"></a>03617       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03618"></a>03618       {
<a name="l03619"></a>03619         <span class="keywordflow">for</span>( j = 0; j &lt; 3; j++ )
<a name="l03620"></a>03620         {
<a name="l03621"></a>03621           H[i][j] = H_p[i][j];
<a name="l03622"></a>03622         }
<a name="l03623"></a>03623 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03624"></a>03624 <span class="preprocessor"></span>        <span class="keywordflow">if</span>( i &lt; nrP-3 )
<a name="l03625"></a>03625         {
<a name="l03626"></a>03626           H[i][6] = 1.0;
<a name="l03627"></a>03627         }
<a name="l03628"></a>03628 <span class="preprocessor">#else</span>
<a name="l03629"></a>03629 <span class="preprocessor"></span>        H[i][6] = 1.0;
<a name="l03630"></a>03630 <span class="preprocessor">#endif</span>
<a name="l03631"></a>03631 <span class="preprocessor"></span>      }
<a name="l03632"></a>03632       <span class="keywordflow">else</span>
<a name="l03633"></a>03633       {
<a name="l03634"></a>03634         <span class="keywordflow">for</span>( j = 0; j &lt; 3; j++ )
<a name="l03635"></a>03635         {
<a name="l03636"></a>03636           H[i][j+3] = H_v[i-nrP][j];
<a name="l03637"></a>03637         }
<a name="l03638"></a>03638 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03639"></a>03639 <span class="preprocessor"></span>        <span class="keywordflow">if</span>( i &lt; n-3 )
<a name="l03640"></a>03640         {
<a name="l03641"></a>03641           H[i][7] = 1.0;
<a name="l03642"></a>03642         }
<a name="l03643"></a>03643 <span class="preprocessor">#else</span>
<a name="l03644"></a>03644 <span class="preprocessor"></span>        H[i][7] = 1.0;
<a name="l03645"></a>03645 <span class="preprocessor">#endif</span>
<a name="l03646"></a>03646 <span class="preprocessor"></span>      }
<a name="l03647"></a>03647     }
<a name="l03648"></a>03648     
<a name="l03649"></a>03649     
<a name="l03650"></a>03650     result = R.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, n );
<a name="l03651"></a>03651     <span class="keywordflow">if</span>( !result )
<a name="l03652"></a>03652     {
<a name="l03653"></a>03653       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03654"></a>03654     }
<a name="l03655"></a>03655 
<a name="l03656"></a>03656     <span class="comment">// Form the combined measurement variance-covariance matrix.</span>
<a name="l03657"></a>03657     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03658"></a>03658     {
<a name="l03659"></a>03659       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03660"></a>03660       {
<a name="l03661"></a>03661         <span class="keywordflow">for</span>( j = 0; j &lt; nrP; j++ )
<a name="l03662"></a>03662         {
<a name="l03663"></a>03663           R[i][j] = R_p[i][j];
<a name="l03664"></a>03664         }
<a name="l03665"></a>03665       }
<a name="l03666"></a>03666       <span class="keywordflow">else</span>
<a name="l03667"></a>03667       {
<a name="l03668"></a>03668         <span class="keywordflow">for</span>( j = 0; j &lt; nrD; j++ )
<a name="l03669"></a>03669         {
<a name="l03670"></a>03670           R[i][j+nrD] = R_v[i-nrP][j];
<a name="l03671"></a>03671         }
<a name="l03672"></a>03672       }
<a name="l03673"></a>03673     }
<a name="l03674"></a>03674     
<a name="l03675"></a>03675 
<a name="l03676"></a>03676     <span class="comment">// Form the combined misclosure vector.</span>
<a name="l03677"></a>03677     result = w.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 1 );
<a name="l03678"></a>03678     <span class="keywordflow">if</span>( !result )
<a name="l03679"></a>03679     {
<a name="l03680"></a>03680       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03681"></a>03681     }
<a name="l03682"></a>03682     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03683"></a>03683     {
<a name="l03684"></a>03684       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03685"></a>03685       {
<a name="l03686"></a>03686         w[i] = w_p[i];
<a name="l03687"></a>03687       }
<a name="l03688"></a>03688       <span class="keywordflow">else</span>
<a name="l03689"></a>03689       {
<a name="l03690"></a>03690         w[i] = w_v[i-nrP];
<a name="l03691"></a>03691       }
<a name="l03692"></a>03692     }
<a name="l03693"></a>03693     
<a name="l03694"></a>03694     <span class="comment">// The corrections for lat and lon, dx_p, must be converted to [rad] from [m].</span>
<a name="l03695"></a>03695     <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l03696"></a>03696       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l03697"></a>03697       lat,
<a name="l03698"></a>03698       &amp;N );
<a name="l03699"></a>03699     <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>(
<a name="l03700"></a>03700       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l03701"></a>03701       lat,
<a name="l03702"></a>03702       &amp;M );
<a name="l03703"></a>03703     <span class="keywordtype">double</span> dlat = M + hgt;
<a name="l03704"></a>03704     <span class="keywordtype">double</span> dlon = (N + hgt) * cos(lat);
<a name="l03705"></a>03705 
<a name="l03706"></a>03706     u = 8;
<a name="l03707"></a>03707     <span class="comment">// Now the sequential measurement update section</span>
<a name="l03708"></a>03708     <span class="comment">// For each measurement</span>
<a name="l03709"></a>03709     <span class="keywordflow">for</span>( index = 0; index &lt; n; index++ )
<a name="l03710"></a>03710     {
<a name="l03711"></a>03711       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> h(1,u);  <span class="comment">// The i'th row of the design matrix, [ux1].</span>
<a name="l03712"></a>03712       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> ht(u,1); <span class="comment">// The transpose of the i'th row of the design matrix, [ux1].</span>
<a name="l03713"></a>03713       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> pht;     <span class="comment">// pht = P ht, [ux1].</span>
<a name="l03714"></a>03714       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> C;       <span class="comment">// C = (h P ht + R_{ii}), [1x1].</span>
<a name="l03715"></a>03715       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> k_i;     <span class="comment">// The i'th kalman gain. k_i = pht/C</span>
<a name="l03716"></a>03716       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> D;       <span class="comment">// D = k_i h * P.</span>
<a name="l03717"></a>03717       
<a name="l03718"></a>03718       <span class="comment">// Copy out a row of the design matrix.</span>
<a name="l03719"></a>03719       <span class="keywordflow">for</span>( j = 0; j &lt; u; j++ )
<a name="l03720"></a>03720       {
<a name="l03721"></a>03721         h[0][j] = H[index][j];
<a name="l03722"></a>03722         ht[j][0] = H[index][j];
<a name="l03723"></a>03723       }
<a name="l03724"></a>03724       <span class="comment">//PrintMatToDebug( "h", h );</span>
<a name="l03725"></a>03725 
<a name="l03726"></a>03726       <span class="comment">// Compute pht</span>
<a name="l03727"></a>03727       pht = P;
<a name="l03728"></a>03728       <span class="keywordflow">if</span>( !pht.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( ht ) )
<a name="l03729"></a>03729         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03730"></a>03730       
<a name="l03731"></a>03731       <span class="comment">// Compute C = (h P h^T + R_{ii})</span>
<a name="l03732"></a>03732       C = h * pht;
<a name="l03733"></a>03733       C[0] += R[index][index];
<a name="l03734"></a>03734       
<a name="l03735"></a>03735       <span class="comment">// Compute k_i</span>
<a name="l03736"></a>03736       k_i = pht / C[0];
<a name="l03737"></a>03737 
<a name="l03738"></a>03738       <span class="comment">//PrintMatToDebug( "k_i", k_i );</span>
<a name="l03739"></a>03739 
<a name="l03740"></a>03740       <span class="comment">// Update the state variance-coveriance;</span>
<a name="l03741"></a>03741       D = k_i;
<a name="l03742"></a>03742       <span class="keywordflow">if</span>( !D.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( h ) )
<a name="l03743"></a>03743         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03744"></a>03744       <span class="keywordflow">if</span>( !D.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( P ) )
<a name="l03745"></a>03745         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03746"></a>03746       P -= D;
<a name="l03747"></a>03747 
<a name="l03748"></a>03748       
<a name="l03749"></a>03749       <span class="keywordtype">double</span> innovation = w[index];
<a name="l03750"></a>03750       k_i.<a class="code" href="class_zenautics_1_1_matrix.html#090242346881b167f2a92d10d097560d" title="Multiply by scaler double (ie: M *= 5).">Inplace_MultiplyScalar</a>( innovation );
<a name="l03751"></a>03751       dx = k_i;
<a name="l03752"></a>03752       <span class="comment">//PrintMatToDebug( "dx", dx );</span>
<a name="l03753"></a>03753 
<a name="l03754"></a>03754       <span class="comment">// Update the position and clock states</span>
<a name="l03755"></a>03755       <span class="comment">// Update height first as it is need to reduce the corrections for lat and lon.</span>
<a name="l03756"></a>03756       hgt += dx[2];
<a name="l03757"></a>03757       clk += dx[6];
<a name="l03758"></a>03758 
<a name="l03759"></a>03759       <span class="comment">// The corrections for lat and lon, dx_p, must be converted to [rad] from [m].</span>
<a name="l03760"></a>03760       lat += dx[0] / dlat;  <span class="comment">// convert from meters to radians.</span>
<a name="l03761"></a>03761       lon += dx[1] / dlon;  <span class="comment">// convert from meters to radians.</span>
<a name="l03762"></a>03762 
<a name="l03763"></a>03763       result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#52a8d17635ab44c6add3566bc700a30f" title="Update the receiver position and clock offset.">UpdatePositionAndRxClock</a>(
<a name="l03764"></a>03764         lat,
<a name="l03765"></a>03765         lon,
<a name="l03766"></a>03766         hgt,
<a name="l03767"></a>03767         clk,
<a name="l03768"></a>03768         sqrt(P[0][0]),
<a name="l03769"></a>03769         sqrt(P[1][1]),
<a name="l03770"></a>03770         sqrt(P[2][2]),
<a name="l03771"></a>03771         sqrt(P[6][6])
<a name="l03772"></a>03772         );
<a name="l03773"></a>03773       <span class="keywordflow">if</span>( !result )
<a name="l03774"></a>03774       {
<a name="l03775"></a>03775         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03776"></a>03776       }
<a name="l03777"></a>03777 
<a name="l03778"></a>03778       <span class="comment">// Update the velocity and clock drift states.</span>
<a name="l03779"></a>03779       vn        += dx[3];
<a name="l03780"></a>03780       ve        += dx[4];
<a name="l03781"></a>03781       vup       += dx[5];
<a name="l03782"></a>03782       clkdrift  += dx[7];
<a name="l03783"></a>03783 
<a name="l03784"></a>03784       result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#41cd9f52d3cc745937c4832b3e4021d7" title="Update the receiver velocity and clock drift.">UpdateVelocityAndClockDrift</a>(
<a name="l03785"></a>03785         vn,
<a name="l03786"></a>03786         ve,
<a name="l03787"></a>03787         vup,
<a name="l03788"></a>03788         clkdrift,
<a name="l03789"></a>03789         sqrt(P[3][3]),
<a name="l03790"></a>03790         sqrt(P[4][4]),
<a name="l03791"></a>03791         sqrt(P[5][5]),
<a name="l03792"></a>03792         sqrt(P[7][7]) );
<a name="l03793"></a>03793       <span class="keywordflow">if</span>( !result )
<a name="l03794"></a>03794       {
<a name="l03795"></a>03795         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03796"></a>03796       }
<a name="l03797"></a>03797 
<a name="l03798"></a>03798       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">DeterminePseudorangeMisclosures_GPSL1</a>(
<a name="l03799"></a>03799         rxData,
<a name="l03800"></a>03800         rxBaseData,
<a name="l03801"></a>03801         nrP,
<a name="l03802"></a>03802         w_p );
<a name="l03803"></a>03803       <span class="keywordflow">if</span>( !result )
<a name="l03804"></a>03804       {
<a name="l03805"></a>03805         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03806"></a>03806       }
<a name="l03807"></a>03807 
<a name="l03808"></a>03808       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">DetermineDopplerMisclosures_GPSL1</a>(
<a name="l03809"></a>03809         rxData,
<a name="l03810"></a>03810         rxBaseData,
<a name="l03811"></a>03811         nrD,
<a name="l03812"></a>03812         w_v );
<a name="l03813"></a>03813       <span class="keywordflow">if</span>( !result )
<a name="l03814"></a>03814       {
<a name="l03815"></a>03815         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03816"></a>03816       }
<a name="l03817"></a>03817 
<a name="l03818"></a>03818       <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l03819"></a>03819       {
<a name="l03820"></a>03820         <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l03821"></a>03821         {
<a name="l03822"></a>03822           w[i] = w_p[i];
<a name="l03823"></a>03823         }
<a name="l03824"></a>03824         <span class="keywordflow">else</span>
<a name="l03825"></a>03825         {
<a name="l03826"></a>03826           w[i] = w_v[i-nrP];
<a name="l03827"></a>03827         }
<a name="l03828"></a>03828       }            
<a name="l03829"></a>03829     }
<a name="l03830"></a>03830     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03831"></a>03831   }
<a name="l03832"></a>03832 
<a name="l03833"></a>03833 
<a name="l03834"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#1bb0feacb8938137e5a99aa529f756ff">03834</a> 
<a name="l03835"></a>03835   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#1bb0feacb8938137e5a99aa529f756ff">GNSS_Estimator::Kalman_Update_8StatePVGM_SequentialMode_FloatSolution</a>(
<a name="l03836"></a>03836     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,      <span class="comment">//!&lt; A pointer to the rover receiver data. This must be a valid pointer.</span>
<a name="l03837"></a>03837 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData,  <span class="comment">//!&lt; A pointer to the reference receiver data if available. NULL if not available.</span>
<a name="l03838"></a>03838 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P                 <span class="comment">//!&lt; The variance-covariance of the states.</span>
<a name="l03839"></a>03839 <span class="comment"></span>  )
<a name="l03840"></a>03840   {
<a name="l03841"></a>03841     <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l03842"></a>03842     <span class="keywordtype">unsigned</span> index = 0;
<a name="l03843"></a>03843     <span class="keywordtype">unsigned</span> i = 0;
<a name="l03844"></a>03844     <span class="keywordtype">unsigned</span> j = 0;
<a name="l03845"></a>03845     <span class="keywordtype">unsigned</span> k = 0; 
<a name="l03846"></a>03846     <span class="keywordtype">unsigned</span> m = 0; <span class="comment">// counter</span>
<a name="l03847"></a>03847     <span class="keywordtype">unsigned</span> n = 0;
<a name="l03848"></a>03848     <span class="keywordtype">unsigned</span> nrP = 0;           <span class="comment">// The number of valid psr.</span>
<a name="l03849"></a>03849     <span class="keywordtype">unsigned</span> nrP_base = 0;      <span class="comment">// The number of valid psr for the reference station.</span>
<a name="l03850"></a>03850     <span class="keywordtype">unsigned</span> nrD = 0;           <span class="comment">// The number of valid Doppler.</span>
<a name="l03851"></a>03851     <span class="keywordtype">unsigned</span> nrD_base = 0;      <span class="comment">// The number of valid Doppler for the reference station.</span>
<a name="l03852"></a>03852     <span class="keywordtype">unsigned</span> nrValidEph = 0;    <span class="comment">// The number of valid ephemeris.</span>
<a name="l03853"></a>03853     <span class="keywordtype">unsigned</span> nrUsableAdr = 0;      <span class="comment">// The number of valid adr.</span>
<a name="l03854"></a>03854     <span class="keywordtype">unsigned</span> nrUsableAdr_base = 0; <span class="comment">// The number of valid adr for the reference station.</span>
<a name="l03855"></a>03855     <span class="keywordtype">unsigned</span> nrDifferentialPsr = 0;     <span class="comment">// The number of differential psr.</span>
<a name="l03856"></a>03856     <span class="keywordtype">unsigned</span> nrDifferentialDoppler = 0; <span class="comment">// The number of differential Doppler.</span>
<a name="l03857"></a>03857     <span class="keywordtype">unsigned</span> nrDifferentialAdr = 0;     <span class="comment">// The number of differntial adr.</span>
<a name="l03858"></a>03858     <span class="keywordtype">bool</span> isDifferential = <span class="keyword">false</span>;
<a name="l03859"></a>03859     <span class="keywordtype">unsigned</span> u = 0;
<a name="l03860"></a>03860     <span class="keywordtype">bool</span> setToUseOnlyDifferential = <span class="keyword">true</span>;
<a name="l03861"></a>03861 
<a name="l03862"></a>03862     <span class="keywordtype">double</span> lat = 0;
<a name="l03863"></a>03863     <span class="keywordtype">double</span> lon = 0;
<a name="l03864"></a>03864     <span class="keywordtype">double</span> hgt = 0;
<a name="l03865"></a>03865     <span class="keywordtype">double</span> clk = 0;
<a name="l03866"></a>03866     <span class="keywordtype">double</span> vn = 0;
<a name="l03867"></a>03867     <span class="keywordtype">double</span> ve = 0;
<a name="l03868"></a>03868     <span class="keywordtype">double</span> vup = 0;
<a name="l03869"></a>03869     <span class="keywordtype">double</span> clkdrift = 0;
<a name="l03870"></a>03870     <span class="keywordtype">double</span> M = 0;   <span class="comment">// The computed meridian radius of curvature [m].</span>
<a name="l03871"></a>03871     <span class="keywordtype">double</span> N = 0;   <span class="comment">// The computed prime vertical radius of curvature [m].</span>
<a name="l03872"></a>03872 
<a name="l03873"></a>03873     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_p;
<a name="l03874"></a>03874     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H_v;
<a name="l03875"></a>03875     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> H;
<a name="l03876"></a>03876     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> r; <span class="comment">// A vector corresponding to the diagonal elements of R.</span>
<a name="l03877"></a>03877     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_p;
<a name="l03878"></a>03878     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> R_v;
<a name="l03879"></a>03879     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_p;
<a name="l03880"></a>03880     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_v;
<a name="l03881"></a>03881     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w_adr;
<a name="l03882"></a>03882     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> w;
<a name="l03883"></a>03883     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> K;
<a name="l03884"></a>03884     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMat;
<a name="l03885"></a>03885     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> tmpMatP;
<a name="l03886"></a>03886     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> dx(8);
<a name="l03887"></a>03887     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> I;
<a name="l03888"></a>03888 
<a name="l03889"></a>03889     dx.<a class="code" href="class_zenautics_1_1_matrix.html#31f74d047657ee91ed3160a5cca797ce" title="Zero the entire matrix.">Zero</a>();
<a name="l03890"></a>03890     
<a name="l03891"></a>03891     
<a name="l03892"></a>03892     lat = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#124c715a637d485141a4224269b8c560" title="The user latitude [rad].">latitude</a>;
<a name="l03893"></a>03893     lon = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#e22da7e3af0300adb7ad37006ceae16d" title="The user longitude [rad].">longitude</a>;
<a name="l03894"></a>03894     hgt = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b475fb76e7421aee136ade58a0d8f8c4" title="The user orthometric height [m].">height</a>;
<a name="l03895"></a>03895     clk = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#7a73384b1139caa77134c0f43a4047c2" title="The receiver clock offset [m].">clockOffset</a>;
<a name="l03896"></a>03896     vn  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#f46a6e5bef709f2c2478b349a2d6be85" title="The user&amp;#39;s local geodetic velocity, velocity North [m/s].">vn</a>;
<a name="l03897"></a>03897     ve  = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#18ae1e35eb59061fc3442400b67c68f6" title="The user&amp;#39;s local geodetic velocity, velocity East [m/s].">ve</a>;
<a name="l03898"></a>03898     vup = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#b09077cb74581d769b0b24b94dad9917" title="The user&amp;#39;s local geodetic velocity, velocity Up [m/s].">vup</a>;
<a name="l03899"></a>03899     clkdrift = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#5b1a55e05a4e3441ab66da1b4a37e299" title="the receiver clock drift [m/s].">clockDrift</a>;
<a name="l03900"></a>03900         
<a name="l03901"></a>03901     <span class="keywordflow">if</span>( rxBaseData != NULL )
<a name="l03902"></a>03902       isDifferential = <span class="keyword">true</span>;
<a name="l03903"></a>03903 
<a name="l03904"></a>03904 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03905"></a>03905 <span class="preprocessor"></span>    rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> = 1;
<a name="l03906"></a>03906 <span class="preprocessor">#else</span>
<a name="l03907"></a>03907 <span class="preprocessor"></span>    rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#1f248f9a8d3292bbb55c1859b6086610" title="Is this a constrained position solution [TRUE(1),FALSE(0)].">isPositionConstrained</a> = 0;
<a name="l03908"></a>03908 <span class="preprocessor">#endif</span>
<a name="l03909"></a>03909 <span class="preprocessor"></span>    
<a name="l03910"></a>03910     <span class="comment"></span>
<a name="l03911"></a>03911 <span class="comment">    ////</span>
<a name="l03912"></a>03912 <span class="comment"></span>    <span class="comment">// Perform operations specific to the rover.</span>
<a name="l03913"></a>03913 
<a name="l03914"></a>03914     <span class="comment">// Update the receiver time information (UTC and day of year)</span>
<a name="l03915"></a>03915     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxData );
<a name="l03916"></a>03916     <span class="keywordflow">if</span>( !result )
<a name="l03917"></a>03917       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03918"></a>03918 
<a name="l03919"></a>03919     <span class="keywordflow">if</span>( isDifferential )
<a name="l03920"></a>03920     {
<a name="l03921"></a>03921       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#351e1fdb69fda60fdae6c77ff7fa89fa" title="Update the rest of m_pvt.time struct based on the gps week and time of week only...">UpdateTime</a>( *rxBaseData );
<a name="l03922"></a>03922       <span class="keywordflow">if</span>( !result )
<a name="l03923"></a>03923       {
<a name="l03924"></a>03924         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03925"></a>03925       }
<a name="l03926"></a>03926     }
<a name="l03927"></a>03927 
<a name="l03928"></a>03928     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#b65e9ee3b9983ceb2583fd21982ddbe8" title="Determine the satellite clock corrections, positions, and velocities for the rover...">DetermineSatellitePVT_GPSL1</a>( rxData, rxBaseData, nrValidEph );
<a name="l03929"></a>03929     <span class="keywordflow">if</span>( !result )
<a name="l03930"></a>03930     {
<a name="l03931"></a>03931       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03932"></a>03932     }
<a name="l03933"></a>03933 
<a name="l03934"></a>03934 
<a name="l03935"></a>03935     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxData );
<a name="l03936"></a>03936     <span class="keywordflow">if</span>( !result )
<a name="l03937"></a>03937     {
<a name="l03938"></a>03938       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03939"></a>03939     }
<a name="l03940"></a>03940     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxData, nrP );
<a name="l03941"></a>03941     <span class="keywordflow">if</span>( !result )
<a name="l03942"></a>03942     {
<a name="l03943"></a>03943       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03944"></a>03944     }
<a name="l03945"></a>03945     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxData, nrD );
<a name="l03946"></a>03946     <span class="keywordflow">if</span>( !result )
<a name="l03947"></a>03947     {
<a name="l03948"></a>03948       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03949"></a>03949     }
<a name="l03950"></a>03950     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#8c7fdda095926c02f0670d51812596cb" title="Determine the usable GPS L1 ADR measurements.">DetermineUsableAdrMeasurements_GPSL1</a>( *rxData, nrUsableAdr );
<a name="l03951"></a>03951     <span class="keywordflow">if</span>( !result )
<a name="l03952"></a>03952     {
<a name="l03953"></a>03953       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03954"></a>03954     }
<a name="l03955"></a>03955     
<a name="l03956"></a>03956     <span class="keywordflow">if</span>( isDifferential )
<a name="l03957"></a>03957     {
<a name="l03958"></a>03958       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#d0653db3bf30220d94323cdf04b28570" title="Determine the tropospheric and ionospheric delay for each GPS L1 channel in rxData...">DetermineAtmosphericCorrections_GPSL1</a>( *rxBaseData );
<a name="l03959"></a>03959       <span class="keywordflow">if</span>( !result )
<a name="l03960"></a>03960         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03961"></a>03961       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#6969dbaa28dd7864775011117d3ec3ad" title="Determine the usable GPS L1 pseudroange measurements.">DetermineUsablePseudorangeMeasurementsForThePositionSolution_GPSL1</a>( *rxBaseData, nrP_base );
<a name="l03962"></a>03962       <span class="keywordflow">if</span>( !result )
<a name="l03963"></a>03963         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03964"></a>03964       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e34436e320fbd94934948bacc58eb5be" title="Determine the usable GPS L1 Doppler measurements.">DetermineUsableDopplerMeasurementsForTheVelocitySolution_GPSL1</a>( *rxBaseData, nrD_base );
<a name="l03965"></a>03965       <span class="keywordflow">if</span>( !result )
<a name="l03966"></a>03966         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03967"></a>03967       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#8c7fdda095926c02f0670d51812596cb" title="Determine the usable GPS L1 ADR measurements.">DetermineUsableAdrMeasurements_GPSL1</a>( *rxBaseData, nrUsableAdr_base );
<a name="l03968"></a>03968       <span class="keywordflow">if</span>( !result )
<a name="l03969"></a>03969       {
<a name="l03970"></a>03970         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03971"></a>03971       }
<a name="l03972"></a>03972 
<a name="l03973"></a>03973       <span class="comment">// When in differential mode, only differntial measurements will be used</span>
<a name="l03974"></a>03974       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#0325ac1ddd31befdbfc2a8b67e97c69c" title="Determine the differential GPS L1 pseudorange measurements.">DetermineDifferentialPseudorangeMeasurementsForThePositionSolution_GPSL1</a>(
<a name="l03975"></a>03975         rxData,
<a name="l03976"></a>03976         rxBaseData,
<a name="l03977"></a>03977         <span class="keyword">true</span>,
<a name="l03978"></a>03978         nrDifferentialPsr );
<a name="l03979"></a>03979       <span class="keywordflow">if</span>( !result )
<a name="l03980"></a>03980       {
<a name="l03981"></a>03981         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03982"></a>03982       }
<a name="l03983"></a>03983 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l03984"></a>03984 <span class="preprocessor"></span>      nrP = nrDifferentialPsr+3;
<a name="l03985"></a>03985 <span class="preprocessor">#else</span>
<a name="l03986"></a>03986 <span class="preprocessor"></span>      nrP = nrDifferentialPsr;
<a name="l03987"></a>03987 <span class="preprocessor">#endif</span>
<a name="l03988"></a>03988 <span class="preprocessor"></span>
<a name="l03989"></a>03989       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#92db9d6064dda154b675f62f07b53573" title="Determine the differential GPS L1 Doppler measurements.">DetermineDifferentialDopplerMeasurementsForTheVelocitySolution_GPSL1</a>(
<a name="l03990"></a>03990         rxData,
<a name="l03991"></a>03991         rxBaseData,
<a name="l03992"></a>03992         <span class="keyword">true</span>,
<a name="l03993"></a>03993         nrDifferentialDoppler );
<a name="l03994"></a>03994       <span class="keywordflow">if</span>( !result )
<a name="l03995"></a>03995       {
<a name="l03996"></a>03996         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03997"></a>03997       }
<a name="l03998"></a>03998 
<a name="l03999"></a>03999 <span class="preprocessor">#ifdef CONSTRAINPOS</span>
<a name="l04000"></a>04000 <span class="preprocessor"></span>      nrD = nrDifferentialDoppler+3;
<a name="l04001"></a>04001 <span class="preprocessor">#else</span>
<a name="l04002"></a>04002 <span class="preprocessor"></span>      nrD = nrDifferentialDoppler;
<a name="l04003"></a>04003 <span class="preprocessor">#endif</span>
<a name="l04004"></a>04004 <span class="preprocessor"></span>
<a name="l04005"></a>04005       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#9046c3495a8b425bc111a6312e5c91f4" title="Determine the differential GPS L1 ADR measurements. Allow only differential ADR measurements...">DetermineDifferentialAdrMeasurements_GPSL1</a>(
<a name="l04006"></a>04006         rxData,
<a name="l04007"></a>04007         rxBaseData,
<a name="l04008"></a>04008         setToUseOnlyDifferential,
<a name="l04009"></a>04009         nrDifferentialAdr );
<a name="l04010"></a>04010       <span class="keywordflow">if</span>( !result )
<a name="l04011"></a>04011       {
<a name="l04012"></a>04012         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04013"></a>04013       }
<a name="l04014"></a>04014     }
<a name="l04015"></a>04015     <span class="keywordflow">else</span>
<a name="l04016"></a>04016     {
<a name="l04017"></a>04017       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04018"></a>04018     }
<a name="l04019"></a>04019 
<a name="l04020"></a>04020     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6" title="Determine the design matrix for the GPS L1 position solution based on pseudroange...">DetermineDesignMatrixForThePositionSolution_GPSL1</a>(
<a name="l04021"></a>04021       *rxData,
<a name="l04022"></a>04022       nrP,
<a name="l04023"></a>04023       H_p );
<a name="l04024"></a>04024     <span class="keywordflow">if</span>( !result )
<a name="l04025"></a>04025     {
<a name="l04026"></a>04026       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04027"></a>04027     }
<a name="l04028"></a>04028     
<a name="l04029"></a>04029     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19" title="Determine the design matrix for the GPS L1 velocity solution based on Doppler measurements...">DetermineDesignMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l04030"></a>04030       *rxData,
<a name="l04031"></a>04031       nrD,
<a name="l04032"></a>04032       H_v );
<a name="l04033"></a>04033     <span class="keywordflow">if</span>( !result )
<a name="l04034"></a>04034     {
<a name="l04035"></a>04035       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04036"></a>04036     }
<a name="l04037"></a>04037 
<a name="l04038"></a>04038     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">DeterminePseudorangeMisclosures_GPSL1</a>(
<a name="l04039"></a>04039       rxData,
<a name="l04040"></a>04040       rxBaseData,
<a name="l04041"></a>04041       nrP,
<a name="l04042"></a>04042       w_p );
<a name="l04043"></a>04043     <span class="keywordflow">if</span>( !result )
<a name="l04044"></a>04044     {
<a name="l04045"></a>04045       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04046"></a>04046     }
<a name="l04047"></a>04047 
<a name="l04048"></a>04048     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">DetermineDopplerMisclosures_GPSL1</a>(
<a name="l04049"></a>04049       rxData,
<a name="l04050"></a>04050       rxBaseData,
<a name="l04051"></a>04051       nrD,
<a name="l04052"></a>04052       w_v );
<a name="l04053"></a>04053     <span class="keywordflow">if</span>( !result )
<a name="l04054"></a>04054     {
<a name="l04055"></a>04055       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04056"></a>04056     }
<a name="l04057"></a>04057 
<a name="l04058"></a>04058   <span class="keywordtype">bool</span> hasAmbiguityChangeOccurred = <span class="keyword">false</span>;
<a name="l04059"></a>04059     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#96a0bab199cd0cd0b933722e3f14ace4" title="Deal with changes in ambiguities. Remove the rows and columns from P of the ambiguities...">DetermineAmbiguitiesChanges</a>(
<a name="l04060"></a>04060       rxData,
<a name="l04061"></a>04061       rxBaseData,
<a name="l04062"></a>04062       P,
<a name="l04063"></a>04063       hasAmbiguityChangeOccurred );
<a name="l04064"></a>04064 
<a name="l04065"></a>04065     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#552afa68dfb2720b926453b0592ce118" title="Compute the differntial GPS L1 ADR misclosures.">DetermineSingleDifferenceADR_Misclosures_GPSL1</a>(
<a name="l04066"></a>04066       rxData,
<a name="l04067"></a>04067       rxBaseData,
<a name="l04068"></a>04068       nrDifferentialAdr,
<a name="l04069"></a>04069       w_adr );
<a name="l04070"></a>04070     <span class="keywordflow">if</span>( !result )
<a name="l04071"></a>04071     {
<a name="l04072"></a>04072       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04073"></a>04073     }
<a name="l04074"></a>04074 
<a name="l04075"></a>04075     
<a name="l04076"></a>04076     <span class="comment">// Form the combined design matrix.</span>
<a name="l04077"></a>04077     n = nrP + nrD + nrDifferentialAdr;
<a name="l04078"></a>04078 
<a name="l04079"></a>04079     <span class="keywordflow">if</span>( hasAmbiguityChangeOccurred )
<a name="l04080"></a>04080       <span class="keywordtype">int</span> gg=99; <span class="comment">// place breakpoint here to debug issues related to changes in ambiguities.</span>
<a name="l04081"></a>04081 
<a name="l04082"></a>04082     result = H.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 8 + nrDifferentialAdr );
<a name="l04083"></a>04083     <span class="keywordflow">if</span>( !result )
<a name="l04084"></a>04084     {
<a name="l04085"></a>04085       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04086"></a>04086     }
<a name="l04087"></a>04087 
<a name="l04088"></a>04088     result = r.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n );
<a name="l04089"></a>04089     <span class="keywordflow">if</span>( !result )
<a name="l04090"></a>04090     {
<a name="l04091"></a>04091       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04092"></a>04092     }
<a name="l04093"></a>04093 
<a name="l04094"></a>04094     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iP = 0; <span class="comment">// A counter for the pseudorange.</span>
<a name="l04095"></a>04095     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iD = 0; <span class="comment">// A counter for the Doppler.</span>
<a name="l04096"></a>04096     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iA = 0; <span class="comment">// A counter for the ADR.</span>
<a name="l04097"></a>04097     <span class="keywordtype">double</span> stdev; <span class="comment">// a temporary double.</span>
<a name="l04098"></a>04098     <span class="keywordflow">for</span>( k = 0; k &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; k++ )
<a name="l04099"></a>04099     {
<a name="l04100"></a>04100       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l04101"></a>04101       {
<a name="l04102"></a>04102         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l04103"></a>04103         {
<a name="l04104"></a>04104           H[iP][0] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[0];
<a name="l04105"></a>04105           H[iP][1] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[1];
<a name="l04106"></a>04106           H[iP][2] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[2];
<a name="l04107"></a>04107           H[iP][6] = 1.0;
<a name="l04108"></a>04108 
<a name="l04109"></a>04109           stdev = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#fc34dcded0dfc1a592a7ff809acac158" title="The estimated pseudorange measurement standard deviation [m].">stdev_psr</a>;  <span class="comment">// KO not differential obs error (need to change)</span>
<a name="l04110"></a>04110           r[iP] = stdev*stdev;
<a name="l04111"></a>04111           iP++;
<a name="l04112"></a>04112         }
<a name="l04113"></a>04113         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l04114"></a>04114         {
<a name="l04115"></a>04115           H[iD+nrP][3] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#a6d9b3a6826a739790a91aa3d0c58ff3" title="The design matrix row relating the Doppler measurements to the velocity solution...">H_v</a>[0];
<a name="l04116"></a>04116           H[iD+nrP][4] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#a6d9b3a6826a739790a91aa3d0c58ff3" title="The design matrix row relating the Doppler measurements to the velocity solution...">H_v</a>[1];
<a name="l04117"></a>04117           H[iD+nrP][5] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#a6d9b3a6826a739790a91aa3d0c58ff3" title="The design matrix row relating the Doppler measurements to the velocity solution...">H_v</a>[2];
<a name="l04118"></a>04118           H[iD+nrP][7] = 1.0;
<a name="l04119"></a>04119           stdev = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ba2e69584653c821eebc74640acfee53" title="The estimated Doppler measurement standard deviation [Hz].">stdev_doppler</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>; <span class="comment">// Change from cycles/s to meters/s.</span>
<a name="l04120"></a>04120           r[iD+nrP] = stdev*stdev;          
<a name="l04121"></a>04121           iD++;
<a name="l04122"></a>04122         }
<a name="l04123"></a>04123         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l04124"></a>04124         {          
<a name="l04125"></a>04125           H[iA+nrP+nrD][0] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[0];
<a name="l04126"></a>04126           H[iA+nrP+nrD][1] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[1];
<a name="l04127"></a>04127           H[iA+nrP+nrD][2] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ad808ce3d94d750af23157ec5cf14284" title="The design matrix row relating the pseudorange measurements to the position solution...">H_p</a>[2];
<a name="l04128"></a>04128           H[iA+nrP+nrD][6] = 1.0;
<a name="l04129"></a>04129 
<a name="l04130"></a>04130           H[iA+nrP+nrD][rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#15dc1ee20ca474406a92d67e6633533b" title="The index into the state vector for this ambiguity state. -1 not estimated.">index_ambiguity_state</a>] = 1.0;
<a name="l04131"></a>04131 
<a name="l04132"></a>04132           stdev = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[k].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b1794d44589377b4bce0ec0349355945" title="The estimated accumulated Doppler range measurement standard deviation [cycles].">stdev_adr</a> * <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>; <span class="comment">// Change from cycles to meters.</span>
<a name="l04133"></a>04133           r[iA+nrP+nrD] = stdev*stdev;          
<a name="l04134"></a>04134           iA++;
<a name="l04135"></a>04135         }
<a name="l04136"></a>04136       }
<a name="l04137"></a>04137     }
<a name="l04138"></a>04138 
<a name="l04139"></a>04139     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> timeMat(1);
<a name="l04140"></a>04140     timeMat[0] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#41f6afce3d90140fd6a7a2e716887b9c">time</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_receiver_time.html#8b202682d7db43680e6d1508eebe5187" title="The GPS time of week (0-604800.0) (receiver time of observation) [s].">gps_tow</a>;
<a name="l04141"></a>04141     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"gpstime"</span>, timeMat );
<a name="l04142"></a>04142     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"H"</span>, H );
<a name="l04143"></a>04143 
<a name="l04144"></a>04144     <span class="comment">// Form the combined misclosure vector.</span>
<a name="l04145"></a>04145     result = w.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>( n, 1 );
<a name="l04146"></a>04146     <span class="keywordflow">if</span>( !result )
<a name="l04147"></a>04147     {
<a name="l04148"></a>04148       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04149"></a>04149     }
<a name="l04150"></a>04150     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l04151"></a>04151     {
<a name="l04152"></a>04152       <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l04153"></a>04153       {
<a name="l04154"></a>04154         w[i] = w_p[i];
<a name="l04155"></a>04155       }
<a name="l04156"></a>04156       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( i &lt; nrP+nrD )
<a name="l04157"></a>04157       {
<a name="l04158"></a>04158         w[i] = w_v[i-nrP];
<a name="l04159"></a>04159       }
<a name="l04160"></a>04160       <span class="keywordflow">else</span>
<a name="l04161"></a>04161       {
<a name="l04162"></a>04162         w[i] = w_adr[i-nrP-nrD];
<a name="l04163"></a>04163       }
<a name="l04164"></a>04164     }
<a name="l04165"></a>04165 
<a name="l04166"></a>04166     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">PrintMatToDebug</a>( <span class="stringliteral">"w"</span>, w );
<a name="l04167"></a>04167     
<a name="l04168"></a>04168     <span class="comment">// The corrections for lat and lon, dx_p, must be converted to [rad] from [m].</span>
<a name="l04169"></a>04169     <a class="code" href="geodesy_8c.html#789fe510e07792c062937771558527a8">GEODESY_ComputePrimeVerticalRadiusOfCurvature</a>(
<a name="l04170"></a>04170       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l04171"></a>04171       lat,
<a name="l04172"></a>04172       &amp;N );
<a name="l04173"></a>04173     <a class="code" href="geodesy_8c.html#05e9c8e97047bcae8f1208b87f57b51a">GEODESY_ComputeMeridianRadiusOfCurvature</a>(
<a name="l04174"></a>04174       <a class="code" href="geodesy_8h.html#85892358ee81c1db6c2bdafffa2d282ce781aa9a001ff026b17367ff519a0deb" title="WGS84.">GEODESY_REFERENCE_ELLIPSE_WGS84</a>,
<a name="l04175"></a>04175       lat,
<a name="l04176"></a>04176       &amp;M );
<a name="l04177"></a>04177     <span class="keywordtype">double</span> dlat = M + hgt;
<a name="l04178"></a>04178     <span class="keywordtype">double</span> dlon = (N + hgt) * cos(lat);
<a name="l04179"></a>04179 
<a name="l04180"></a>04180     <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> amb;
<a name="l04181"></a>04181     <span class="keywordflow">if</span>( nrDifferentialAdr &gt; 0 )
<a name="l04182"></a>04182       amb.<a class="code" href="class_zenautics_1_1_matrix.html#dca19f37dff6adfba7509ef4da4c41a2" title="Resize the matrix, original data is lost, new data is set to zero. The default value...">Resize</a>(nrDifferentialAdr);
<a name="l04183"></a>04183 
<a name="l04184"></a>04184     u = 8 + nrDifferentialAdr;
<a name="l04185"></a>04185     <span class="comment">// Now the sequential measurement update section</span>
<a name="l04186"></a>04186     <span class="comment">// For each measurement</span>
<a name="l04187"></a>04187     <span class="keywordflow">for</span>( index = 0; index &lt; n; index++ )
<a name="l04188"></a>04188     {
<a name="l04189"></a>04189       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> h(1,u);  <span class="comment">// The i'th row of the design matrix, [ux1].</span>
<a name="l04190"></a>04190       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> ht(u,1); <span class="comment">// The transpose of the i'th row of the design matrix, [ux1].</span>
<a name="l04191"></a>04191       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> pht;     <span class="comment">// pht = P ht, [ux1].</span>
<a name="l04192"></a>04192       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> C;       <span class="comment">// C = (h P ht + R_{ii}), [1x1].</span>
<a name="l04193"></a>04193       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> k_i;     <span class="comment">// The i'th kalman gain. k_i = pht/C</span>
<a name="l04194"></a>04194       <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> D;       <span class="comment">// D = k_i h * P.</span>
<a name="l04195"></a>04195       
<a name="l04196"></a>04196       <span class="comment">// Copy out a row of the design matrix.</span>
<a name="l04197"></a>04197       <span class="keywordflow">for</span>( j = 0; j &lt; u; j++ )
<a name="l04198"></a>04198       {
<a name="l04199"></a>04199         h[0][j] = H[index][j];
<a name="l04200"></a>04200         ht[j][0] = H[index][j];
<a name="l04201"></a>04201       }
<a name="l04202"></a>04202       <span class="comment">//PrintMatToDebug( "h", h );</span>
<a name="l04203"></a>04203 
<a name="l04204"></a>04204       <span class="comment">// Compute pht</span>
<a name="l04205"></a>04205       pht = P;
<a name="l04206"></a>04206       <span class="keywordflow">if</span>( !pht.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( ht ) )
<a name="l04207"></a>04207         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04208"></a>04208       
<a name="l04209"></a>04209       <span class="comment">// Compute C = (h P h^T + R_{ii})</span>
<a name="l04210"></a>04210       C = h * pht;
<a name="l04211"></a>04211       C[0] += r[index];
<a name="l04212"></a>04212       
<a name="l04213"></a>04213       <span class="comment">// Compute k_i</span>
<a name="l04214"></a>04214       k_i = pht / C[0];
<a name="l04215"></a>04215 
<a name="l04216"></a>04216       <span class="comment">//PrintMatToDebug( "k_i", k_i );</span>
<a name="l04217"></a>04217 
<a name="l04218"></a>04218       <span class="comment">// Update the state variance-coveriance;</span>
<a name="l04219"></a>04219       D = k_i;
<a name="l04220"></a>04220       <span class="keywordflow">if</span>( !D.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( h ) )
<a name="l04221"></a>04221         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04222"></a>04222       <span class="keywordflow">if</span>( !D.<a class="code" href="class_zenautics_1_1_matrix.html#f0885879718014a026d58697b59e2366" title="Post-Multiply this matrix by B. A = A*B, inplace.">Inplace_PostMultiply</a>( P ) )
<a name="l04223"></a>04223         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04224"></a>04224       P -= D;
<a name="l04225"></a>04225       
<a name="l04226"></a>04226       <span class="keywordtype">double</span> innovation = w[index];
<a name="l04227"></a>04227       k_i.<a class="code" href="class_zenautics_1_1_matrix.html#090242346881b167f2a92d10d097560d" title="Multiply by scaler double (ie: M *= 5).">Inplace_MultiplyScalar</a>( innovation );
<a name="l04228"></a>04228       dx = k_i;
<a name="l04229"></a>04229       <span class="comment">//PrintMatToDebug( "dx", dx );</span>
<a name="l04230"></a>04230 
<a name="l04231"></a>04231       <span class="comment">// Update the position and clock states</span>
<a name="l04232"></a>04232       <span class="comment">// Update height first as it is need to reduce the corrections for lat and lon.</span>
<a name="l04233"></a>04233       hgt += dx[2];
<a name="l04234"></a>04234       clk += dx[6];
<a name="l04235"></a>04235 
<a name="l04236"></a>04236       <span class="comment">// The corrections for lat and lon, dx_p, must be converted to [rad] from [m].</span>
<a name="l04237"></a>04237       lat += dx[0] / dlat;  <span class="comment">// convert from meters to radians.</span>
<a name="l04238"></a>04238       lon += dx[1] / dlon;  <span class="comment">// convert from meters to radians.</span>
<a name="l04239"></a>04239 
<a name="l04240"></a>04240       result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#52a8d17635ab44c6add3566bc700a30f" title="Update the receiver position and clock offset.">UpdatePositionAndRxClock</a>(
<a name="l04241"></a>04241         lat,
<a name="l04242"></a>04242         lon,
<a name="l04243"></a>04243         hgt,
<a name="l04244"></a>04244         clk,
<a name="l04245"></a>04245         sqrt(P[0][0]),
<a name="l04246"></a>04246         sqrt(P[1][1]),
<a name="l04247"></a>04247         sqrt(P[2][2]),
<a name="l04248"></a>04248         sqrt(P[6][6])
<a name="l04249"></a>04249         );
<a name="l04250"></a>04250       <span class="keywordflow">if</span>( !result )
<a name="l04251"></a>04251       {
<a name="l04252"></a>04252         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04253"></a>04253       }
<a name="l04254"></a>04254 
<a name="l04255"></a>04255       <span class="comment">// Update the velocity and clock drift states.</span>
<a name="l04256"></a>04256       vn        += dx[3];
<a name="l04257"></a>04257       ve        += dx[4];
<a name="l04258"></a>04258       vup       += dx[5];
<a name="l04259"></a>04259       clkdrift  += dx[7];
<a name="l04260"></a>04260 
<a name="l04261"></a>04261       result = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#41cd9f52d3cc745937c4832b3e4021d7" title="Update the receiver velocity and clock drift.">UpdateVelocityAndClockDrift</a>(
<a name="l04262"></a>04262         vn,
<a name="l04263"></a>04263         ve,
<a name="l04264"></a>04264         vup,
<a name="l04265"></a>04265         clkdrift,
<a name="l04266"></a>04266         sqrt(P[3][3]),
<a name="l04267"></a>04267         sqrt(P[4][4]),
<a name="l04268"></a>04268         sqrt(P[5][5]),
<a name="l04269"></a>04269         sqrt(P[7][7]) );
<a name="l04270"></a>04270       <span class="keywordflow">if</span>( !result )
<a name="l04271"></a>04271       {
<a name="l04272"></a>04272         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04273"></a>04273       }
<a name="l04274"></a>04274 
<a name="l04275"></a>04275     <span class="comment">// KO recompute misclosures based on the single update (theoretically could redo design matrix too, but very small).</span>
<a name="l04276"></a>04276     result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5b662c0621a045780f42bf1bc98fbae6" title="Determine the design matrix for the GPS L1 position solution based on pseudroange...">DetermineDesignMatrixForThePositionSolution_GPSL1</a>(
<a name="l04277"></a>04277         *rxData,
<a name="l04278"></a>04278         nrP,
<a name="l04279"></a>04279         H_p );
<a name="l04280"></a>04280       <span class="keywordflow">if</span>( !result )
<a name="l04281"></a>04281       {
<a name="l04282"></a>04282         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04283"></a>04283       }
<a name="l04284"></a>04284 
<a name="l04285"></a>04285       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#55b3e8169df537b5bea1f57f8ab52b19" title="Determine the design matrix for the GPS L1 velocity solution based on Doppler measurements...">DetermineDesignMatrixForTheVelocitySolution_GPSL1</a>(
<a name="l04286"></a>04286         *rxData,
<a name="l04287"></a>04287         nrD,
<a name="l04288"></a>04288         H_v );
<a name="l04289"></a>04289       <span class="keywordflow">if</span>( !result )
<a name="l04290"></a>04290       {
<a name="l04291"></a>04291         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04292"></a>04292       }
<a name="l04293"></a>04293 
<a name="l04294"></a>04294       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#e87a3461b660d0adcb75cc06349aa864" title="Compute the GPS L1 pseudroange misclosures.">DeterminePseudorangeMisclosures_GPSL1</a>(
<a name="l04295"></a>04295         rxData,
<a name="l04296"></a>04296         rxBaseData,
<a name="l04297"></a>04297         nrP,
<a name="l04298"></a>04298         w_p );
<a name="l04299"></a>04299       <span class="keywordflow">if</span>( !result )
<a name="l04300"></a>04300       {
<a name="l04301"></a>04301         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04302"></a>04302       }
<a name="l04303"></a>04303 
<a name="l04304"></a>04304       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#5279f3ab46554e64129eb57d5c9ea941" title="Compute the GPS L1 Doppler misclosures.">DetermineDopplerMisclosures_GPSL1</a>(
<a name="l04305"></a>04305         rxData,
<a name="l04306"></a>04306         rxBaseData,
<a name="l04307"></a>04307         nrD,
<a name="l04308"></a>04308         w_v );
<a name="l04309"></a>04309       <span class="keywordflow">if</span>( !result )
<a name="l04310"></a>04310       {
<a name="l04311"></a>04311         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04312"></a>04312       }
<a name="l04313"></a>04313 
<a name="l04314"></a>04314       j = 0;
<a name="l04315"></a>04315       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l04316"></a>04316       {
<a name="l04317"></a>04317         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l04318"></a>04318         {
<a name="l04319"></a>04319           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#f84098bd901e20bf5a16d4f98a0c4ee2" title="The estimated integer component of the adr. This may be the single or double differenced...">ambiguity</a> += dx[rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#15dc1ee20ca474406a92d67e6633533b" title="The index into the state vector for this ambiguity state. -1 not estimated.">index_ambiguity_state</a>];
<a name="l04320"></a>04320           amb[j] = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#f84098bd901e20bf5a16d4f98a0c4ee2" title="The estimated integer component of the adr. This may be the single or double differenced...">ambiguity</a>;
<a name="l04321"></a>04321           j++;
<a name="l04322"></a>04322         }
<a name="l04323"></a>04323       }
<a name="l04324"></a>04324 
<a name="l04325"></a>04325       result = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#552afa68dfb2720b926453b0592ce118" title="Compute the differntial GPS L1 ADR misclosures.">DetermineSingleDifferenceADR_Misclosures_GPSL1</a>(
<a name="l04326"></a>04326         rxData,
<a name="l04327"></a>04327         rxBaseData,
<a name="l04328"></a>04328         nrDifferentialAdr,
<a name="l04329"></a>04329         w_adr );
<a name="l04330"></a>04330 
<a name="l04331"></a>04331       <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l04332"></a>04332       {
<a name="l04333"></a>04333         <span class="keywordflow">if</span>( i &lt; nrP )
<a name="l04334"></a>04334         {
<a name="l04335"></a>04335           w[i] = w_p[i];
<a name="l04336"></a>04336         }
<a name="l04337"></a>04337         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( i &lt; nrP+nrD )
<a name="l04338"></a>04338         {
<a name="l04339"></a>04339           w[i] = w_v[i-nrP];
<a name="l04340"></a>04340         }
<a name="l04341"></a>04341         <span class="keywordflow">else</span>
<a name="l04342"></a>04342         {
<a name="l04343"></a>04343           w[i] = w_adr[i-nrP-nrD];
<a name="l04344"></a>04344         }
<a name="l04345"></a>04345       }            
<a name="l04346"></a>04346     }
<a name="l04347"></a>04347 
<a name="l04348"></a>04348     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l04349"></a>04349     {
<a name="l04350"></a>04350       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#3b9be4348442c1cf84a8460e18de3c6f" title="Indicates if some part (pseudorange) of this channel&amp;#39;s measurement was used in...">isUsedInPosSolution</a> )
<a name="l04351"></a>04351         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#a655b1955627ab1a33ed67835d5c9830" title="This indicates the number of valid pseudorange observations valid after adjustment...">nrPsrObsUsed</a>++;
<a name="l04352"></a>04352       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#ab4e636696519030cab95aad44128643" title="Indicates if some part (Doppler) of this channel&amp;#39;s measurement was used in the...">isUsedInVelSolution</a> )
<a name="l04353"></a>04353         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#958270873565f5471485221fd4cc7c9a" title="This indicates the number of valid Doppler observations valid after adjustment.">nrDopplerObsUsed</a>++;
<a name="l04354"></a>04354       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l04355"></a>04355         rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#fa0c3f24f0bdfd7fbfc0dd9bce636945" title="The receiver&amp;#39;s position, velocity, and time information.">m_pvt</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_p_v_t.html#d4c0efc0809d11ab8ce2c4839e74a9fb" title="This indicates the number of valid ADR observations valid after adjustment.">nrAdrObsUsed</a>++;
<a name="l04356"></a>04356     }
<a name="l04357"></a>04357 
<a name="l04358"></a>04358     
<a name="l04359"></a>04359 <span class="preprocessor">#ifdef DEBUG_THE_ESTIMATOR</span>
<a name="l04360"></a>04360 <span class="preprocessor"></span>    <span class="keywordtype">char</span> supermsg[8192];
<a name="l04361"></a>04361     <span class="keywordtype">unsigned</span> nrBytesInBuffer = 0;
<a name="l04362"></a>04362     rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#08c6b4c291509c108b178ccf9e4e88cd" title="The number of bytes set in the buffer.">Debug_WriteSuperMsg80CharsWide</a>( 
<a name="l04363"></a>04363       supermsg,
<a name="l04364"></a>04364       8192,
<a name="l04365"></a>04365       51.0916666667*<a class="code" href="constants_8h.html#f7e8592d0a634bd3642e9fd508ea8022" title="PI/180.0.">DEG2RAD</a>,
<a name="l04366"></a>04366       -114.0000000000*<a class="code" href="constants_8h.html#f7e8592d0a634bd3642e9fd508ea8022" title="PI/180.0.">DEG2RAD</a>,
<a name="l04367"></a>04367       1000.000,
<a name="l04368"></a>04368       nrBytesInBuffer );
<a name="l04369"></a>04369     printf( supermsg );
<a name="l04370"></a>04370 <span class="preprocessor">#endif</span>
<a name="l04371"></a>04371 <span class="preprocessor"></span>   
<a name="l04372"></a>04372     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l04373"></a>04373   }
<a name="l04374"></a>04374 
<a name="l04375"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20">04375</a> 
<a name="l04376"></a>04376   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#a1e9c184572fd6fb82160cf739c27b20" title="A static function for outputting a matrix to the console.">GNSS_Estimator::PrintMatToDebug</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a>&amp; M )
<a name="l04377"></a>04377   {
<a name="l04378"></a>04378 <span class="preprocessor">#ifdef DEBUG_THE_ESTIMATOR</span>
<a name="l04379"></a>04379 <span class="preprocessor"></span>
<a name="l04380"></a>04380     <span class="keywordtype">char</span> buffer[8192];
<a name="l04381"></a>04381     <span class="keywordflow">if</span>( name == NULL )
<a name="l04382"></a>04382       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04383"></a>04383     <span class="keywordflow">if</span>( !M.<a class="code" href="class_zenautics_1_1_matrix.html#2acc1e2a7b6acfdc81497496317ebf96" title="Print the matrix to a buffer of maxlength with automatically determined column width...">PrintToBuffer</a>( buffer, 8192, 7 ) )
<a name="l04384"></a>04384       <span class="keywordflow">return</span> 1;
<a name="l04385"></a>04385     printf( <span class="stringliteral">"%s = \n%s\n"</span>, name, buffer );
<a name="l04386"></a>04386 
<a name="l04387"></a>04387     <span class="keywordflow">if</span>( m_debug == NULL )
<a name="l04388"></a>04388     {
<a name="l04389"></a>04389       m_debug = fopen( <span class="stringliteral">"debug.txt"</span>, <span class="stringliteral">"w"</span> );
<a name="l04390"></a>04390       <span class="keywordflow">if</span>( !m_debug )
<a name="l04391"></a>04391       {
<a name="l04392"></a>04392         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04393"></a>04393       }
<a name="l04394"></a>04394     }
<a name="l04395"></a>04395     <span class="keywordflow">else</span>
<a name="l04396"></a>04396     {
<a name="l04397"></a>04397       fprintf( m_debug, <span class="stringliteral">"%s = \n%s\n"</span>, name, buffer );      
<a name="l04398"></a>04398       fflush( m_debug );
<a name="l04399"></a>04399     }
<a name="l04400"></a>04400 <span class="preprocessor">#endif</span>
<a name="l04401"></a>04401 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l04402"></a>04402   }
<a name="l04403"></a>04403 
<a name="l04404"></a>04404 
<a name="l04405"></a><a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#96a0bab199cd0cd0b933722e3f14ace4">04405</a> 
<a name="l04406"></a>04406   <span class="keywordtype">bool</span> <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#96a0bab199cd0cd0b933722e3f14ace4" title="Deal with changes in ambiguities. Remove the rows and columns from P of the ambiguities...">GNSS_Estimator::DetermineAmbiguitiesChanges</a>( 
<a name="l04407"></a>04407     <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxData,     <span class="comment">//!&lt; The receiver data.</span>
<a name="l04408"></a>04408 <span class="comment"></span>    <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html" title="A class for handling GNSS information for ONE EPOCH for ONE RECEIVER such as pseudorange...">GNSS_RxData</a> *rxBaseData, <span class="comment">//!&lt; The reference receiver data if any (NULL if not available).</span>
<a name="l04409"></a>04409 <span class="comment"></span>    <a class="code" href="class_zenautics_1_1_matrix.html" title="The two dimensional matrix class. Both real and complex data are inherently supported...">Matrix</a> &amp;P,               <span class="comment">//!&lt; The state variance-covariance matrix.</span>
<a name="l04410"></a>04410 <span class="comment"></span>    <span class="keywordtype">bool</span>&amp; changeOccured 
<a name="l04411"></a>04411     )
<a name="l04412"></a>04412   {
<a name="l04413"></a>04413     <span class="keywordtype">unsigned</span> i = 0;
<a name="l04414"></a>04414     <span class="comment">// First look for ambiguities that are no longer active.</span>
<a name="l04415"></a>04415     <span class="keywordtype">bool</span> isAmbiguityActive = <span class="keyword">false</span>;      
<a name="l04416"></a>04416     std::list&lt;stAmbiguityInfo&gt;::iterator iter;
<a name="l04417"></a>04417     std::list&lt;stAmbiguityInfo&gt;::iterator remove_iter;
<a name="l04418"></a>04418     std::list&lt;unsigned int&gt; remove_list;
<a name="l04419"></a>04419     std::list&lt;unsigned int&gt;::const_iterator list_iter;
<a name="l04420"></a>04420 
<a name="l04421"></a>04421     changeOccured = <span class="keyword">false</span>;
<a name="l04422"></a>04422 
<a name="l04423"></a>04423     <span class="comment">// At this point the active ambiguities are those that were included in the </span>
<a name="l04424"></a>04424     <span class="comment">// estimation of the previous epoch. This will change if some of those ambiguites</span>
<a name="l04425"></a>04425     <span class="comment">// are no longer included in the observations.</span>
<a name="l04426"></a>04426     <span class="keywordflow">for</span>( iter = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.begin(); iter != <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.end();  )
<a name="l04427"></a>04427     {
<a name="l04428"></a>04428       isAmbiguityActive = <span class="keyword">false</span>;
<a name="l04429"></a>04429       
<a name="l04430"></a>04430       <span class="comment">// For the active ambiguity (iter), search through the observation array to see</span>
<a name="l04431"></a>04431       <span class="comment">// if the ambiguity is still present and if it is to be estimated.      </span>
<a name="l04432"></a>04432       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l04433"></a>04433       {
<a name="l04434"></a>04434         <span class="keywordflow">if</span>( iter-&gt;channel == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#62db12cf3c800d28f0ef5e90df2e661b" title="The channel number associated with this measurement.">channel</a> &amp;&amp;
<a name="l04435"></a>04435           iter-&gt;id        == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a> &amp;&amp;
<a name="l04436"></a>04436           iter-&gt;system    == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> &amp;&amp; 
<a name="l04437"></a>04437           iter-&gt;freqType  == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> &amp;&amp;
<a name="l04438"></a>04438           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l04439"></a>04439         {
<a name="l04440"></a>04440           <span class="comment">// This ambiguity is already actively estimated.</span>
<a name="l04441"></a>04441           isAmbiguityActive = <span class="keyword">true</span>;
<a name="l04442"></a>04442           <span class="keywordflow">break</span>;
<a name="l04443"></a>04443         }
<a name="l04444"></a>04444       }
<a name="l04445"></a>04445 
<a name="l04446"></a>04446       <span class="keywordflow">if</span>( !isAmbiguityActive )
<a name="l04447"></a>04447       {
<a name="l04448"></a>04448         changeOccured = <span class="keyword">true</span>;
<a name="l04449"></a>04449 
<a name="l04450"></a>04450         <span class="comment">// Add the state_index to the list of indices to be</span>
<a name="l04451"></a>04451         <span class="comment">// removed from state variance covariance matrix.        </span>
<a name="l04452"></a>04452         remove_list.push_back( iter-&gt;state_index );
<a name="l04453"></a>04453 
<a name="l04454"></a>04454         remove_iter = iter;
<a name="l04455"></a>04455         ++iter;
<a name="l04456"></a>04456         <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.erase( remove_iter );        
<a name="l04457"></a>04457       }
<a name="l04458"></a>04458       <span class="keywordflow">else</span>
<a name="l04459"></a>04459       {
<a name="l04460"></a>04460         ++iter;
<a name="l04461"></a>04461       }
<a name="l04462"></a>04462     }
<a name="l04463"></a>04463 
<a name="l04464"></a>04464     <span class="comment">// Deal with removing ambiguities from P.</span>
<a name="l04465"></a>04465     <span class="keywordflow">if</span>( remove_list.size() &gt; 0 )
<a name="l04466"></a>04466     {
<a name="l04467"></a>04467       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *rows = NULL;    
<a name="l04468"></a>04468       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nrows = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(remove_list.size());
<a name="l04469"></a>04469       rows = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>[nrows];
<a name="l04470"></a>04470       <span class="keywordflow">if</span>( rows == NULL )
<a name="l04471"></a>04471       {
<a name="l04472"></a>04472         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04473"></a>04473       }
<a name="l04474"></a>04474 
<a name="l04475"></a>04475       i = 0;
<a name="l04476"></a>04476       <span class="keywordflow">for</span>( list_iter = remove_list.begin(); list_iter != remove_list.end(); ++list_iter )
<a name="l04477"></a>04477       {
<a name="l04478"></a>04478         rows[i] = *list_iter;
<a name="l04479"></a>04479         i++;
<a name="l04480"></a>04480       }
<a name="l04481"></a>04481 
<a name="l04482"></a>04482       <span class="comment">//P.Print( "P.now.txt", 10 );</span>
<a name="l04483"></a>04483       <span class="keywordflow">if</span>( !P.<a class="code" href="class_zenautics_1_1_matrix.html#f111229617f32d7197c4c445f95ed5e5" title="Remove the rows and columns specified by the indices in the rows[] and cols[] arrays...">RemoveRowsAndColumns</a>( nrows, rows, nrows, rows ) )
<a name="l04484"></a>04484       {
<a name="l04485"></a>04485         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04486"></a>04486       }
<a name="l04487"></a>04487       <span class="comment">//P.Print( "P.after.txt", 10 );</span>
<a name="l04488"></a>04488 
<a name="l04489"></a>04489       <span class="keyword">delete</span> [] rows;      
<a name="l04490"></a>04490     }
<a name="l04491"></a>04491 
<a name="l04492"></a>04492     <span class="comment">// The indices of the ambiguities in the list are now incorrect due to the removals and must be corrected.</span>
<a name="l04493"></a>04493     <span class="comment">// Update the ambiguities list first, then the state indices contained in rxData-&gt;m_ObsArray</span>
<a name="l04494"></a>04494     <span class="keywordflow">for</span>( iter = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.begin(); iter != <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.end(); ++iter )
<a name="l04495"></a>04495     {
<a name="l04496"></a>04496       <span class="keywordflow">for</span>( list_iter = remove_list.begin(); list_iter != remove_list.end(); ++list_iter )
<a name="l04497"></a>04497       {
<a name="l04498"></a>04498         <span class="keywordflow">if</span>( iter-&gt;state_index &gt; *list_iter )
<a name="l04499"></a>04499         {
<a name="l04500"></a>04500           iter-&gt;state_index -= 1;
<a name="l04501"></a>04501         }
<a name="l04502"></a>04502       }
<a name="l04503"></a>04503       <span class="comment">// Update the observation array with the new info.</span>
<a name="l04504"></a>04504       <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l04505"></a>04505       {
<a name="l04506"></a>04506         <span class="keywordflow">if</span>( iter-&gt;channel == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#62db12cf3c800d28f0ef5e90df2e661b" title="The channel number associated with this measurement.">channel</a>  &amp;&amp;
<a name="l04507"></a>04507           iter-&gt;id        == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>       &amp;&amp;
<a name="l04508"></a>04508           iter-&gt;system    == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a>   &amp;&amp; 
<a name="l04509"></a>04509           iter-&gt;freqType  == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> &amp;&amp;
<a name="l04510"></a>04510           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l04511"></a>04511         {
<a name="l04512"></a>04512           rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#15dc1ee20ca474406a92d67e6633533b" title="The index into the state vector for this ambiguity state. -1 not estimated.">index_ambiguity_state</a> = iter-&gt;state_index;
<a name="l04513"></a>04513           <span class="keywordflow">break</span>;
<a name="l04514"></a>04514         }
<a name="l04515"></a>04515       }      
<a name="l04516"></a>04516     }
<a name="l04517"></a>04517 
<a name="l04518"></a>04518 
<a name="l04519"></a>04519     <span class="comment">// Add new ambiguities if any.</span>
<a name="l04520"></a>04520     <span class="keywordflow">for</span>( i = 0; i &lt; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#741cbb48ed7e93330d5c20816917cbba" title="The number of usable items in m_ObsArray.">m_nrValidObs</a>; i++ )
<a name="l04521"></a>04521     {
<a name="l04522"></a>04522       isAmbiguityActive = <span class="keyword">false</span>;
<a name="l04523"></a>04523       <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a> == GNSS_GPS &amp;&amp; rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> == GNSS_GPSL1 )
<a name="l04524"></a>04524       {
<a name="l04525"></a>04525         <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#e3adaf0f247d0fa5d438ba3d0038e4d3" title="This flag indicates that the channel is active for use. If this is not set, no other...">isActive</a> )
<a name="l04526"></a>04526         {
<a name="l04527"></a>04527           <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#531103eaff23f2bc5c0023dfef008b6d" title="Indicates if the the ADR is used in the solution.">isAdrUsedInSolution</a> )
<a name="l04528"></a>04528           {
<a name="l04529"></a>04529             <span class="comment">// Look for this ambiguity in the ambiguities list.</span>
<a name="l04530"></a>04530             <span class="keywordflow">for</span>( iter = <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.begin(); iter != <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.end(); ++iter )
<a name="l04531"></a>04531             {
<a name="l04532"></a>04532               <span class="keywordflow">if</span>( iter-&gt;channel == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#62db12cf3c800d28f0ef5e90df2e661b" title="The channel number associated with this measurement.">channel</a> &amp;&amp;
<a name="l04533"></a>04533                 iter-&gt;id        == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>      &amp;&amp;
<a name="l04534"></a>04534                 iter-&gt;system    == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a>  &amp;&amp; 
<a name="l04535"></a>04535                 iter-&gt;freqType  == rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a> )
<a name="l04536"></a>04536               {
<a name="l04537"></a>04537                 <span class="comment">// This ambiguity is already actively estimated.</span>
<a name="l04538"></a>04538                 isAmbiguityActive = <span class="keyword">true</span>;
<a name="l04539"></a>04539                 <span class="keywordflow">break</span>;
<a name="l04540"></a>04540               }
<a name="l04541"></a>04541             } 
<a name="l04542"></a>04542 
<a name="l04543"></a>04543             <span class="keywordflow">if</span>( !isAmbiguityActive )
<a name="l04544"></a>04544             {              
<a name="l04545"></a>04545               changeOccured = <span class="keyword">true</span>;
<a name="l04546"></a>04546 
<a name="l04547"></a>04547               <span class="comment">// Update the active amibguities list.</span>
<a name="l04548"></a>04548               stAmbiguityInfo amb_info;
<a name="l04549"></a>04549 
<a name="l04550"></a>04550               amb_info.channel     = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#62db12cf3c800d28f0ef5e90df2e661b" title="The channel number associated with this measurement.">channel</a>;
<a name="l04551"></a>04551               amb_info.id          = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#b5d1bdd3c11e045c6b3dd31bbe25c7e9" title="The unique id for this channel (eg PRN for GPS).">id</a>;
<a name="l04552"></a>04552               amb_info.system      = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#af8535401b1c011073bae78ded43be3f" title="The satellite system associated with this channel.">system</a>;
<a name="l04553"></a>04553               amb_info.freqType    = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#cc92777a774b2ca96b5ec646d71ade79" title="The frequency type for this channel.">freqType</a>;
<a name="l04554"></a>04554               amb_info.state_index = P.<a class="code" href="class_zenautics_1_1_matrix.html#ea99fa271d975e628a72f518958c746d" title="return no. of rows">nrows</a>(); <span class="comment">// This will be the index of the row and column in P for this ambiguity.</span>
<a name="l04555"></a>04555 
<a name="l04556"></a>04556               rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#15dc1ee20ca474406a92d67e6633533b" title="The index into the state vector for this ambiguity state. -1 not estimated.">index_ambiguity_state</a> = amb_info.state_index;
<a name="l04557"></a>04557               
<a name="l04558"></a>04558               <a class="code" href="class_g_n_s_s_1_1_g_n_s_s___estimator.html#ae1ea80b8b1ce92ca93be7e5cf27fa09" title="GDM store in RxData?">m_ActiveAmbiguitiesList</a>.push_back( amb_info );
<a name="l04559"></a>04559 
<a name="l04560"></a>04560               <span class="comment">// Add a new row and columgn to the state variance-covariance matrix.</span>
<a name="l04561"></a>04561               P.<a class="code" href="class_zenautics_1_1_matrix.html#e1edc4224321e864d2c47f456ee5301d" title="Redimension the matrix, original data is saved in place, new data is set to zero...">Redim</a>( P.<a class="code" href="class_zenautics_1_1_matrix.html#ea99fa271d975e628a72f518958c746d" title="return no. of rows">nrows</a>()+1, P.<a class="code" href="class_zenautics_1_1_matrix.html#130efeb52cb65822ee3de6ba47238576" title="return no. of cols">ncols</a>()+1 );
<a name="l04562"></a>04562 
<a name="l04563"></a>04563               <span class="comment">// Set the initial variance of the ambiguity state [m].</span>
<a name="l04564"></a>04564               P[amb_info.state_index][amb_info.state_index] = 25; <span class="comment">// KO Arbitrary value, to improve</span>
<a name="l04565"></a>04565 
<a name="l04566"></a>04566               <span class="comment">// Initialize the ambiguity state [m].</span>
<a name="l04567"></a>04567               <span class="keywordflow">if</span>( rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#ca1e9653de71fad5d5a67bc3bb717440" title="The flags associated with this channel. ie Validity flags, etc.">flags</a>.<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_flags_bit_field.html#2b80786f7d3ad0738970be8942975cd4" title="Indicates if a matching ADR observation is available from another receiver.">isDifferentialAdrAvailable</a> )
<a name="l04568"></a>04568               {
<a name="l04569"></a>04569                 <span class="comment">// Compute the single difference adr measurement [m].</span>
<a name="l04570"></a>04570                 <span class="keywordtype">double</span> sd_adr_measured = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#78fdf18fab346021b14f7420d83ce4e9" title="The carrier phase or accumulated Doppler range measurement [cycles].">adr</a> - rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a>].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#78fdf18fab346021b14f7420d83ce4e9" title="The carrier phase or accumulated Doppler range measurement [cycles].">adr</a>;
<a name="l04571"></a>04571                 sd_adr_measured *= <a class="code" href="constants_8h.html#a8e32b8202da4d480d9e5cfc0cade02d" title="[m]">GPS_WAVELENGTHL1</a>;
<a name="l04572"></a>04572                 
<a name="l04573"></a>04573                 <span class="comment">// Compute the single difference psr measurement.</span>
<a name="l04574"></a>04574                 <span class="keywordtype">double</span> sd_psr_measured = rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#9bbfa0f14f3ab1f96d1a93144333e876" title="The pseudorange measurement [m].">psr</a> - rxBaseData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#5ef6248fd5c9c47f0ba66815df597b1e" title="The channel index of a matching differential observation. -1 means there is no matching...">index_differential_adr</a>].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#9bbfa0f14f3ab1f96d1a93144333e876" title="The pseudorange measurement [m].">psr</a>;
<a name="l04575"></a>04575 
<a name="l04576"></a>04576                 <span class="comment">// Initialize the ambiguity to the difference between the single difference adr</span>
<a name="l04577"></a>04577                 <span class="comment">// and the single difference pseudorange.</span>
<a name="l04578"></a>04578                 rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#f84098bd901e20bf5a16d4f98a0c4ee2" title="The estimated integer component of the adr. This may be the single or double differenced...">ambiguity</a> =  sd_adr_measured - sd_psr_measured; <span class="comment">// in meters!  //KO possibly replace psr with position derived range plus clock offset</span>
<a name="l04579"></a>04579               }
<a name="l04580"></a>04580               <span class="keywordflow">else</span>
<a name="l04581"></a>04581               {
<a name="l04582"></a>04582                 <span class="comment">// There must be available differential data.</span>
<a name="l04583"></a>04583                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04584"></a>04584               }
<a name="l04585"></a>04585             }
<a name="l04586"></a>04586           }
<a name="l04587"></a>04587           <span class="keywordflow">else</span>
<a name="l04588"></a>04588           {
<a name="l04589"></a>04589             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#15dc1ee20ca474406a92d67e6633533b" title="The index into the state vector for this ambiguity state. -1 not estimated.">index_ambiguity_state</a> = -1;
<a name="l04590"></a>04590             rxData-&gt;<a class="code" href="class_g_n_s_s_1_1_g_n_s_s___rx_data.html#86ea1c3a32c89c9cde7148b50005359d" title="The array of GNSS measurements.">m_ObsArray</a>[i].<a class="code" href="struct_g_n_s_s_1_1_g_n_s_s__struct_measurement.html#f84098bd901e20bf5a16d4f98a0c4ee2" title="The estimated integer component of the adr. This may be the single or double differenced...">ambiguity</a> = 0.0;
<a name="l04591"></a>04591           }
<a name="l04592"></a>04592         }
<a name="l04593"></a>04593       }
<a name="l04594"></a>04594     }
<a name="l04595"></a>04595 
<a name="l04596"></a>04596     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l04597"></a>04597   }
<a name="l04598"></a>04598       
<a name="l04599"></a>04599 
<a name="l04600"></a>04600 
<a name="l04601"></a>04601 
<a name="l04602"></a>04602 
<a name="l04603"></a>04603 } <span class="comment">// end namespace GNSS</span>
<a name="l04604"></a>04604 
<a name="l04605"></a>04605 
<a name="l04606"></a>04606 
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Thu Nov 29 22:53:29 2007 for The Essential GNSS Project by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
